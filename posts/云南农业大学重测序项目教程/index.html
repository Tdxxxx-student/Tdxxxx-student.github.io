<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>äº‘å—å†œä¸šå¤§å­¦é‡æµ‹åºé¡¹ç›®æ•™ç¨‹ | æˆ‘çš„ç©ºé—´</title><meta name=keywords content="ç¾¤ä½“ç»“æ„åˆ†æ,å˜å¼‚æ£€æµ‹,é‡æµ‹åº,GWAS,QTL-seq"><meta name=description content="äº‘å—å†œä¸šå¤§å­¦ äº‘å—ç”Ÿç‰©èµ„æºä¿æŠ¤ä¸åˆ©ç”¨å›½å®¶é‡ç‚¹å®éªŒå®¤
æè¯¦ | 2019 å¹´ 12 æœˆ 31 æ—¥
ç›®å½•

è½¯ä»¶å®‰è£…
å˜å¼‚æ£€æµ‹
ç¾¤ä½“ç»“æ„åˆ†æ
é€‰æ‹©åˆ†æ
GWAS åˆ†æ
QTL-seq åˆ†æ
é™„å½•ï¼šåˆ†ææµç¨‹å›¾

è½¯ä»¶å®‰è£…

âš ï¸ æ³¨æ„ï¼šè¯¥éƒ¨åˆ†è½¯ä»¶å¾ˆéš¾ç”¨ conda ç›´æ¥å®‰è£…ï¼Œå®‰è£…æ­¥éª¤æ¯”è¾ƒç‰¹æ®Šã€‚"><meta name=author content><link rel=canonical href=https://Tdxxxx-student.github.io/posts/%E4%BA%91%E5%8D%97%E5%86%9C%E4%B8%9A%E5%A4%A7%E5%AD%A6%E9%87%8D%E6%B5%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE%E6%95%99%E7%A8%8B/><link crossorigin=anonymous href=/assets/css/stylesheet.01d35acdbbaa1404939950eac1b15ada4d2a087b51757e85aec3659df639bc28.css integrity="sha256-AdNazbuqFASTmVDqwbFa2k0qCHtRdX6FrsNlnfY5vCg=" rel="preload stylesheet" as=style><link rel=icon href=https://Tdxxxx-student.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://Tdxxxx-student.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://Tdxxxx-student.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://Tdxxxx-student.github.io/apple-touch-icon.png><link rel=mask-icon href=https://Tdxxxx-student.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://Tdxxxx-student.github.io/posts/%E4%BA%91%E5%8D%97%E5%86%9C%E4%B8%9A%E5%A4%A7%E5%AD%A6%E9%87%8D%E6%B5%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE%E6%95%99%E7%A8%8B/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><link rel=stylesheet href=https://Tdxxxx-student.github.io/css/custom.css><meta property="og:url" content="https://Tdxxxx-student.github.io/posts/%E4%BA%91%E5%8D%97%E5%86%9C%E4%B8%9A%E5%A4%A7%E5%AD%A6%E9%87%8D%E6%B5%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE%E6%95%99%E7%A8%8B/"><meta property="og:site_name" content="æˆ‘çš„ç©ºé—´"><meta property="og:title" content="äº‘å—å†œä¸šå¤§å­¦é‡æµ‹åºé¡¹ç›®æ•™ç¨‹"><meta property="og:description" content="äº‘å—å†œä¸šå¤§å­¦ äº‘å—ç”Ÿç‰©èµ„æºä¿æŠ¤ä¸åˆ©ç”¨å›½å®¶é‡ç‚¹å®éªŒå®¤
æè¯¦ | 2019 å¹´ 12 æœˆ 31 æ—¥
ç›®å½• è½¯ä»¶å®‰è£… å˜å¼‚æ£€æµ‹ ç¾¤ä½“ç»“æ„åˆ†æ é€‰æ‹©åˆ†æ GWAS åˆ†æ QTL-seq åˆ†æ é™„å½•ï¼šåˆ†ææµç¨‹å›¾ è½¯ä»¶å®‰è£… âš ï¸ æ³¨æ„ï¼šè¯¥éƒ¨åˆ†è½¯ä»¶å¾ˆéš¾ç”¨ conda ç›´æ¥å®‰è£…ï¼Œå®‰è£…æ­¥éª¤æ¯”è¾ƒç‰¹æ®Šã€‚"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-02-03T12:08:55+08:00"><meta property="article:modified_time" content="2026-02-03T12:08:55+08:00"><meta property="article:tag" content="ç¾¤ä½“ç»“æ„åˆ†æ"><meta property="article:tag" content="å˜å¼‚æ£€æµ‹"><meta property="article:tag" content="é‡æµ‹åº"><meta property="article:tag" content="GWAS"><meta property="article:tag" content="QTL-Seq"><meta name=twitter:card content="summary"><meta name=twitter:title content="äº‘å—å†œä¸šå¤§å­¦é‡æµ‹åºé¡¹ç›®æ•™ç¨‹"><meta name=twitter:description content="äº‘å—å†œä¸šå¤§å­¦ äº‘å—ç”Ÿç‰©èµ„æºä¿æŠ¤ä¸åˆ©ç”¨å›½å®¶é‡ç‚¹å®éªŒå®¤
æè¯¦ | 2019 å¹´ 12 æœˆ 31 æ—¥
ç›®å½•

è½¯ä»¶å®‰è£…
å˜å¼‚æ£€æµ‹
ç¾¤ä½“ç»“æ„åˆ†æ
é€‰æ‹©åˆ†æ
GWAS åˆ†æ
QTL-seq åˆ†æ
é™„å½•ï¼šåˆ†ææµç¨‹å›¾

è½¯ä»¶å®‰è£…

âš ï¸ æ³¨æ„ï¼šè¯¥éƒ¨åˆ†è½¯ä»¶å¾ˆéš¾ç”¨ conda ç›´æ¥å®‰è£…ï¼Œå®‰è£…æ­¥éª¤æ¯”è¾ƒç‰¹æ®Šã€‚"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://Tdxxxx-student.github.io/posts/"},{"@type":"ListItem","position":2,"name":"äº‘å—å†œä¸šå¤§å­¦é‡æµ‹åºé¡¹ç›®æ•™ç¨‹","item":"https://Tdxxxx-student.github.io/posts/%E4%BA%91%E5%8D%97%E5%86%9C%E4%B8%9A%E5%A4%A7%E5%AD%A6%E9%87%8D%E6%B5%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE%E6%95%99%E7%A8%8B/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"äº‘å—å†œä¸šå¤§å­¦é‡æµ‹åºé¡¹ç›®æ•™ç¨‹","name":"äº‘å—å†œä¸šå¤§å­¦é‡æµ‹åºé¡¹ç›®æ•™ç¨‹","description":"äº‘å—å†œä¸šå¤§å­¦ äº‘å—ç”Ÿç‰©èµ„æºä¿æŠ¤ä¸åˆ©ç”¨å›½å®¶é‡ç‚¹å®éªŒå®¤\næè¯¦ | 2019 å¹´ 12 æœˆ 31 æ—¥\nç›®å½• è½¯ä»¶å®‰è£… å˜å¼‚æ£€æµ‹ ç¾¤ä½“ç»“æ„åˆ†æ é€‰æ‹©åˆ†æ GWAS åˆ†æ QTL-seq åˆ†æ é™„å½•ï¼šåˆ†ææµç¨‹å›¾ è½¯ä»¶å®‰è£… âš ï¸ æ³¨æ„ï¼šè¯¥éƒ¨åˆ†è½¯ä»¶å¾ˆéš¾ç”¨ conda ç›´æ¥å®‰è£…ï¼Œå®‰è£…æ­¥éª¤æ¯”è¾ƒç‰¹æ®Šã€‚\n","keywords":["ç¾¤ä½“ç»“æ„åˆ†æ","å˜å¼‚æ£€æµ‹","é‡æµ‹åº","GWAS","QTL-seq"],"articleBody":"äº‘å—å†œä¸šå¤§å­¦ äº‘å—ç”Ÿç‰©èµ„æºä¿æŠ¤ä¸åˆ©ç”¨å›½å®¶é‡ç‚¹å®éªŒå®¤\næè¯¦ | 2019 å¹´ 12 æœˆ 31 æ—¥\nç›®å½• è½¯ä»¶å®‰è£… å˜å¼‚æ£€æµ‹ ç¾¤ä½“ç»“æ„åˆ†æ é€‰æ‹©åˆ†æ GWAS åˆ†æ QTL-seq åˆ†æ é™„å½•ï¼šåˆ†ææµç¨‹å›¾ è½¯ä»¶å®‰è£… âš ï¸ æ³¨æ„ï¼šè¯¥éƒ¨åˆ†è½¯ä»¶å¾ˆéš¾ç”¨ conda ç›´æ¥å®‰è£…ï¼Œå®‰è£…æ­¥éª¤æ¯”è¾ƒç‰¹æ®Šã€‚\n1. lumpy-sv ğŸ’¡ lumpy-sv ä¾èµ– Python2.7ï¼Œéœ€åˆ‡æ¢åˆ° py27 ç¯å¢ƒä¸‹è¿›è¡Œå®‰è£…ã€‚\nconda activate py27 git clone --recursive https://github.com/arq5x/lumpy-sv.git cd lumpy-sv make 2. svtyper conda install svtyper 3. cnvnator ğŸ’¡ cnvnator ä¾èµ–äº root è½¯ä»¶åŒ…åŠ samtools è½¯ä»¶åŒ…ï¼ˆåŒ…å« HTSlibï¼‰ï¼Œå› æ­¤å…ˆå®‰è£…ä¾èµ–ã€‚\n3.1 å®‰è£… samtools wget https://github.com/samtools/samtools/releases/download/1.9/samtools-1.9.tar.bz2 tar -xvf samtools-1.9.tar.bz2 cd samtools-1.9/ ./configure make 3.2 å®‰è£… root è½¯ä»¶ # ç›´æ¥ä¸‹è½½åè§£å‹å³å¯ wget https://root.cern/download/root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz tar -zxvf root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz 3.3 å®‰è£… cnvnator git clone https://github.com/abyzovlab/CNVnator.git cd CNVnator # é“¾æ¥samtoolsè½¯ä»¶ç›®å½•åˆ°cnvnatorç›®å½• ln -s ../samtools-1.9 ./samtools # åŠ è½½rootè½¯ä»¶åˆ°ç¯å¢ƒå˜é‡ export ROOTSYS=/pub/software/root export PATH=/pub/software/root/bin:$PATH export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$ROOTSYS/lib # å®‰è£…cnvnator make LIBS=\"-lcrypto\" å˜å¼‚æ£€æµ‹ 1. æ„å»ºåŸºå› ç»„ index # åˆ›å»ºè½¯é“¾æ¥ ln -s ../data/genome.fasta ./genome.fasta # for gatk samtools faidx genome.fasta # for bwa bwa index genome.fasta # for picard picard CreateSequenceDictionary R=genome.fasta 2. æ¯”å¯¹æ’åºå»é‡ 2.1 æ¯”å¯¹æ’åº bwa mem -t 2 -R '@RG\\tID:S1\\tSM:S1\\tPL:illumina' \\ ../01.ref/genome.fasta \\ ../data/S1_1.fq.gz ../data/S1_2.fq.gz | \\ /pub/software/samtools/samtools sort -@ 2 -m 1G -o S1.sort.bam - bwa mem -t 2 -R '@RG\\tID:S2\\tSM:S2\\tPL:illumina' \\ ../01.ref/genome.fasta \\ ../data/S2_1.fq.gz ../data/S2_2.fq.gz | \\ /pub/software/samtools/samtools sort -@ 2 -m 1G -o S2.sort.bam - 2.2 å»é™¤é‡å¤ picard -Xmx4g MarkDuplicates \\ I=S1.sort.bam \\ O=S1.sort.rmdup.bam \\ CREATE_INDEX=true \\ REMOVE_DUPLICATES=true \\ M=S1.marked_dup_metrics.txt picard -Xmx4g MarkDuplicates \\ I=S2.sort.bam \\ O=S2.sort.rmdup.bam \\ CREATE_INDEX=true \\ REMOVE_DUPLICATES=true \\ M=S2.marked_dup_metrics.txt 2.3 æ¯”å¯¹ç‡ç»Ÿè®¡ /pub/software/samtools/samtools flagstat S1.sort.bam \u003e S1.sort.bam.flagstat /pub/software/samtools/samtools flagstat S2.sort.bam \u003e S2.sort.bam.flagstat 2.4 æ‰¹é‡æ¯”å¯¹è„šæœ¬ç”Ÿæˆ less ../data/sample.list | awk '{ print \"bwa mem -t 2 -R '\\''@RG\\\\tID:\"$1\"\\\\tSM:\"$1\"\\\\tPL:illumina'\\'' \\ ../01.ref/genome.fasta ../data/\"$1\"_1.fq.gz ../data/\"$1\"_2.fq.gz | \\ /pub/software/samtools/samtools sort -@ 2 -m 1G -o \"$1\".sort.bam -\" }' 3. SNPã€Indel æ£€æµ‹ 3.1 HaplotypeCaller gatk --java-options \"-Xmx10g -Djava.io.tmpdir=./tmp\" HaplotypeCaller \\ -R ../01.ref/genome.fasta \\ -I ../02.mapping/S1.sort.rmdup.bam \\ -ERC GVCF \\ -O S1.g.vcf 1\u003eS1.HC.log 2\u003e\u00261 gatk --java-options \"-Xmx10g -Djava.io.tmpdir=./tmp\" HaplotypeCaller \\ -R ../01.ref/genome.fasta \\ -I ../02.mapping/S2.sort.rmdup.bam \\ -ERC GVCF \\ -O S2.g.vcf 1\u003eS2.HC.log 2\u003e\u00261 3.2 CombineGVCFs ls ./S*.g.vcf \u003e gvcf.list gatk --java-options \"-Xmx4g -Djava.io.tmpdir=./tmp\" CombineGVCFs \\ -R ../01.ref/genome.fasta \\ -V gvcf.list \\ -O all.merge.g.vcf 3.3GenotpeGVCFs gatk --java-options \"-Xmx4g -Djava.io.tmpdir=./tmp\" GenotypeGVCFs \\ -R ../01.ref/genome.fasta \\ --variant all.merge.g.vcf \\ -O all.merge_raw.vcf 3.4 SNP è¿‡æ»¤ # æå–SNP gatk --java-options \"-Xmx4g -Djava.io.tmpdir=./tmp\" SelectVariants \\ -R ../01.ref/genome.fasta \\ -V all.merge_raw.vcf \\ --select-type SNP \\ -O all.raw.snp.vcf # æ ‡è®°è¿‡æ»¤ gatk --java-options \"-Xmx4g -Djava.io.tmpdir=./tmp\" VariantFiltration \\ -R ../01.ref/genome.fasta \\ -V all.raw.snp.vcf \\ --filter-expression \"QD \u003c 2.0 || MQ \u003c 40.0 || FS \u003e 60.0 || SOR \u003e 3.0 || MQRankSum \u003c -12.5 || ReadPosRankSum \u003c -8.0\" \\ --filter-name 'SNP_filter' \\ -O all.filter.snp.vcf # æå–è¿‡æ»¤åçš„SNP gatk --java-options \"-Xmx4g -Djava.io.tmpdir=./tmp\" SelectVariants \\ -R ../01.ref/genome.fasta \\ -V all.filter.snp.vcf \\ --exclude-filtered \\ -O all.filtered.snp.vcf 3.5 InDel è¿‡æ»¤ # æå–InDel gatk --java-options \"-Xmx4g -Djava.io.tmpdir=./tmp\" SelectVariants \\ -R ../01.ref/genome.fasta \\ -V all.merge_raw.vcf \\ --select-type INDEL \\ -O all.raw.indel.vcf # æ ‡è®°è¿‡æ»¤ gatk --java-options \"-Xmx4g -Djava.io.tmpdir=./tmp\" VariantFiltration \\ -R ../01.ref/genome.fasta \\ -V all.raw.indel.vcf \\ --filter-expression \"QD \u003c 2.0 || FS \u003e 200.0 || SOR \u003e 10.0 || MQRankSum \u003c -12.5 || ReadPosRankSum \u003c -8.0\" \\ --filter-name 'INDEL_filter' \\ -O all.filter.indel.vcf # æå–è¿‡æ»¤åçš„InDel gatk --java-options \"-Xmx4g -Djava.io.tmpdir=./tmp\" SelectVariants \\ -R ../01.ref/genome.fasta \\ -V all.filter.indel.vcf \\ --exclude-filtered \\ -O all.filtered.indel.vcf 4. SV æ£€æµ‹ # Step 1: æå– discordants reads /pub/software/samtools/samtools view -b -F 1294 -@ 12 \\ ../02.mapping/S1.sort.rmdup.bam \u003e S1.discordants.bam /pub/software/samtools/samtools view -b -F 1294 -@ 12 \\ ../02.mapping/S2.sort.rmdup.bam \u003e S2.discordants.bam # Step 2: æå– split reads /pub/software/samtools/samtools view -h ../02.mapping/S1.sort.rmdup.bam | \\ /pub/software/lumpy-sv/scripts/extractSplitReads_BwaMem -i stdin | \\ /pub/software/samtools/samtools sort - \u003e S1.splitters.bam /pub/software/samtools/samtools view -h ../02.mapping/S2.sort.rmdup.bam | \\ /pub/software/lumpy-sv/scripts/extractSplitReads_BwaMem -i stdin | \\ /pub/software/samtools/samtools sort - \u003e S2.splitters.bam # Step 3: è¿è¡Œ lumpy /pub/software/lumpy-sv/bin/lumpyexpress \\ -B ../02.mapping/S1.sort.rmdup.bam,../02.mapping/S2.sort.rmdup.bam \\ -S S1.splitters.bam,S2.splitters.bam \\ -D S1.discordants.bam,S2.discordants.bam \\ -o all.sv.lumpy.vcf # Step 4: ä¸ªä½“åŸºå› å‹åˆ†å‹ vcftools --vcf all.sv.lumpy.vcf --indv S1 --recode --recode-INFO-all --out S1 \u0026\u0026 \\ svtyper -i S1.recode.vcf -B ../02.mapping/S1.sort.rmdup.bam -o S1.genotype.vcf vcftools --vcf all.sv.lumpy.vcf --indv S2 --recode --recode-INFO-all --out S2 \u0026\u0026 \\ svtyper -i S2.recode.vcf -B ../02.mapping/S2.sort.rmdup.bam -o S2.genotype.vcf 5. CNV æ£€æµ‹ 5.1 å‡†å¤‡åŸºå› ç»„ # å°†åŸºå› ç»„æ‹†åˆ†ä¸ºå•æ¡æŸ“è‰²ä½“ ln -s ../data/genome.fasta ./genome.fa seqkit split -i ./genome.fa -O split # é‡å‘½åæ–‡ä»¶ ls ./split/genome.id_*.fa | sed 's/./split/genome.id_//' | \\ awk '{print \"mv ./split/genome.id_\"$aa\" ./split/\"$aa}' \u003e mv_name.sh sh mv_name.sh 5.2 è¿è¡Œ cnvnator # è®¾ç½®ç¯å¢ƒå˜é‡ export ROOTSYS=/pub/software/root export PATH=/pub/software/root/bin:$PATH export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$ROOTSYS/lib # é“¾æ¥æ–‡ä»¶ ln -s ../02.mapping/S1.sort.rmdup.bam # æå–æ¯”å¯¹ç»“æœ /pub/software/CNVnator/cnvnator -genome genome.fa -root S1.root -tree S1.sort.rmdup.bam # ç”Ÿæˆæ·±åº¦åˆ†å¸ƒ /pub/software/CNVnator/cnvnator -genome genome.fa -root S1.root -his 500 -d split # è¿›è¡Œç»Ÿè®¡è®¡ç®— /pub/software/CNVnator/cnvnator -root S1.root -stat 500 # æ£€æŸ¥bin sizeæ˜¯å¦åˆé€‚ /pub/software/CNVnator/cnvnator -root S1.root -eval 500 \u003e S1.eval.ratio # RDä¿¡å·åˆ†å‰² /pub/software/CNVnator/cnvnator -root S1.root -partition 500 # è¿›è¡ŒCNVæ£€æµ‹ /pub/software/CNVnator/cnvnator -root S1.root -call 500 \u003e S1.cnv 6. SNP/InDel æ³¨é‡Š 6.1 å‡†å¤‡æ³¨é‡Šæ•°æ®åº“ ln -s ../data/genome.gtf ln -s ../data/genome.fasta gtfToGenePred -genePredExt genome.gtf genome_refGene.txt /pub/software/annovar/retrieve_seq_from_fasta.pl \\ --format refGene \\ --seqfile genome.fasta \\ genome_refGene.txt \\ --out genome_refGeneMrna.fa 6.2 æ³¨é‡Š VCF æ–‡ä»¶ ln -s ../03.SNP_indel/all.filtered.snp.vcf # æ ¼å¼è½¬æ¢ /pub/software/annovar/convert2annovar.pl \\ -format vcf4old \\ all.filtered.snp.vcf \u003e all.snp.vcf.annovar.input # è¿›è¡Œæ³¨é‡Š /pub/software/annovar/annotate_variation.pl \\ -geneanno \\ --neargene 2000 \\ -buildver genome \\ -dbtype refGene \\ -outfile all.anno \\ -exonsort \\ all.snp.vcf.annovar.input ./ 7. CNV å’Œ SV æ³¨é‡Š # å¤„ç†SVæ–‡ä»¶ less -S ../04.SV/all.sv.lumpy.vcf | \\ awk -F \";\" '{ if($1!~/#/){print $1\"\\t\"$2\"\\t\"$3\"\\t\"$4} }' | \\ awk '{print $1\"\\t\"$2\"\\t\"$11\"\\t\"$3\"\\t\"$8}' | \\ sed 's/END=//' | sed 's/SVTYPE=//' \u003e SV.bed # è¿‡æ»¤BNDç±»å‹ awk '$5 !~ /BND/' SV.bed \u003e SV_filter.bed # SVæ³¨é‡Š bedtools intersect -wo -a SV_filter.bed -b gene.gtf \u003e SV_filter.Anno # å¤„ç†CNVæ–‡ä»¶ less -S ../05.CNV/S1.cnv | \\ awk '{print $2 \"\\t\" $1}' | \\ sed 's/:/\\t/' | sed 's/-/\\t/' \u003e CNV.bed # CNVæ³¨é‡Š bedtools intersect -wo -a CNV.bed -b gene.gtf \u003e CNV.Anno ç¾¤ä½“ç»“æ„åˆ†æ 1. æ•°æ®è¿‡æ»¤ vcf=../data/all.vcf # è¿‡æ»¤ç¼ºå¤±ç‡å’Œæœ€å°ç­‰ä½åŸºå› é¢‘ç‡ plink --vcf $vcf \\ --geno 0.1 \\ --maf 0.01 \\ --out all.missing_maf \\ --recode vcf-iid \\ --allow-extra-chr \\ --set-missing-var-ids @:# \\ --keep-allele-order # è¿‡æ»¤è¿é”ä¸å¹³è¡¡ plink --vcf all.missing_maf.vcf \\ --indep-pairwise 50 10 0.2 \\ --out tmp.ld \\ --allow-extra-chr \\ --set-missing-var-ids @:# plink --vcf all.missing_maf.vcf \\ --make-bed \\ --extract tmp.ld.prune.in \\ --out all.LDfilter \\ --recode vcf-iid \\ --keep-allele-order \\ --allow-extra-chr \\ --set-missing-var-ids @:# 2. å»ºæ ‘åˆ†æ 2.1 NJ æ ‘ # æ ¼å¼è½¬æ¢ perl ../../script/vcf2phy.pl ../../00.filter/all.LDfilter.vcf \u003e sequences.dat # è®¡ç®—é—ä¼ è·ç¦» echo -e \"sequences.dat\\nY\" \u003e dnadist.cfg dnadist \u003c dnadist.cfg \u003e dnadist.log mv outfile infile.dist # æ„å»ºNJæ ‘ echo -e \"infile.dist\\nY\" \u003e neighbor.cfg neighbor \u003c neighbor.cfg \u003e nj.log # æ ¼å¼æ•´ç† less infile.dist | tr '\\n' '|' | sed 's/| / /g' | tr '|' '\\n' \u003e infile.dist.table less outtree | tr '\\n' ' ' | sed 's/ //g' \u003e outtree.nwk 2.2 SNPhylo å»ºæ ‘ /pub/software/SNPhylo/snphylo.sh \\ -v ../../00.filter/all.LDfilter.vcf \\ -r \\ -l 1 \\ -m 0.01 \\ -o GA0001 \\ -b \\ -B 2 \\ -P tree_snphylo 3. PCA åˆ†æ plink --vcf ../00.filter/all.LDfilter.vcf \\ --pca 10 \\ --out PCA_out \\ --allow-extra-chr \\ --set-missing-var-ids @:# Rscript ../script/draw_PCA.R PCA_out.eigenvec 1 2 ../data/sample.pop PCA_out_figure 4. ç¾¤ä½“ç»“æ„åˆ†æ # Step 0: vcfè½¬bedæ ¼å¼ plink --vcf ../00.filter/all.LDfilter.vcf \\ --make-bed \\ --out all \\ --allow-extra-chr \\ --keep-allele-order \\ --set-missing-var-ids @:# # Step 1: ç”ŸæˆAdmixtureè¿è¡Œè„šæœ¬ seq 2 4 | awk '{print \"admixture --cv -j2 all.bed \"$1\" 1\u003eadmix.\"$1\".log 2\u003e\u00261\"}' \u003e admixture.sh # Step 2: è¿è¡ŒAdmixture sh admixture.sh # ä¹Ÿå¯å•ç‹¬è¿è¡Œ admixture --cv -j2 all.bed 2 1\u003eadmix.2.log 2\u003e\u00261 admixture --cv -j2 all.bed 3 1\u003eadmix.3.log 2\u003e\u00261 admixture --cv -j2 all.bed 4 1\u003eadmix.4.log 2\u003e\u00261 # Step 3: ç»˜åˆ¶ç»“æ„å›¾ mkdir result cp ./*.Q result/ Rscript ../script/draw_admixture.R result all.nosex structure 5. LD è¡°å‡åˆ†æ # Step 1: è®¡ç®—LD /pub/software/PopLDdecay/bin/PopLDdecay \\ -InVCF ../data/all.vcf \\ -SubPop ../data/pop.SC.table \\ -MaxDist 500 \\ -OutStat pop.SC.stat /pub/software/PopLDdecay/bin/PopLDdecay \\ -InVCF ../data/all.vcf \\ -SubPop ../data/pop.YZR.table \\ -MaxDist 500 \\ -OutStat pop.YZR.stat # Step 2: ç»˜åˆ¶å•ç¾¤ä½“LDè¡°å‡å›¾ perl /pub/software/PopLDdecay/bin/Plot_OnePop.pl \\ -inFile pop.SC.stat.gz \\ -output pop.SC.ld perl /pub/software/PopLDdecay/bin/Plot_OnePop.pl \\ -inFile pop.YZR.stat.gz \\ -output pop.YZR.ld # Step 3: ç»˜åˆ¶å¤šç¾¤ä½“LDè¡°å‡å›¾ perl /pub/software/PopLDdecay/bin/Plot_MultiPop.pl \\ -inList ld_stat.list \\ -output ld_stat.multi é€‰æ‹©åˆ†æ 1. Ï€ å’Œ ROD åˆ†æ vcf=../../data/all.vcf window=20000 step=2000 # Step 1: è®¡ç®—piå€¼ vcftools --vcf $vcf \\ --window-pi $window \\ --window-pi-step $step \\ --keep ../../data/pop.SC.table \\ --out ./Pi.pop1 vcftools --vcf $vcf \\ --window-pi $window \\ --window-pi-step $step \\ --keep ../../data/pop.YZR.table \\ --out ./Pi.pop2 # Step 2: è®¡ç®—ROD pi1=Pi.pop1.windowed.pi pi2=Pi.pop2.windowed.pi perl ../../script/merge2pi_ROD.pl $pi1 $pi2 \u003e Pi.ROD 2. Tajimaâ€™s D åˆ†æ vcf=../../data/all.vcf window=20000 vcftools --vcf $vcf \\ --TajimaD $window \\ --keep ../../data/pop.SC.table \\ --out TajimaD.pop1 vcftools --vcf $vcf \\ --TajimaD $window \\ --keep ../../data/pop.YZR.table \\ --out TajimaD.pop2 3. Fst åˆ†æ vcf=../../data/all.vcf window=20000 step=2000 vcftools --vcf $vcf \\ --fst-window-size $window \\ --fst-window-step $step \\ --weir-fst-pop ../../data/pop.SC.table \\ --weir-fst-pop ../../data/pop.YZR.table \\ --out ./Fst.pop1.pop2 4. ROD + Fst è”åˆåˆ†æ fst=../03.Fst/Fst.pop1.pop2.windowed.weir.fst ROD=../01.pi_ROD/Pi.ROD gff=../../data/genome.gff # æå–æ˜¾è‘—ä½ç‚¹ perl ../../script/top_Fst_ROD_S.pl $fst $ROD 0.05 0.05 Fst_ROD.table Fst_ROD.stat # ç­›é€‰topä½ç‚¹ awk '$NF==\"top\"' Fst_ROD.table \u003e Fst_ROD.table.top # æå–åŸºå› æ³¨é‡Š awk '$3==\"gene\"' $gff \u003e gene.gff # æ³¨é‡Šå€™é€‰åŸºå›  bedtools intersect -wo -F 0.1 -a Fst_ROD.table.top -b gene.gff | \\ awk -F \"\\t\" '{print $7\"\\t\"$10\"\\t\"$11\"\\t\"$13\"\\t\"$15}' | \\ sort -u \u003e Fst_ROD.table.top.gene GWAS åˆ†æ 1. åŸºå› å‹å¡«å…… beagle -Xmx4g -Djava.io.tmpdir=./TMP \\ gt=../data/all.vcf \\ out=all.impute \\ impute=true \\ window=10 \\ nthreads=2 2. æ ‡å‡† GWAS åˆ†æ # Step 1: å‡†å¤‡VCFæ•°æ® plink --vcf ../data/all.vcf \\ --maf 0.05 \\ --geno 0.1 \\ --recode12 \\ --output-missing-genotype 0 \\ --transpose \\ --out snp_filter \\ --set-missing-var-ids @:# \\ --allow-extra-chr # å‡†å¤‡è¡¨å‹æ•°æ® perl ../script/sort_pheno.pl snp_filter.tfam ../data/trait.table \u003e trait.sort.txt # Step 2: è®¡ç®—äº²ç¼˜å…³ç³»çŸ©é˜µ /pub/software/emmax/emmax-kin-intel64 -v -d 10 -o ./pop.kinship snp_filter # Step 3: è¿è¡ŒGWAS /pub/software/emmax/emmax-intel64 -v -d 10 \\ -t snp_filter \\ -p trait.sort.txt \\ -k pop.kinship \\ -o emmax.out 1\u003e emmax.log 2\u003eemmax.err # Step 4: ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾ paste snp_filter.map emmax.out.ps | \\ awk 'BEGIN{print \"SNP\\tCHR\\tBP\\tP\"}{if($2==$5){print $2\"\\t\"$1\"\\t\"$4\"\\t\"$NF}}' \\ \u003e emmax.out.ps.manht_input Rscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure 3. GWAS-Q åˆ†æï¼ˆåŠ å…¥ç¾¤ä½“ç»“æ„åå˜é‡ï¼‰ # é“¾æ¥æ–‡ä»¶ ln -s ../01.GWAS/snp_filter.tped ln -s ../01.GWAS/snp_filter.tfam ln -s ../01.GWAS/snp_filter.nosex ln -s ../01.GWAS/snp_filter.map ln -s ../01.GWAS/trait.sort.txt ln -s ../../02.population_genetics/03.structure/all.3.Q # å‡†å¤‡QçŸ©é˜µ paste snp_filter.nosex all.3.Q | awk '{print $1\" \"$1\" 1 \"$3\" \"$4}' \u003e pop.Qmatrix # è¿è¡ŒGWAS /pub/software/emmax/emmax-intel64 -v -d 10 \\ -t snp_filter \\ -p trait.sort.txt \\ -k pop.kinship \\ -c pop.Qmatrix \\ -o emmax.out 1\u003e emmax.log 2\u003eemmax.err # ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾ paste snp_filter.map emmax.out.ps | \\ awk 'BEGIN{print \"SNP\\tCHR\\tBP\\tP\"}{if($2==$5){print $2\"\\t\"$1\"\\t\"$4\"\\t\"$NF}}' \\ \u003e emmax.out.ps.manht_input Rscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure_Q 4. çœŸå®æ•°æ® GWAS # Step 1: å‡†å¤‡æ•°æ® plink --vcf ../data_real/Sample215.M5M8H3.2allel.vcf \\ --maf 0.05 \\ --geno 0.1 \\ --recode12 \\ --output-missing-genotype 0 \\ --transpose \\ --out snp_filter \\ --set-missing-var-ids @:# \\ --allow-extra-chr perl ../script/sort_pheno.pl snp_filter.tfam ../data_real/trait.C16_0.table \u003e trait.sort.txt # Step 2: è®¡ç®—äº²ç¼˜å…³ç³»çŸ©é˜µ /pub/software/emmax/emmax-kin-intel64 -v -d 10 -o ./pop.kinship snp_filter # Step 3: è¿è¡ŒGWAS /pub/software/emmax/emmax-intel64 -v -d 10 \\ -t snp_filter \\ -p trait.sort.txt \\ -k pop.kinship \\ -o emmax.out 1\u003e emmax.log 2\u003eemmax.err # Step 4: ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾ paste snp_filter.map emmax.out.ps | \\ awk 'BEGIN{print \"SNP\\tCHR\\tBP\\tP\"}{if($2==$5){print $2\"\\t\"$1\"\\t\"$4\"\\t\"$NF}}' \\ \u003e emmax.out.ps.manht_input Rscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure_readData QTL-seq åˆ†æ 1. VCF è½¬æ¢ä¸º Table æ ¼å¼ ref= vcf= outfile= gatk VariantsToTable \\ -R $ref \\ -V $vcf \\ -F CHROM -F POS -F REF -F ALT \\ -GF AD -GF DP -GF GQ -GF PL \\ -O $outfile 2. QTL-seq åˆ†æï¼ˆR è„šæœ¬ï¼‰ library(QTLseqr) library(ggplot2) # è®¾ç½®å‚æ•° HighBulk \u003c- \"SRR834931\" # é«˜å€¼æ··æ± åç§° LowBulk \u003c- \"SRR834927\" # ä½å€¼æ··æ± åç§° Chroms \u003c- paste0(rep(\"Chr\", 12), 1:12) # æŸ“è‰²ä½“åˆ—è¡¨ # ==================== æ•°æ®è¯»å– ==================== df \u003c- importFromGATK( file = \"../data/Yang_et_al_2013.table\", highBulk = HighBulk, lowBulk = LowBulk, chromList = Chroms ) # ==================== è´¨é‡æ£€æŸ¥å›¾ ==================== # æ·±åº¦åˆ†å¸ƒå›¾ p1 \u003c- ggplot(data = df) + geom_histogram(aes(x = DP.HIGH + DP.LOW)) + xlim(0, 800) pdf(file = \"SNP_depth.pdf\") p1 dev.off() # REFç­‰ä½åŸºå› é¢‘ç‡åˆ†å¸ƒ p2 \u003c- ggplot(data = df) + geom_histogram(aes(x = REF_FRQ)) pdf(file = \"ref_allele_frequency.pdf\") p2 dev.off() # é«˜å€¼æ··æ± SNP-indexåˆ†å¸ƒ p3 \u003c- ggplot(data = df) + geom_histogram(aes(x = SNPindex.HIGH)) pdf(file = \"SNPindex.HIGH.dis.pdf\") p3 dev.off() # ä½å€¼æ··æ± SNP-indexåˆ†å¸ƒ p4 \u003c- ggplot(data = df) + geom_histogram(aes(x = SNPindex.LOW)) pdf(file = \"SNPindex.LOW.dis.pdf\") p4 dev.off() # ==================== SNPè¿‡æ»¤ ==================== df_filt \u003c- filterSNPs( SNPset = df, refAlleleFreq = 0.20, # REFç­‰ä½åŸºå› é¢‘ç‡: 0.2~0.8 minTotalDepth = 100, # æœ€å°æ€»æ·±åº¦ maxTotalDepth = 400, # æœ€å¤§æ€»æ·±åº¦ minSampleDepth = 40, # å•æ ·å“æœ€å°æ·±åº¦ minGQ = 99, # åŸºå› å‹è´¨é‡é˜ˆå€¼ verbose = TRUE ) # ==================== deltaSNPindexè®¡ç®— ==================== df_filt \u003c- runQTLseqAnalysis( df_filt, windowSize = 1e6, # çª—å£å¤§å° popStruc = \"F2\", # ç¾¤ä½“ç±»å‹ bulkSize = c(385, 430), # æ··æ± ä¸ªä½“æ•° replications = 10000, # Bootstrapæ¬¡æ•° intervals = c(95, 99) # ç½®ä¿¡åŒºé—´ ) # ==================== ç»“æœå¯è§†åŒ– ==================== # SNPæ²¿æŸ“è‰²ä½“åˆ†å¸ƒ p5 \u003c- plotQTLStats(SNPset = df_filt, var = \"nSNPs\") pdf(file = \"SNP_filter.window.pdf\", width = 20, height = 4) p5 dev.off() # deltaSNPindexæ²¿æŸ“è‰²ä½“åˆ†å¸ƒ p6 \u003c- plotQTLStats( SNPset = df_filt, var = \"deltaSNP\", plotIntervals = TRUE ) pdf(file = \"deltaSNPindex.pdf\", width = 20, height = 4) p6 dev.off() # ==================== æå–æ˜¾è‘—åŒºåŸŸ ==================== QTL \u003c- getSigRegions( SNPset = df_filt, method = \"QTLseq\", interval = 95 ) write.table(QTL[[1]], \"QTLseq_result.SigRegions.table\", sep = \"\\t\", quote = FALSE) # ==================== å¯¼å‡ºå®Œæ•´ç»“æœ ==================== results99 \u003c- getQTLTable( SNPset = df_filt, method = \"QTLseq\", interval = 99, export = FALSE ) write.table( results99, file = \"QTLseq_result_deltaSNPindex_CI99.table\", sep = \"\\t\", quote = FALSE ) é™„å½•ï¼šåˆ†ææµç¨‹å›¾ plaintext\nåŸå§‹æ•°æ® (FASTQ) â”‚ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ è´¨é‡æ§åˆ¶ QC â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ æ¯”å¯¹ Mapping â”‚ â”€â”€â–º BWA MEM â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ å»é‡ MarkDup â”‚ â”€â”€â–º Picard â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â–¼ â–¼ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ SNP/InDel â”‚ â”‚ SV â”‚ â”‚ CNV â”‚ â”‚ GATK â”‚ â”‚ lumpy-sv â”‚ â”‚ CNVnator â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ æ³¨é‡Š â”‚ â”‚ ANNOVAR/bedtoolsâ”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â–¼ â–¼ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ ç¾¤ä½“ç»“æ„ â”‚ â”‚ é€‰æ‹©åˆ†æ â”‚ â”‚ GWAS â”‚ â”‚ PCA/Tree â”‚ â”‚ Fst/Ï€/D â”‚ â”‚ EMMAX â”‚ â”‚ Structure â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ ","wordCount":"3378","inLanguage":"en","datePublished":"2026-02-03T12:08:55+08:00","dateModified":"2026-02-03T12:08:55+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://Tdxxxx-student.github.io/posts/%E4%BA%91%E5%8D%97%E5%86%9C%E4%B8%9A%E5%A4%A7%E5%AD%A6%E9%87%8D%E6%B5%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE%E6%95%99%E7%A8%8B/"},"publisher":{"@type":"Organization","name":"æˆ‘çš„ç©ºé—´","logo":{"@type":"ImageObject","url":"https://Tdxxxx-student.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://Tdxxxx-student.github.io/ accesskey=h title="æˆ‘çš„ç©ºé—´ (Alt + H)">æˆ‘çš„ç©ºé—´</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://Tdxxxx-student.github.io/posts/ title=é¦–é¡µ><span>é¦–é¡µ</span></a></li><li><a href=https://Tdxxxx-student.github.io/archives/ title=å½’æ¡£><span>å½’æ¡£</span></a></li><li><a href=https://Tdxxxx-student.github.io/categories/ title=åˆ†ç±»><span>åˆ†ç±»</span></a></li><li><a href=https://Tdxxxx-student.github.io/tags/ title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=https://Tdxxxx-student.github.io/search/ title="ğŸ”  (Alt + /)" accesskey=/><span>ğŸ”</span></a></li></ul></nav></header><main class=main><div id=wide-post-layout class=post-page-wrapper><div class=top-banner-decoration></div><div class=page-layout><article class=post-card><header class=post-header><div class=breadcrumbs><a href=https://Tdxxxx-student.github.io/>Home</a>&nbsp;Â»&nbsp;<a href=https://Tdxxxx-student.github.io/posts/>Posts</a></div><h1 class=post-title>äº‘å—å†œä¸šå¤§å­¦é‡æµ‹åºé¡¹ç›®æ•™ç¨‹</h1><div class=post-meta><span title='2026-02-03 12:08:55 +0800 +0800'>2026-02-03</span>&nbsp;Â·&nbsp;<span>7 min</span></div></header><div class=post-content><p>äº‘å—å†œä¸šå¤§å­¦ äº‘å—ç”Ÿç‰©èµ„æºä¿æŠ¤ä¸åˆ©ç”¨å›½å®¶é‡ç‚¹å®éªŒå®¤</p><p>æè¯¦ | 2019 å¹´ 12 æœˆ 31 æ—¥</p><h2 id=ç›®å½•>ç›®å½•<a hidden class=anchor aria-hidden=true href=#ç›®å½•>#</a></h2><ul><li><a href=#%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85>è½¯ä»¶å®‰è£…</a></li><li><a href=#%E5%8F%98%E5%BC%82%E6%A3%80%E6%B5%8B>å˜å¼‚æ£€æµ‹</a></li><li><a href=#%E7%BE%A4%E4%BD%93%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90>ç¾¤ä½“ç»“æ„åˆ†æ</a></li><li><a href=#%E9%80%89%E6%8B%A9%E5%88%86%E6%9E%90>é€‰æ‹©åˆ†æ</a></li><li><a href=#gwas%E5%88%86%E6%9E%90>GWAS åˆ†æ</a></li><li><a href=#qtl-seq%E5%88%86%E6%9E%90>QTL-seq åˆ†æ</a></li><li><a href=#%E9%99%84%E5%BD%95%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B%E5%9B%BE>é™„å½•ï¼šåˆ†ææµç¨‹å›¾</a></li></ul><h2 id=è½¯ä»¶å®‰è£…>è½¯ä»¶å®‰è£…<a hidden class=anchor aria-hidden=true href=#è½¯ä»¶å®‰è£…>#</a></h2><blockquote><p>âš ï¸ æ³¨æ„ï¼šè¯¥éƒ¨åˆ†è½¯ä»¶å¾ˆéš¾ç”¨ conda ç›´æ¥å®‰è£…ï¼Œå®‰è£…æ­¥éª¤æ¯”è¾ƒç‰¹æ®Šã€‚</p></blockquote><h3 id=1-lumpy-sv>1. lumpy-sv<a hidden class=anchor aria-hidden=true href=#1-lumpy-sv>#</a></h3><p>ğŸ’¡ lumpy-sv ä¾èµ– Python2.7ï¼Œéœ€åˆ‡æ¢åˆ° py27 ç¯å¢ƒä¸‹è¿›è¡Œå®‰è£…ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>conda activate py27
</span></span><span class=line><span class=cl>git clone --recursive https://github.com/arq5x/lumpy-sv.git
</span></span><span class=line><span class=cl><span class=nb>cd</span> lumpy-sv
</span></span><span class=line><span class=cl>make
</span></span></code></pre></div><h3 id=2-svtyper>2. svtyper<a hidden class=anchor aria-hidden=true href=#2-svtyper>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>conda install svtyper
</span></span></code></pre></div><h3 id=3-cnvnator>3. cnvnator<a hidden class=anchor aria-hidden=true href=#3-cnvnator>#</a></h3><p>ğŸ’¡ cnvnator ä¾èµ–äº root è½¯ä»¶åŒ…åŠ samtools è½¯ä»¶åŒ…ï¼ˆåŒ…å« HTSlibï¼‰ï¼Œå› æ­¤å…ˆå®‰è£…ä¾èµ–ã€‚</p><h4 id=31-å®‰è£…-samtools>3.1 å®‰è£… samtools<a hidden class=anchor aria-hidden=true href=#31-å®‰è£…-samtools>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget https://github.com/samtools/samtools/releases/download/1.9/samtools-1.9.tar.bz2
</span></span><span class=line><span class=cl>tar -xvf samtools-1.9.tar.bz2
</span></span><span class=line><span class=cl><span class=nb>cd</span> samtools-1.9/
</span></span><span class=line><span class=cl>./configure
</span></span><span class=line><span class=cl>make
</span></span></code></pre></div><h4 id=32-å®‰è£…-root-è½¯ä»¶>3.2 å®‰è£… root è½¯ä»¶<a hidden class=anchor aria-hidden=true href=#32-å®‰è£…-root-è½¯ä»¶>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ç›´æ¥ä¸‹è½½åè§£å‹å³å¯</span>
</span></span><span class=line><span class=cl>wget https://root.cern/download/root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz
</span></span><span class=line><span class=cl>tar -zxvf root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz
</span></span></code></pre></div><h4 id=33-å®‰è£…-cnvnator>3.3 å®‰è£… cnvnator<a hidden class=anchor aria-hidden=true href=#33-å®‰è£…-cnvnator>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/abyzovlab/CNVnator.git
</span></span><span class=line><span class=cl><span class=nb>cd</span> CNVnator
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é“¾æ¥samtoolsè½¯ä»¶ç›®å½•åˆ°cnvnatorç›®å½•</span>
</span></span><span class=line><span class=cl>ln -s ../samtools-1.9 ./samtools
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åŠ è½½rootè½¯ä»¶åˆ°ç¯å¢ƒå˜é‡</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ROOTSYS</span><span class=o>=</span>/pub/software/root
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span>/pub/software/root/bin:<span class=nv>$PATH</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>LD_LIBRARY_PATH</span><span class=o>=</span><span class=nv>$LD_LIBRARY_PATH</span>:<span class=nv>$ROOTSYS</span>/lib
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å®‰è£…cnvnator</span>
</span></span><span class=line><span class=cl>make <span class=nv>LIBS</span><span class=o>=</span><span class=s2>&#34;-lcrypto&#34;</span>
</span></span></code></pre></div><h2 id=å˜å¼‚æ£€æµ‹>å˜å¼‚æ£€æµ‹<a hidden class=anchor aria-hidden=true href=#å˜å¼‚æ£€æµ‹>#</a></h2><h3 id=1-æ„å»ºåŸºå› ç»„-index>1. æ„å»ºåŸºå› ç»„ index<a hidden class=anchor aria-hidden=true href=#1-æ„å»ºåŸºå› ç»„-index>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># åˆ›å»ºè½¯é“¾æ¥</span>
</span></span><span class=line><span class=cl>ln -s ../data/genome.fasta ./genome.fasta
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># for gatk</span>
</span></span><span class=line><span class=cl>samtools faidx genome.fasta
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># for bwa</span>
</span></span><span class=line><span class=cl>bwa index genome.fasta
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># for picard</span>
</span></span><span class=line><span class=cl>picard CreateSequenceDictionary <span class=nv>R</span><span class=o>=</span>genome.fasta
</span></span></code></pre></div><h3 id=2-æ¯”å¯¹æ’åºå»é‡>2. æ¯”å¯¹æ’åºå»é‡<a hidden class=anchor aria-hidden=true href=#2-æ¯”å¯¹æ’åºå»é‡>#</a></h3><h4 id=21-æ¯”å¯¹æ’åº>2.1 æ¯”å¯¹æ’åº<a hidden class=anchor aria-hidden=true href=#21-æ¯”å¯¹æ’åº>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>bwa mem -t <span class=m>2</span> -R <span class=s1>&#39;@RG\tID:S1\tSM:S1\tPL:illumina&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    ../01.ref/genome.fasta <span class=se>\
</span></span></span><span class=line><span class=cl>    ../data/S1_1.fq.gz ../data/S1_2.fq.gz <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    /pub/software/samtools/samtools sort -@ <span class=m>2</span> -m 1G -o S1.sort.bam -
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>bwa mem -t <span class=m>2</span> -R <span class=s1>&#39;@RG\tID:S2\tSM:S2\tPL:illumina&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    ../01.ref/genome.fasta <span class=se>\
</span></span></span><span class=line><span class=cl>    ../data/S2_1.fq.gz ../data/S2_2.fq.gz <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    /pub/software/samtools/samtools sort -@ <span class=m>2</span> -m 1G -o S2.sort.bam -
</span></span></code></pre></div><h4 id=22-å»é™¤é‡å¤>2.2 å»é™¤é‡å¤<a hidden class=anchor aria-hidden=true href=#22-å»é™¤é‡å¤>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>picard -Xmx4g MarkDuplicates <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=nv>I</span><span class=o>=</span>S1.sort.bam <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=nv>O</span><span class=o>=</span>S1.sort.rmdup.bam <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=nv>CREATE_INDEX</span><span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=nv>REMOVE_DUPLICATES</span><span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=nv>M</span><span class=o>=</span>S1.marked_dup_metrics.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>picard -Xmx4g MarkDuplicates <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=nv>I</span><span class=o>=</span>S2.sort.bam <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=nv>O</span><span class=o>=</span>S2.sort.rmdup.bam <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=nv>CREATE_INDEX</span><span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=nv>REMOVE_DUPLICATES</span><span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=nv>M</span><span class=o>=</span>S2.marked_dup_metrics.txt
</span></span></code></pre></div><h4 id=23-æ¯”å¯¹ç‡ç»Ÿè®¡>2.3 æ¯”å¯¹ç‡ç»Ÿè®¡<a hidden class=anchor aria-hidden=true href=#23-æ¯”å¯¹ç‡ç»Ÿè®¡>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/pub/software/samtools/samtools flagstat S1.sort.bam &gt; S1.sort.bam.flagstat
</span></span><span class=line><span class=cl>/pub/software/samtools/samtools flagstat S2.sort.bam &gt; S2.sort.bam.flagstat
</span></span></code></pre></div><h4 id=24-æ‰¹é‡æ¯”å¯¹è„šæœ¬ç”Ÿæˆ>2.4 æ‰¹é‡æ¯”å¯¹è„šæœ¬ç”Ÿæˆ<a hidden class=anchor aria-hidden=true href=#24-æ‰¹é‡æ¯”å¯¹è„šæœ¬ç”Ÿæˆ>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>less ../data/sample.list <span class=p>|</span> awk <span class=s1>&#39;{ 
</span></span></span><span class=line><span class=cl><span class=s1>    print &#34;bwa mem -t 2 -R &#39;</span><span class=se>\&#39;</span><span class=s1>&#39;@RG\\tID:&#34;$1&#34;\\tSM:&#34;$1&#34;\\tPL:illumina&#39;</span><span class=se>\&#39;</span><span class=s1>&#39; \
</span></span></span><span class=line><span class=cl><span class=s1>    ../01.ref/genome.fasta ../data/&#34;$1&#34;_1.fq.gz ../data/&#34;$1&#34;_2.fq.gz | \
</span></span></span><span class=line><span class=cl><span class=s1>    /pub/software/samtools/samtools sort -@ 2 -m 1G -o &#34;$1&#34;.sort.bam -&#34; 
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span>
</span></span></code></pre></div><h3 id=3-snpindel-æ£€æµ‹>3. SNPã€Indel æ£€æµ‹<a hidden class=anchor aria-hidden=true href=#3-snpindel-æ£€æµ‹>#</a></h3><h4 id=31-haplotypecaller>3.1 HaplotypeCaller<a hidden class=anchor aria-hidden=true href=#31-haplotypecaller>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gatk --java-options <span class=s2>&#34;-Xmx10g -Djava.io.tmpdir=./tmp&#34;</span> HaplotypeCaller <span class=se>\
</span></span></span><span class=line><span class=cl>    -R ../01.ref/genome.fasta <span class=se>\
</span></span></span><span class=line><span class=cl>    -I ../02.mapping/S1.sort.rmdup.bam <span class=se>\
</span></span></span><span class=line><span class=cl>    -ERC GVCF <span class=se>\
</span></span></span><span class=line><span class=cl>    -O S1.g.vcf 1&gt;S1.HC.log 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>gatk --java-options <span class=s2>&#34;-Xmx10g -Djava.io.tmpdir=./tmp&#34;</span> HaplotypeCaller <span class=se>\
</span></span></span><span class=line><span class=cl>    -R ../01.ref/genome.fasta <span class=se>\
</span></span></span><span class=line><span class=cl>    -I ../02.mapping/S2.sort.rmdup.bam <span class=se>\
</span></span></span><span class=line><span class=cl>    -ERC GVCF <span class=se>\
</span></span></span><span class=line><span class=cl>    -O S2.g.vcf 1&gt;S2.HC.log 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span></code></pre></div><h4 id=32-combinegvcfs>3.2 CombineGVCFs<a hidden class=anchor aria-hidden=true href=#32-combinegvcfs>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ls ./S*.g.vcf &gt; gvcf.list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>gatk --java-options <span class=s2>&#34;-Xmx4g -Djava.io.tmpdir=./tmp&#34;</span> CombineGVCFs <span class=se>\
</span></span></span><span class=line><span class=cl>    -R ../01.ref/genome.fasta <span class=se>\
</span></span></span><span class=line><span class=cl>    -V gvcf.list <span class=se>\
</span></span></span><span class=line><span class=cl>    -O all.merge.g.vcf
</span></span></code></pre></div><h4 id=33genotpegvcfs>3.3GenotpeGVCFs<a hidden class=anchor aria-hidden=true href=#33genotpegvcfs>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gatk --java-options <span class=s2>&#34;-Xmx4g -Djava.io.tmpdir=./tmp&#34;</span> GenotypeGVCFs <span class=se>\
</span></span></span><span class=line><span class=cl>    -R ../01.ref/genome.fasta <span class=se>\
</span></span></span><span class=line><span class=cl>    --variant all.merge.g.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    -O all.merge_raw.vcf
</span></span></code></pre></div><h4 id=34-snp-è¿‡æ»¤>3.4 SNP è¿‡æ»¤<a hidden class=anchor aria-hidden=true href=#34-snp-è¿‡æ»¤>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># æå–SNP</span>
</span></span><span class=line><span class=cl>gatk --java-options <span class=s2>&#34;-Xmx4g -Djava.io.tmpdir=./tmp&#34;</span> SelectVariants <span class=se>\
</span></span></span><span class=line><span class=cl>    -R ../01.ref/genome.fasta <span class=se>\
</span></span></span><span class=line><span class=cl>    -V all.merge_raw.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    --select-type SNP <span class=se>\
</span></span></span><span class=line><span class=cl>    -O all.raw.snp.vcf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ ‡è®°è¿‡æ»¤</span>
</span></span><span class=line><span class=cl>gatk --java-options <span class=s2>&#34;-Xmx4g -Djava.io.tmpdir=./tmp&#34;</span> VariantFiltration <span class=se>\
</span></span></span><span class=line><span class=cl>    -R ../01.ref/genome.fasta <span class=se>\
</span></span></span><span class=line><span class=cl>    -V all.raw.snp.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    --filter-expression <span class=s2>&#34;QD &lt; 2.0 || MQ &lt; 40.0 || FS &gt; 60.0 || SOR &gt; 3.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt; -8.0&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --filter-name <span class=s1>&#39;SNP_filter&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    -O all.filter.snp.vcf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æå–è¿‡æ»¤åçš„SNP</span>
</span></span><span class=line><span class=cl>gatk --java-options <span class=s2>&#34;-Xmx4g -Djava.io.tmpdir=./tmp&#34;</span> SelectVariants <span class=se>\
</span></span></span><span class=line><span class=cl>    -R ../01.ref/genome.fasta <span class=se>\
</span></span></span><span class=line><span class=cl>    -V all.filter.snp.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    --exclude-filtered <span class=se>\
</span></span></span><span class=line><span class=cl>    -O all.filtered.snp.vcf
</span></span></code></pre></div><h4 id=35-indel-è¿‡æ»¤>3.5 InDel è¿‡æ»¤<a hidden class=anchor aria-hidden=true href=#35-indel-è¿‡æ»¤>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># æå–InDel</span>
</span></span><span class=line><span class=cl>gatk --java-options <span class=s2>&#34;-Xmx4g -Djava.io.tmpdir=./tmp&#34;</span> SelectVariants <span class=se>\
</span></span></span><span class=line><span class=cl>    -R ../01.ref/genome.fasta <span class=se>\
</span></span></span><span class=line><span class=cl>    -V all.merge_raw.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    --select-type INDEL <span class=se>\
</span></span></span><span class=line><span class=cl>    -O all.raw.indel.vcf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ ‡è®°è¿‡æ»¤</span>
</span></span><span class=line><span class=cl>gatk --java-options <span class=s2>&#34;-Xmx4g -Djava.io.tmpdir=./tmp&#34;</span> VariantFiltration <span class=se>\
</span></span></span><span class=line><span class=cl>    -R ../01.ref/genome.fasta <span class=se>\
</span></span></span><span class=line><span class=cl>    -V all.raw.indel.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    --filter-expression <span class=s2>&#34;QD &lt; 2.0 || FS &gt; 200.0 || SOR &gt; 10.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt; -8.0&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --filter-name <span class=s1>&#39;INDEL_filter&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    -O all.filter.indel.vcf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æå–è¿‡æ»¤åçš„InDel</span>
</span></span><span class=line><span class=cl>gatk --java-options <span class=s2>&#34;-Xmx4g -Djava.io.tmpdir=./tmp&#34;</span> SelectVariants <span class=se>\
</span></span></span><span class=line><span class=cl>    -R ../01.ref/genome.fasta <span class=se>\
</span></span></span><span class=line><span class=cl>    -V all.filter.indel.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    --exclude-filtered <span class=se>\
</span></span></span><span class=line><span class=cl>    -O all.filtered.indel.vcf
</span></span></code></pre></div><h3 id=4-sv-æ£€æµ‹>4. SV æ£€æµ‹<a hidden class=anchor aria-hidden=true href=#4-sv-æ£€æµ‹>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Step 1: æå– discordants reads</span>
</span></span><span class=line><span class=cl>/pub/software/samtools/samtools view -b -F <span class=m>1294</span> -@ <span class=m>12</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    ../02.mapping/S1.sort.rmdup.bam &gt; S1.discordants.bam
</span></span><span class=line><span class=cl>/pub/software/samtools/samtools view -b -F <span class=m>1294</span> -@ <span class=m>12</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    ../02.mapping/S2.sort.rmdup.bam &gt; S2.discordants.bam
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 2: æå– split reads</span>
</span></span><span class=line><span class=cl>/pub/software/samtools/samtools view -h ../02.mapping/S1.sort.rmdup.bam <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    /pub/software/lumpy-sv/scripts/extractSplitReads_BwaMem -i stdin <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    /pub/software/samtools/samtools sort - &gt; S1.splitters.bam
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/pub/software/samtools/samtools view -h ../02.mapping/S2.sort.rmdup.bam <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    /pub/software/lumpy-sv/scripts/extractSplitReads_BwaMem -i stdin <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    /pub/software/samtools/samtools sort - &gt; S2.splitters.bam
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 3: è¿è¡Œ lumpy</span>
</span></span><span class=line><span class=cl>/pub/software/lumpy-sv/bin/lumpyexpress <span class=se>\
</span></span></span><span class=line><span class=cl>    -B ../02.mapping/S1.sort.rmdup.bam,../02.mapping/S2.sort.rmdup.bam <span class=se>\
</span></span></span><span class=line><span class=cl>    -S S1.splitters.bam,S2.splitters.bam <span class=se>\
</span></span></span><span class=line><span class=cl>    -D S1.discordants.bam,S2.discordants.bam <span class=se>\
</span></span></span><span class=line><span class=cl>    -o all.sv.lumpy.vcf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 4: ä¸ªä½“åŸºå› å‹åˆ†å‹</span>
</span></span><span class=line><span class=cl>vcftools --vcf all.sv.lumpy.vcf --indv S1 --recode --recode-INFO-all --out S1 <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    svtyper -i S1.recode.vcf -B ../02.mapping/S1.sort.rmdup.bam -o S1.genotype.vcf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>vcftools --vcf all.sv.lumpy.vcf --indv S2 --recode --recode-INFO-all --out S2 <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    svtyper -i S2.recode.vcf -B ../02.mapping/S2.sort.rmdup.bam -o S2.genotype.vcf
</span></span></code></pre></div><h3 id=5-cnv-æ£€æµ‹>5. CNV æ£€æµ‹<a hidden class=anchor aria-hidden=true href=#5-cnv-æ£€æµ‹>#</a></h3><h4 id=51-å‡†å¤‡åŸºå› ç»„>5.1 å‡†å¤‡åŸºå› ç»„<a hidden class=anchor aria-hidden=true href=#51-å‡†å¤‡åŸºå› ç»„>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å°†åŸºå› ç»„æ‹†åˆ†ä¸ºå•æ¡æŸ“è‰²ä½“</span>
</span></span><span class=line><span class=cl>ln -s ../data/genome.fasta ./genome.fa
</span></span><span class=line><span class=cl>seqkit split -i ./genome.fa -O split
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é‡å‘½åæ–‡ä»¶</span>
</span></span><span class=line><span class=cl>ls ./split/genome.id_*.fa <span class=p>|</span> sed <span class=s1>&#39;s/./split/genome.id_//&#39;</span> <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    awk <span class=s1>&#39;{print &#34;mv ./split/genome.id_&#34;$aa&#34; ./split/&#34;$aa}&#39;</span> &gt; mv_name.sh
</span></span><span class=line><span class=cl>sh mv_name.sh
</span></span></code></pre></div><h4 id=52-è¿è¡Œ-cnvnator>5.2 è¿è¡Œ cnvnator<a hidden class=anchor aria-hidden=true href=#52-è¿è¡Œ-cnvnator>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># è®¾ç½®ç¯å¢ƒå˜é‡</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ROOTSYS</span><span class=o>=</span>/pub/software/root
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span>/pub/software/root/bin:<span class=nv>$PATH</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>LD_LIBRARY_PATH</span><span class=o>=</span><span class=nv>$LD_LIBRARY_PATH</span>:<span class=nv>$ROOTSYS</span>/lib
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é“¾æ¥æ–‡ä»¶</span>
</span></span><span class=line><span class=cl>ln -s ../02.mapping/S1.sort.rmdup.bam
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æå–æ¯”å¯¹ç»“æœ</span>
</span></span><span class=line><span class=cl>/pub/software/CNVnator/cnvnator -genome genome.fa -root S1.root -tree S1.sort.rmdup.bam
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç”Ÿæˆæ·±åº¦åˆ†å¸ƒ</span>
</span></span><span class=line><span class=cl>/pub/software/CNVnator/cnvnator -genome genome.fa -root S1.root -his <span class=m>500</span> -d split
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¿›è¡Œç»Ÿè®¡è®¡ç®—</span>
</span></span><span class=line><span class=cl>/pub/software/CNVnator/cnvnator -root S1.root -stat <span class=m>500</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ£€æŸ¥bin sizeæ˜¯å¦åˆé€‚</span>
</span></span><span class=line><span class=cl>/pub/software/CNVnator/cnvnator -root S1.root -eval <span class=m>500</span> &gt; S1.eval.ratio
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># RDä¿¡å·åˆ†å‰²</span>
</span></span><span class=line><span class=cl>/pub/software/CNVnator/cnvnator -root S1.root -partition <span class=m>500</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¿›è¡ŒCNVæ£€æµ‹</span>
</span></span><span class=line><span class=cl>/pub/software/CNVnator/cnvnator -root S1.root -call <span class=m>500</span> &gt; S1.cnv
</span></span></code></pre></div><h3 id=6-snpindel-æ³¨é‡Š>6. SNP/InDel æ³¨é‡Š<a hidden class=anchor aria-hidden=true href=#6-snpindel-æ³¨é‡Š>#</a></h3><h4 id=61-å‡†å¤‡æ³¨é‡Šæ•°æ®åº“>6.1 å‡†å¤‡æ³¨é‡Šæ•°æ®åº“<a hidden class=anchor aria-hidden=true href=#61-å‡†å¤‡æ³¨é‡Šæ•°æ®åº“>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ln -s ../data/genome.gtf
</span></span><span class=line><span class=cl>ln -s ../data/genome.fasta
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>gtfToGenePred -genePredExt genome.gtf genome_refGene.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/pub/software/annovar/retrieve_seq_from_fasta.pl <span class=se>\
</span></span></span><span class=line><span class=cl>    --format refGene <span class=se>\
</span></span></span><span class=line><span class=cl>    --seqfile genome.fasta <span class=se>\
</span></span></span><span class=line><span class=cl>    genome_refGene.txt <span class=se>\
</span></span></span><span class=line><span class=cl>    --out genome_refGeneMrna.fa
</span></span></code></pre></div><h4 id=62-æ³¨é‡Š-vcf-æ–‡ä»¶>6.2 æ³¨é‡Š VCF æ–‡ä»¶<a hidden class=anchor aria-hidden=true href=#62-æ³¨é‡Š-vcf-æ–‡ä»¶>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ln -s ../03.SNP_indel/all.filtered.snp.vcf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ ¼å¼è½¬æ¢</span>
</span></span><span class=line><span class=cl>/pub/software/annovar/convert2annovar.pl <span class=se>\
</span></span></span><span class=line><span class=cl>    -format vcf4old <span class=se>\
</span></span></span><span class=line><span class=cl>    all.filtered.snp.vcf &gt; all.snp.vcf.annovar.input
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¿›è¡Œæ³¨é‡Š</span>
</span></span><span class=line><span class=cl>/pub/software/annovar/annotate_variation.pl <span class=se>\
</span></span></span><span class=line><span class=cl>    -geneanno <span class=se>\
</span></span></span><span class=line><span class=cl>    --neargene <span class=m>2000</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    -buildver genome <span class=se>\
</span></span></span><span class=line><span class=cl>    -dbtype refGene <span class=se>\
</span></span></span><span class=line><span class=cl>    -outfile all.anno <span class=se>\
</span></span></span><span class=line><span class=cl>    -exonsort <span class=se>\
</span></span></span><span class=line><span class=cl>    all.snp.vcf.annovar.input ./
</span></span></code></pre></div><h3 id=7-cnv-å’Œ-sv-æ³¨é‡Š>7. CNV å’Œ SV æ³¨é‡Š<a hidden class=anchor aria-hidden=true href=#7-cnv-å’Œ-sv-æ³¨é‡Š>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å¤„ç†SVæ–‡ä»¶</span>
</span></span><span class=line><span class=cl>less -S ../04.SV/all.sv.lumpy.vcf <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    awk -F <span class=s2>&#34;;&#34;</span> <span class=s1>&#39;{ if($1!~/#/){print $1&#34;\t&#34;$2&#34;\t&#34;$3&#34;\t&#34;$4} }&#39;</span> <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    awk <span class=s1>&#39;{print $1&#34;\t&#34;$2&#34;\t&#34;$11&#34;\t&#34;$3&#34;\t&#34;$8}&#39;</span> <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    sed <span class=s1>&#39;s/END=//&#39;</span> <span class=p>|</span> sed <span class=s1>&#39;s/SVTYPE=//&#39;</span> &gt; SV.bed
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¿‡æ»¤BNDç±»å‹</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;$5 !~ /BND/&#39;</span> SV.bed &gt; SV_filter.bed
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SVæ³¨é‡Š</span>
</span></span><span class=line><span class=cl>bedtools intersect -wo -a SV_filter.bed -b gene.gtf &gt; SV_filter.Anno
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¤„ç†CNVæ–‡ä»¶</span>
</span></span><span class=line><span class=cl>less -S ../05.CNV/S1.cnv <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    awk <span class=s1>&#39;{print $2 &#34;\t&#34; $1}&#39;</span> <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    sed <span class=s1>&#39;s/:/\t/&#39;</span> <span class=p>|</span> sed <span class=s1>&#39;s/-/\t/&#39;</span> &gt; CNV.bed
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CNVæ³¨é‡Š</span>
</span></span><span class=line><span class=cl>bedtools intersect -wo -a CNV.bed -b gene.gtf &gt; CNV.Anno
</span></span></code></pre></div><h2 id=ç¾¤ä½“ç»“æ„åˆ†æ>ç¾¤ä½“ç»“æ„åˆ†æ<a hidden class=anchor aria-hidden=true href=#ç¾¤ä½“ç»“æ„åˆ†æ>#</a></h2><h3 id=1-æ•°æ®è¿‡æ»¤>1. æ•°æ®è¿‡æ»¤<a hidden class=anchor aria-hidden=true href=#1-æ•°æ®è¿‡æ»¤>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>vcf</span><span class=o>=</span>../data/all.vcf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¿‡æ»¤ç¼ºå¤±ç‡å’Œæœ€å°ç­‰ä½åŸºå› é¢‘ç‡</span>
</span></span><span class=line><span class=cl>plink --vcf <span class=nv>$vcf</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --geno 0.1 <span class=se>\
</span></span></span><span class=line><span class=cl>    --maf 0.01 <span class=se>\
</span></span></span><span class=line><span class=cl>    --out all.missing_maf <span class=se>\
</span></span></span><span class=line><span class=cl>    --recode vcf-iid <span class=se>\
</span></span></span><span class=line><span class=cl>    --allow-extra-chr <span class=se>\
</span></span></span><span class=line><span class=cl>    --set-missing-var-ids @:# <span class=se>\
</span></span></span><span class=line><span class=cl>    --keep-allele-order
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¿‡æ»¤è¿é”ä¸å¹³è¡¡</span>
</span></span><span class=line><span class=cl>plink --vcf all.missing_maf.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    --indep-pairwise <span class=m>50</span> <span class=m>10</span> 0.2 <span class=se>\
</span></span></span><span class=line><span class=cl>    --out tmp.ld <span class=se>\
</span></span></span><span class=line><span class=cl>    --allow-extra-chr <span class=se>\
</span></span></span><span class=line><span class=cl>    --set-missing-var-ids @:#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>plink --vcf all.missing_maf.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    --make-bed <span class=se>\
</span></span></span><span class=line><span class=cl>    --extract tmp.ld.prune.in <span class=se>\
</span></span></span><span class=line><span class=cl>    --out all.LDfilter <span class=se>\
</span></span></span><span class=line><span class=cl>    --recode vcf-iid <span class=se>\
</span></span></span><span class=line><span class=cl>    --keep-allele-order <span class=se>\
</span></span></span><span class=line><span class=cl>    --allow-extra-chr <span class=se>\
</span></span></span><span class=line><span class=cl>    --set-missing-var-ids @:#
</span></span></code></pre></div><h3 id=2-å»ºæ ‘åˆ†æ>2. å»ºæ ‘åˆ†æ<a hidden class=anchor aria-hidden=true href=#2-å»ºæ ‘åˆ†æ>#</a></h3><h4 id=21-nj-æ ‘>2.1 NJ æ ‘<a hidden class=anchor aria-hidden=true href=#21-nj-æ ‘>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># æ ¼å¼è½¬æ¢</span>
</span></span><span class=line><span class=cl>perl ../../script/vcf2phy.pl ../../00.filter/all.LDfilter.vcf &gt; sequences.dat
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è®¡ç®—é—ä¼ è·ç¦»</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> -e <span class=s2>&#34;sequences.dat\nY&#34;</span> &gt; dnadist.cfg
</span></span><span class=line><span class=cl>dnadist &lt; dnadist.cfg &gt; dnadist.log
</span></span><span class=line><span class=cl>mv outfile infile.dist
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ„å»ºNJæ ‘</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> -e <span class=s2>&#34;infile.dist\nY&#34;</span> &gt; neighbor.cfg
</span></span><span class=line><span class=cl>neighbor &lt; neighbor.cfg &gt; nj.log
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ ¼å¼æ•´ç†</span>
</span></span><span class=line><span class=cl>less infile.dist <span class=p>|</span> tr <span class=s1>&#39;\n&#39;</span> <span class=s1>&#39;|&#39;</span> <span class=p>|</span> sed <span class=s1>&#39;s/| / /g&#39;</span> <span class=p>|</span> tr <span class=s1>&#39;|&#39;</span> <span class=s1>&#39;\n&#39;</span> &gt; infile.dist.table
</span></span><span class=line><span class=cl>less outtree <span class=p>|</span> tr <span class=s1>&#39;\n&#39;</span> <span class=s1>&#39; &#39;</span> <span class=p>|</span> sed <span class=s1>&#39;s/ //g&#39;</span> &gt; outtree.nwk
</span></span></code></pre></div><h4 id=22-snphylo-å»ºæ ‘>2.2 SNPhylo å»ºæ ‘<a hidden class=anchor aria-hidden=true href=#22-snphylo-å»ºæ ‘>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/pub/software/SNPhylo/snphylo.sh <span class=se>\
</span></span></span><span class=line><span class=cl>    -v ../../00.filter/all.LDfilter.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    -r <span class=se>\
</span></span></span><span class=line><span class=cl>    -l <span class=m>1</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    -m 0.01 <span class=se>\
</span></span></span><span class=line><span class=cl>    -o GA0001 <span class=se>\
</span></span></span><span class=line><span class=cl>    -b <span class=se>\
</span></span></span><span class=line><span class=cl>    -B <span class=m>2</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    -P tree_snphylo
</span></span></code></pre></div><h3 id=3-pca-åˆ†æ>3. PCA åˆ†æ<a hidden class=anchor aria-hidden=true href=#3-pca-åˆ†æ>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>plink --vcf ../00.filter/all.LDfilter.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    --pca <span class=m>10</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --out PCA_out <span class=se>\
</span></span></span><span class=line><span class=cl>    --allow-extra-chr <span class=se>\
</span></span></span><span class=line><span class=cl>    --set-missing-var-ids @:#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Rscript ../script/draw_PCA.R PCA_out.eigenvec <span class=m>1</span> <span class=m>2</span> ../data/sample.pop PCA_out_figure
</span></span></code></pre></div><h3 id=4-ç¾¤ä½“ç»“æ„åˆ†æ>4. ç¾¤ä½“ç»“æ„åˆ†æ<a hidden class=anchor aria-hidden=true href=#4-ç¾¤ä½“ç»“æ„åˆ†æ>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Step 0: vcfè½¬bedæ ¼å¼</span>
</span></span><span class=line><span class=cl>plink --vcf ../00.filter/all.LDfilter.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    --make-bed <span class=se>\
</span></span></span><span class=line><span class=cl>    --out all <span class=se>\
</span></span></span><span class=line><span class=cl>    --allow-extra-chr <span class=se>\
</span></span></span><span class=line><span class=cl>    --keep-allele-order <span class=se>\
</span></span></span><span class=line><span class=cl>    --set-missing-var-ids @:#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 1: ç”ŸæˆAdmixtureè¿è¡Œè„šæœ¬</span>
</span></span><span class=line><span class=cl>seq <span class=m>2</span> <span class=m>4</span> <span class=p>|</span> awk <span class=s1>&#39;{print &#34;admixture --cv -j2 all.bed &#34;$1&#34; 1&gt;admix.&#34;$1&#34;.log 2&gt;&amp;1&#34;}&#39;</span> &gt; admixture.sh
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 2: è¿è¡ŒAdmixture</span>
</span></span><span class=line><span class=cl>sh admixture.sh
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¹Ÿå¯å•ç‹¬è¿è¡Œ</span>
</span></span><span class=line><span class=cl>admixture --cv -j2 all.bed <span class=m>2</span> 1&gt;admix.2.log 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>admixture --cv -j2 all.bed <span class=m>3</span> 1&gt;admix.3.log 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>admixture --cv -j2 all.bed <span class=m>4</span> 1&gt;admix.4.log 2&gt;<span class=p>&amp;</span><span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 3: ç»˜åˆ¶ç»“æ„å›¾</span>
</span></span><span class=line><span class=cl>mkdir result
</span></span><span class=line><span class=cl>cp ./*.Q result/
</span></span><span class=line><span class=cl>Rscript ../script/draw_admixture.R result all.nosex structure
</span></span></code></pre></div><h3 id=5-ld-è¡°å‡åˆ†æ>5. LD è¡°å‡åˆ†æ<a hidden class=anchor aria-hidden=true href=#5-ld-è¡°å‡åˆ†æ>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Step 1: è®¡ç®—LD</span>
</span></span><span class=line><span class=cl>/pub/software/PopLDdecay/bin/PopLDdecay <span class=se>\
</span></span></span><span class=line><span class=cl>    -InVCF ../data/all.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    -SubPop ../data/pop.SC.table <span class=se>\
</span></span></span><span class=line><span class=cl>    -MaxDist <span class=m>500</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    -OutStat pop.SC.stat
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/pub/software/PopLDdecay/bin/PopLDdecay <span class=se>\
</span></span></span><span class=line><span class=cl>    -InVCF ../data/all.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    -SubPop ../data/pop.YZR.table <span class=se>\
</span></span></span><span class=line><span class=cl>    -MaxDist <span class=m>500</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    -OutStat pop.YZR.stat
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 2: ç»˜åˆ¶å•ç¾¤ä½“LDè¡°å‡å›¾</span>
</span></span><span class=line><span class=cl>perl /pub/software/PopLDdecay/bin/Plot_OnePop.pl <span class=se>\
</span></span></span><span class=line><span class=cl>    -inFile pop.SC.stat.gz <span class=se>\
</span></span></span><span class=line><span class=cl>    -output pop.SC.ld
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>perl /pub/software/PopLDdecay/bin/Plot_OnePop.pl <span class=se>\
</span></span></span><span class=line><span class=cl>    -inFile pop.YZR.stat.gz <span class=se>\
</span></span></span><span class=line><span class=cl>    -output pop.YZR.ld
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 3: ç»˜åˆ¶å¤šç¾¤ä½“LDè¡°å‡å›¾</span>
</span></span><span class=line><span class=cl>perl /pub/software/PopLDdecay/bin/Plot_MultiPop.pl <span class=se>\
</span></span></span><span class=line><span class=cl>    -inList ld_stat.list <span class=se>\
</span></span></span><span class=line><span class=cl>    -output ld_stat.multi
</span></span></code></pre></div><h2 id=é€‰æ‹©åˆ†æ>é€‰æ‹©åˆ†æ<a hidden class=anchor aria-hidden=true href=#é€‰æ‹©åˆ†æ>#</a></h2><h3 id=1-Ï€-å’Œ-rod-åˆ†æ>1. Ï€ å’Œ ROD åˆ†æ<a hidden class=anchor aria-hidden=true href=#1-Ï€-å’Œ-rod-åˆ†æ>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>vcf</span><span class=o>=</span>../../data/all.vcf
</span></span><span class=line><span class=cl><span class=nv>window</span><span class=o>=</span><span class=m>20000</span>
</span></span><span class=line><span class=cl><span class=nv>step</span><span class=o>=</span><span class=m>2000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 1: è®¡ç®—piå€¼</span>
</span></span><span class=line><span class=cl>vcftools --vcf <span class=nv>$vcf</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --window-pi <span class=nv>$window</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --window-pi-step <span class=nv>$step</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --keep ../../data/pop.SC.table <span class=se>\
</span></span></span><span class=line><span class=cl>    --out ./Pi.pop1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>vcftools --vcf <span class=nv>$vcf</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --window-pi <span class=nv>$window</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --window-pi-step <span class=nv>$step</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --keep ../../data/pop.YZR.table <span class=se>\
</span></span></span><span class=line><span class=cl>    --out ./Pi.pop2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 2: è®¡ç®—ROD</span>
</span></span><span class=line><span class=cl><span class=nv>pi1</span><span class=o>=</span>Pi.pop1.windowed.pi
</span></span><span class=line><span class=cl><span class=nv>pi2</span><span class=o>=</span>Pi.pop2.windowed.pi
</span></span><span class=line><span class=cl>perl ../../script/merge2pi_ROD.pl <span class=nv>$pi1</span> <span class=nv>$pi2</span> &gt; Pi.ROD
</span></span></code></pre></div><h3 id=2-tajimas-d-åˆ†æ>2. Tajima&rsquo;s D åˆ†æ<a hidden class=anchor aria-hidden=true href=#2-tajimas-d-åˆ†æ>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>vcf</span><span class=o>=</span>../../data/all.vcf
</span></span><span class=line><span class=cl><span class=nv>window</span><span class=o>=</span><span class=m>20000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>vcftools --vcf <span class=nv>$vcf</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --TajimaD <span class=nv>$window</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --keep ../../data/pop.SC.table <span class=se>\
</span></span></span><span class=line><span class=cl>    --out TajimaD.pop1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>vcftools --vcf <span class=nv>$vcf</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --TajimaD <span class=nv>$window</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --keep ../../data/pop.YZR.table <span class=se>\
</span></span></span><span class=line><span class=cl>    --out TajimaD.pop2
</span></span></code></pre></div><h3 id=3-fst-åˆ†æ>3. Fst åˆ†æ<a hidden class=anchor aria-hidden=true href=#3-fst-åˆ†æ>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>vcf</span><span class=o>=</span>../../data/all.vcf
</span></span><span class=line><span class=cl><span class=nv>window</span><span class=o>=</span><span class=m>20000</span>
</span></span><span class=line><span class=cl><span class=nv>step</span><span class=o>=</span><span class=m>2000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>vcftools --vcf <span class=nv>$vcf</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --fst-window-size <span class=nv>$window</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --fst-window-step <span class=nv>$step</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --weir-fst-pop ../../data/pop.SC.table <span class=se>\
</span></span></span><span class=line><span class=cl>    --weir-fst-pop ../../data/pop.YZR.table <span class=se>\
</span></span></span><span class=line><span class=cl>    --out ./Fst.pop1.pop2
</span></span></code></pre></div><h3 id=4-rod--fst-è”åˆåˆ†æ>4. ROD + Fst è”åˆåˆ†æ<a hidden class=anchor aria-hidden=true href=#4-rod--fst-è”åˆåˆ†æ>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>fst</span><span class=o>=</span>../03.Fst/Fst.pop1.pop2.windowed.weir.fst
</span></span><span class=line><span class=cl><span class=nv>ROD</span><span class=o>=</span>../01.pi_ROD/Pi.ROD
</span></span><span class=line><span class=cl><span class=nv>gff</span><span class=o>=</span>../../data/genome.gff
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æå–æ˜¾è‘—ä½ç‚¹</span>
</span></span><span class=line><span class=cl>perl ../../script/top_Fst_ROD_S.pl <span class=nv>$fst</span> <span class=nv>$ROD</span> 0.05 0.05 Fst_ROD.table Fst_ROD.stat
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç­›é€‰topä½ç‚¹</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;$NF==&#34;top&#34;&#39;</span> Fst_ROD.table &gt; Fst_ROD.table.top
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æå–åŸºå› æ³¨é‡Š</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;$3==&#34;gene&#34;&#39;</span> <span class=nv>$gff</span> &gt; gene.gff
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ³¨é‡Šå€™é€‰åŸºå› </span>
</span></span><span class=line><span class=cl>bedtools intersect -wo -F 0.1 -a Fst_ROD.table.top -b gene.gff <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    awk -F <span class=s2>&#34;\t&#34;</span> <span class=s1>&#39;{print $7&#34;\t&#34;$10&#34;\t&#34;$11&#34;\t&#34;$13&#34;\t&#34;$15}&#39;</span> <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    sort -u &gt; Fst_ROD.table.top.gene
</span></span></code></pre></div><h2 id=gwas-åˆ†æ>GWAS åˆ†æ<a hidden class=anchor aria-hidden=true href=#gwas-åˆ†æ>#</a></h2><h3 id=1-åŸºå› å‹å¡«å……>1. åŸºå› å‹å¡«å……<a hidden class=anchor aria-hidden=true href=#1-åŸºå› å‹å¡«å……>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>beagle -Xmx4g -Djava.io.tmpdir<span class=o>=</span>./TMP <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=nv>gt</span><span class=o>=</span>../data/all.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=nv>out</span><span class=o>=</span>all.impute <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=nv>impute</span><span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=nv>window</span><span class=o>=</span><span class=m>10</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    <span class=nv>nthreads</span><span class=o>=</span><span class=m>2</span>
</span></span></code></pre></div><h3 id=2-æ ‡å‡†-gwas-åˆ†æ>2. æ ‡å‡† GWAS åˆ†æ<a hidden class=anchor aria-hidden=true href=#2-æ ‡å‡†-gwas-åˆ†æ>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Step 1: å‡†å¤‡VCFæ•°æ®</span>
</span></span><span class=line><span class=cl>plink --vcf ../data/all.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    --maf 0.05 <span class=se>\
</span></span></span><span class=line><span class=cl>    --geno 0.1 <span class=se>\
</span></span></span><span class=line><span class=cl>    --recode12 <span class=se>\
</span></span></span><span class=line><span class=cl>    --output-missing-genotype <span class=m>0</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --transpose <span class=se>\
</span></span></span><span class=line><span class=cl>    --out snp_filter <span class=se>\
</span></span></span><span class=line><span class=cl>    --set-missing-var-ids @:# <span class=se>\
</span></span></span><span class=line><span class=cl>    --allow-extra-chr
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å‡†å¤‡è¡¨å‹æ•°æ®</span>
</span></span><span class=line><span class=cl>perl ../script/sort_pheno.pl snp_filter.tfam ../data/trait.table &gt; trait.sort.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 2: è®¡ç®—äº²ç¼˜å…³ç³»çŸ©é˜µ</span>
</span></span><span class=line><span class=cl>/pub/software/emmax/emmax-kin-intel64 -v -d <span class=m>10</span> -o ./pop.kinship snp_filter
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 3: è¿è¡ŒGWAS</span>
</span></span><span class=line><span class=cl>/pub/software/emmax/emmax-intel64 -v -d <span class=m>10</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    -t snp_filter <span class=se>\
</span></span></span><span class=line><span class=cl>    -p trait.sort.txt <span class=se>\
</span></span></span><span class=line><span class=cl>    -k pop.kinship <span class=se>\
</span></span></span><span class=line><span class=cl>    -o emmax.out 1&gt; emmax.log 2&gt;emmax.err
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 4: ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾</span>
</span></span><span class=line><span class=cl>paste snp_filter.map emmax.out.ps <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    awk <span class=s1>&#39;BEGIN{print &#34;SNP\tCHR\tBP\tP&#34;}{if($2==$5){print $2&#34;\t&#34;$1&#34;\t&#34;$4&#34;\t&#34;$NF}}&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    &gt; emmax.out.ps.manht_input
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Rscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure
</span></span></code></pre></div><h3 id=3-gwas-q-åˆ†æåŠ å…¥ç¾¤ä½“ç»“æ„åå˜é‡>3. GWAS-Q åˆ†æï¼ˆåŠ å…¥ç¾¤ä½“ç»“æ„åå˜é‡ï¼‰<a hidden class=anchor aria-hidden=true href=#3-gwas-q-åˆ†æåŠ å…¥ç¾¤ä½“ç»“æ„åå˜é‡>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># é“¾æ¥æ–‡ä»¶</span>
</span></span><span class=line><span class=cl>ln -s ../01.GWAS/snp_filter.tped
</span></span><span class=line><span class=cl>ln -s ../01.GWAS/snp_filter.tfam
</span></span><span class=line><span class=cl>ln -s ../01.GWAS/snp_filter.nosex
</span></span><span class=line><span class=cl>ln -s ../01.GWAS/snp_filter.map
</span></span><span class=line><span class=cl>ln -s ../01.GWAS/trait.sort.txt
</span></span><span class=line><span class=cl>ln -s ../../02.population_genetics/03.structure/all.3.Q
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å‡†å¤‡QçŸ©é˜µ</span>
</span></span><span class=line><span class=cl>paste snp_filter.nosex all.3.Q <span class=p>|</span> awk <span class=s1>&#39;{print $1&#34; &#34;$1&#34; 1 &#34;$3&#34; &#34;$4}&#39;</span> &gt; pop.Qmatrix
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è¿è¡ŒGWAS</span>
</span></span><span class=line><span class=cl>/pub/software/emmax/emmax-intel64 -v -d <span class=m>10</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    -t snp_filter <span class=se>\
</span></span></span><span class=line><span class=cl>    -p trait.sort.txt <span class=se>\
</span></span></span><span class=line><span class=cl>    -k pop.kinship <span class=se>\
</span></span></span><span class=line><span class=cl>    -c pop.Qmatrix <span class=se>\
</span></span></span><span class=line><span class=cl>    -o emmax.out 1&gt; emmax.log 2&gt;emmax.err
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾</span>
</span></span><span class=line><span class=cl>paste snp_filter.map emmax.out.ps <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    awk <span class=s1>&#39;BEGIN{print &#34;SNP\tCHR\tBP\tP&#34;}{if($2==$5){print $2&#34;\t&#34;$1&#34;\t&#34;$4&#34;\t&#34;$NF}}&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    &gt; emmax.out.ps.manht_input
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Rscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure_Q
</span></span></code></pre></div><h3 id=4-çœŸå®æ•°æ®-gwas>4. çœŸå®æ•°æ® GWAS<a hidden class=anchor aria-hidden=true href=#4-çœŸå®æ•°æ®-gwas>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Step 1: å‡†å¤‡æ•°æ®</span>
</span></span><span class=line><span class=cl>plink --vcf ../data_real/Sample215.M5M8H3.2allel.vcf <span class=se>\
</span></span></span><span class=line><span class=cl>    --maf 0.05 <span class=se>\
</span></span></span><span class=line><span class=cl>    --geno 0.1 <span class=se>\
</span></span></span><span class=line><span class=cl>    --recode12 <span class=se>\
</span></span></span><span class=line><span class=cl>    --output-missing-genotype <span class=m>0</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    --transpose <span class=se>\
</span></span></span><span class=line><span class=cl>    --out snp_filter <span class=se>\
</span></span></span><span class=line><span class=cl>    --set-missing-var-ids @:# <span class=se>\
</span></span></span><span class=line><span class=cl>    --allow-extra-chr
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>perl ../script/sort_pheno.pl snp_filter.tfam ../data_real/trait.C16_0.table &gt; trait.sort.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 2: è®¡ç®—äº²ç¼˜å…³ç³»çŸ©é˜µ</span>
</span></span><span class=line><span class=cl>/pub/software/emmax/emmax-kin-intel64 -v -d <span class=m>10</span> -o ./pop.kinship snp_filter
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 3: è¿è¡ŒGWAS</span>
</span></span><span class=line><span class=cl>/pub/software/emmax/emmax-intel64 -v -d <span class=m>10</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    -t snp_filter <span class=se>\
</span></span></span><span class=line><span class=cl>    -p trait.sort.txt <span class=se>\
</span></span></span><span class=line><span class=cl>    -k pop.kinship <span class=se>\
</span></span></span><span class=line><span class=cl>    -o emmax.out 1&gt; emmax.log 2&gt;emmax.err
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 4: ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾</span>
</span></span><span class=line><span class=cl>paste snp_filter.map emmax.out.ps <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    awk <span class=s1>&#39;BEGIN{print &#34;SNP\tCHR\tBP\tP&#34;}{if($2==$5){print $2&#34;\t&#34;$1&#34;\t&#34;$4&#34;\t&#34;$NF}}&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    &gt; emmax.out.ps.manht_input
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Rscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure_readData
</span></span></code></pre></div><h2 id=qtl-seq-åˆ†æ>QTL-seq åˆ†æ<a hidden class=anchor aria-hidden=true href=#qtl-seq-åˆ†æ>#</a></h2><h3 id=1-vcf-è½¬æ¢ä¸º-table-æ ¼å¼>1. VCF è½¬æ¢ä¸º Table æ ¼å¼<a hidden class=anchor aria-hidden=true href=#1-vcf-è½¬æ¢ä¸º-table-æ ¼å¼>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>ref</span><span class=o>=</span>&lt;reference.fasta&gt;
</span></span><span class=line><span class=cl><span class=nv>vcf</span><span class=o>=</span>&lt;input.vcf&gt;
</span></span><span class=line><span class=cl><span class=nv>outfile</span><span class=o>=</span>&lt;output.table&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>gatk VariantsToTable <span class=se>\
</span></span></span><span class=line><span class=cl>    -R <span class=nv>$ref</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    -V <span class=nv>$vcf</span> <span class=se>\
</span></span></span><span class=line><span class=cl>    -F CHROM -F POS -F REF -F ALT <span class=se>\
</span></span></span><span class=line><span class=cl>    -GF AD -GF DP -GF GQ -GF PL <span class=se>\
</span></span></span><span class=line><span class=cl>    -O <span class=nv>$outfile</span>
</span></span></code></pre></div><h3 id=2-qtl-seq-åˆ†ær-è„šæœ¬>2. QTL-seq åˆ†æï¼ˆR è„šæœ¬ï¼‰<a hidden class=anchor aria-hidden=true href=#2-qtl-seq-åˆ†ær-è„šæœ¬>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>QTLseqr</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>ggplot2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è®¾ç½®å‚æ•°</span>
</span></span><span class=line><span class=cl><span class=n>HighBulk</span> <span class=o>&lt;-</span> <span class=s>&#34;SRR834931&#34;</span>  <span class=c1># é«˜å€¼æ··æ± åç§°</span>
</span></span><span class=line><span class=cl><span class=n>LowBulk</span> <span class=o>&lt;-</span> <span class=s>&#34;SRR834927&#34;</span>   <span class=c1># ä½å€¼æ··æ± åç§°</span>
</span></span><span class=line><span class=cl><span class=n>Chroms</span> <span class=o>&lt;-</span> <span class=nf>paste0</span><span class=p>(</span><span class=nf>rep</span><span class=p>(</span><span class=s>&#34;Chr&#34;</span><span class=p>,</span> <span class=m>12</span><span class=p>),</span> <span class=m>1</span><span class=o>:</span><span class=m>12</span><span class=p>)</span>  <span class=c1># æŸ“è‰²ä½“åˆ—è¡¨</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ==================== æ•°æ®è¯»å– ====================</span>
</span></span><span class=line><span class=cl><span class=n>df</span> <span class=o>&lt;-</span> <span class=nf>importFromGATK</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>file</span> <span class=o>=</span> <span class=s>&#34;../data/Yang_et_al_2013.table&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>highBulk</span> <span class=o>=</span> <span class=n>HighBulk</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>lowBulk</span> <span class=o>=</span> <span class=n>LowBulk</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>chromList</span> <span class=o>=</span> <span class=n>Chroms</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ==================== è´¨é‡æ£€æŸ¥å›¾ ====================</span>
</span></span><span class=line><span class=cl><span class=c1># æ·±åº¦åˆ†å¸ƒå›¾</span>
</span></span><span class=line><span class=cl><span class=n>p1</span> <span class=o>&lt;-</span> <span class=nf>ggplot</span><span class=p>(</span><span class=n>data</span> <span class=o>=</span> <span class=n>df</span><span class=p>)</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>    <span class=nf>geom_histogram</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=n>DP.HIGH</span> <span class=o>+</span> <span class=n>DP.LOW</span><span class=p>))</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>    <span class=nf>xlim</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>800</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>pdf</span><span class=p>(</span><span class=n>file</span> <span class=o>=</span> <span class=s>&#34;SNP_depth.pdf&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p1</span>
</span></span><span class=line><span class=cl><span class=nf>dev.off</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># REFç­‰ä½åŸºå› é¢‘ç‡åˆ†å¸ƒ</span>
</span></span><span class=line><span class=cl><span class=n>p2</span> <span class=o>&lt;-</span> <span class=nf>ggplot</span><span class=p>(</span><span class=n>data</span> <span class=o>=</span> <span class=n>df</span><span class=p>)</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>    <span class=nf>geom_histogram</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=n>REF_FRQ</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nf>pdf</span><span class=p>(</span><span class=n>file</span> <span class=o>=</span> <span class=s>&#34;ref_allele_frequency.pdf&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p2</span>
</span></span><span class=line><span class=cl><span class=nf>dev.off</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é«˜å€¼æ··æ± SNP-indexåˆ†å¸ƒ</span>
</span></span><span class=line><span class=cl><span class=n>p3</span> <span class=o>&lt;-</span> <span class=nf>ggplot</span><span class=p>(</span><span class=n>data</span> <span class=o>=</span> <span class=n>df</span><span class=p>)</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>    <span class=nf>geom_histogram</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=n>SNPindex.HIGH</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nf>pdf</span><span class=p>(</span><span class=n>file</span> <span class=o>=</span> <span class=s>&#34;SNPindex.HIGH.dis.pdf&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p3</span>
</span></span><span class=line><span class=cl><span class=nf>dev.off</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä½å€¼æ··æ± SNP-indexåˆ†å¸ƒ</span>
</span></span><span class=line><span class=cl><span class=n>p4</span> <span class=o>&lt;-</span> <span class=nf>ggplot</span><span class=p>(</span><span class=n>data</span> <span class=o>=</span> <span class=n>df</span><span class=p>)</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>    <span class=nf>geom_histogram</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=n>SNPindex.LOW</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nf>pdf</span><span class=p>(</span><span class=n>file</span> <span class=o>=</span> <span class=s>&#34;SNPindex.LOW.dis.pdf&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p4</span>
</span></span><span class=line><span class=cl><span class=nf>dev.off</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ==================== SNPè¿‡æ»¤ ====================</span>
</span></span><span class=line><span class=cl><span class=n>df_filt</span> <span class=o>&lt;-</span> <span class=nf>filterSNPs</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>SNPset</span> <span class=o>=</span> <span class=n>df</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>refAlleleFreq</span> <span class=o>=</span> <span class=m>0.20</span><span class=p>,</span>    <span class=c1># REFç­‰ä½åŸºå› é¢‘ç‡: 0.2~0.8</span>
</span></span><span class=line><span class=cl>    <span class=n>minTotalDepth</span> <span class=o>=</span> <span class=m>100</span><span class=p>,</span>     <span class=c1># æœ€å°æ€»æ·±åº¦</span>
</span></span><span class=line><span class=cl>    <span class=n>maxTotalDepth</span> <span class=o>=</span> <span class=m>400</span><span class=p>,</span>     <span class=c1># æœ€å¤§æ€»æ·±åº¦</span>
</span></span><span class=line><span class=cl>    <span class=n>minSampleDepth</span> <span class=o>=</span> <span class=m>40</span><span class=p>,</span>     <span class=c1># å•æ ·å“æœ€å°æ·±åº¦</span>
</span></span><span class=line><span class=cl>    <span class=n>minGQ</span> <span class=o>=</span> <span class=m>99</span><span class=p>,</span>              <span class=c1># åŸºå› å‹è´¨é‡é˜ˆå€¼</span>
</span></span><span class=line><span class=cl>    <span class=n>verbose</span> <span class=o>=</span> <span class=kc>TRUE</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ==================== deltaSNPindexè®¡ç®— ====================</span>
</span></span><span class=line><span class=cl><span class=n>df_filt</span> <span class=o>&lt;-</span> <span class=nf>runQTLseqAnalysis</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>df_filt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>windowSize</span> <span class=o>=</span> <span class=m>1e6</span><span class=p>,</span>        <span class=c1># çª—å£å¤§å°</span>
</span></span><span class=line><span class=cl>    <span class=n>popStruc</span> <span class=o>=</span> <span class=s>&#34;F2&#34;</span><span class=p>,</span>         <span class=c1># ç¾¤ä½“ç±»å‹</span>
</span></span><span class=line><span class=cl>    <span class=n>bulkSize</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>385</span><span class=p>,</span> <span class=m>430</span><span class=p>),</span>  <span class=c1># æ··æ± ä¸ªä½“æ•°</span>
</span></span><span class=line><span class=cl>    <span class=n>replications</span> <span class=o>=</span> <span class=m>10000</span><span class=p>,</span>    <span class=c1># Bootstrapæ¬¡æ•°</span>
</span></span><span class=line><span class=cl>    <span class=n>intervals</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>95</span><span class=p>,</span> <span class=m>99</span><span class=p>)</span>    <span class=c1># ç½®ä¿¡åŒºé—´</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ==================== ç»“æœå¯è§†åŒ– ====================</span>
</span></span><span class=line><span class=cl><span class=c1># SNPæ²¿æŸ“è‰²ä½“åˆ†å¸ƒ</span>
</span></span><span class=line><span class=cl><span class=n>p5</span> <span class=o>&lt;-</span> <span class=nf>plotQTLStats</span><span class=p>(</span><span class=n>SNPset</span> <span class=o>=</span> <span class=n>df_filt</span><span class=p>,</span> <span class=n>var</span> <span class=o>=</span> <span class=s>&#34;nSNPs&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>pdf</span><span class=p>(</span><span class=n>file</span> <span class=o>=</span> <span class=s>&#34;SNP_filter.window.pdf&#34;</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=m>20</span><span class=p>,</span> <span class=n>height</span> <span class=o>=</span> <span class=m>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p5</span>
</span></span><span class=line><span class=cl><span class=nf>dev.off</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># deltaSNPindexæ²¿æŸ“è‰²ä½“åˆ†å¸ƒ</span>
</span></span><span class=line><span class=cl><span class=n>p6</span> <span class=o>&lt;-</span> <span class=nf>plotQTLStats</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>SNPset</span> <span class=o>=</span> <span class=n>df_filt</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>var</span> <span class=o>=</span> <span class=s>&#34;deltaSNP&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>plotIntervals</span> <span class=o>=</span> <span class=kc>TRUE</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>pdf</span><span class=p>(</span><span class=n>file</span> <span class=o>=</span> <span class=s>&#34;deltaSNPindex.pdf&#34;</span><span class=p>,</span> <span class=n>width</span> <span class=o>=</span> <span class=m>20</span><span class=p>,</span> <span class=n>height</span> <span class=o>=</span> <span class=m>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>p6</span>
</span></span><span class=line><span class=cl><span class=nf>dev.off</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ==================== æå–æ˜¾è‘—åŒºåŸŸ ====================</span>
</span></span><span class=line><span class=cl><span class=n>QTL</span> <span class=o>&lt;-</span> <span class=nf>getSigRegions</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>SNPset</span> <span class=o>=</span> <span class=n>df_filt</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>method</span> <span class=o>=</span> <span class=s>&#34;QTLseq&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>interval</span> <span class=o>=</span> <span class=m>95</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>write.table</span><span class=p>(</span><span class=n>QTL[[1]]</span><span class=p>,</span> <span class=s>&#34;QTLseq_result.SigRegions.table&#34;</span><span class=p>,</span> <span class=n>sep</span> <span class=o>=</span> <span class=s>&#34;\t&#34;</span><span class=p>,</span> <span class=n>quote</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ==================== å¯¼å‡ºå®Œæ•´ç»“æœ ====================</span>
</span></span><span class=line><span class=cl><span class=n>results99</span> <span class=o>&lt;-</span> <span class=nf>getQTLTable</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>SNPset</span> <span class=o>=</span> <span class=n>df_filt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>method</span> <span class=o>=</span> <span class=s>&#34;QTLseq&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>interval</span> <span class=o>=</span> <span class=m>99</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>export</span> <span class=o>=</span> <span class=kc>FALSE</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>write.table</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>results99</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>file</span> <span class=o>=</span> <span class=s>&#34;QTLseq_result_deltaSNPindex_CI99.table&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>sep</span> <span class=o>=</span> <span class=s>&#34;\t&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>quote</span> <span class=o>=</span> <span class=kc>FALSE</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span></code></pre></div><h2 id=é™„å½•åˆ†ææµç¨‹å›¾>é™„å½•ï¼šåˆ†ææµç¨‹å›¾<a hidden class=anchor aria-hidden=true href=#é™„å½•åˆ†ææµç¨‹å›¾>#</a></h2><p>plaintext</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-R data-lang=R><span class=line><span class=cl>åŸå§‹æ•°æ® <span class=p>(</span><span class=n>FASTQ</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      â”‚
</span></span><span class=line><span class=cl>      â–¼
</span></span><span class=line><span class=cl>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span class=line><span class=cl>â”‚   è´¨é‡æ§åˆ¶ <span class=n>QC</span>   â”‚
</span></span><span class=line><span class=cl>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span class=line><span class=cl>      â”‚
</span></span><span class=line><span class=cl>      â–¼
</span></span><span class=line><span class=cl>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span class=line><span class=cl>â”‚  æ¯”å¯¹ <span class=n>Mapping</span>   â”‚ â”€â”€â–º <span class=n>BWA</span> <span class=n>MEM</span>
</span></span><span class=line><span class=cl>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span class=line><span class=cl>      â”‚
</span></span><span class=line><span class=cl>      â–¼
</span></span><span class=line><span class=cl>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span class=line><span class=cl>â”‚ å»é‡ <span class=n>MarkDup</span>    â”‚ â”€â”€â–º <span class=n>Picard</span>
</span></span><span class=line><span class=cl>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span class=line><span class=cl>      â”‚
</span></span><span class=line><span class=cl>      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span class=line><span class=cl>      â–¼                      â–¼                      â–¼
</span></span><span class=line><span class=cl>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span class=line><span class=cl>â”‚ <span class=n>SNP</span><span class=o>/</span><span class=n>InDel</span> â”‚          â”‚    <span class=n>SV</span>     â”‚          â”‚    <span class=n>CNV</span>    â”‚
</span></span><span class=line><span class=cl>â”‚   <span class=n>GATK</span>    â”‚          â”‚  <span class=n>lumpy</span><span class=o>-</span><span class=n>sv</span> â”‚          â”‚  <span class=n>CNVnator</span> â”‚
</span></span><span class=line><span class=cl>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span class=line><span class=cl>      â”‚                      â”‚                      â”‚
</span></span><span class=line><span class=cl>      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span class=line><span class=cl>                             â”‚
</span></span><span class=line><span class=cl>                             â–¼
</span></span><span class=line><span class=cl>                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span class=line><span class=cl>                    â”‚      æ³¨é‡Š       â”‚
</span></span><span class=line><span class=cl>                    â”‚ <span class=n>ANNOVAR</span><span class=o>/</span><span class=n>bedtools</span>â”‚
</span></span><span class=line><span class=cl>                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span><span class=line><span class=cl>                             â”‚
</span></span><span class=line><span class=cl>         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span class=line><span class=cl>         â–¼                   â–¼                   â–¼
</span></span><span class=line><span class=cl>   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span></span><span class=line><span class=cl>   â”‚ ç¾¤ä½“ç»“æ„  â”‚       â”‚ é€‰æ‹©åˆ†æ  â”‚       â”‚   <span class=n>GWAS</span>    â”‚
</span></span><span class=line><span class=cl>   â”‚ <span class=n>PCA</span><span class=o>/</span><span class=n>Tree</span>  â”‚       â”‚ <span class=n>Fst</span><span class=o>/</span>Ï€<span class=o>/</span><span class=n>D</span>   â”‚       â”‚   <span class=n>EMMAX</span>   â”‚
</span></span><span class=line><span class=cl>   â”‚ <span class=n>Structure</span> â”‚       â”‚           â”‚       â”‚           â”‚
</span></span><span class=line><span class=cl>   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://Tdxxxx-student.github.io/tags/%E7%BE%A4%E4%BD%93%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90>ç¾¤ä½“ç»“æ„åˆ†æ</a></li><li><a href=https://Tdxxxx-student.github.io/tags/%E5%8F%98%E5%BC%82%E6%A3%80%E6%B5%8B>å˜å¼‚æ£€æµ‹</a></li><li><a href=https://Tdxxxx-student.github.io/tags/%E9%87%8D%E6%B5%8B%E5%BA%8F>é‡æµ‹åº</a></li><li><a href=https://Tdxxxx-student.github.io/tags/gwas>GWAS</a></li><li><a href=https://Tdxxxx-student.github.io/tags/qtl-seq>QTL-seq</a></li></ul></footer><nav class=post-nav-full><div class=nav-info>ç¬¬ <strong>4</strong> / 4 ç¯‡
<span style=opacity:.6;font-size:.9em;margin-left:5px>(åˆ†ç±»: é‡æµ‹åºåˆ†æ)</span></div><div class=nav-buttons><a class="nav-btn first" href=https://Tdxxxx-student.github.io/posts/31%E4%B8%AA%E5%93%81%E7%A7%8D%E5%A4%A7%E8%B1%86%E9%87%8D%E6%B5%8B%E5%BA%8F%E5%88%86%E6%9E%90%E6%96%87%E7%AB%A0/ title=ç¬¬ä¸€ç¯‡>Â«</a>
<a class="nav-btn prev" href=https://Tdxxxx-student.github.io/posts/%E7%BE%A4%E4%BD%93%E9%81%97%E4%BC%A0%E5%AD%A6%E4%B8%8E%E9%87%8D%E6%B5%8B%E5%BA%8F%E5%88%86%E6%9E%90%E8%A7%A3%E9%87%8A/ title=ç¾¤ä½“é—ä¼ å­¦ä¸é‡æµ‹åºåˆ†æè§£é‡Š>â€¹</a><div class=nav-pages-group><span class=nav-dots>...</span>
<a class=nav-num href=https://Tdxxxx-student.github.io/posts/8000%E5%A4%A7%E8%B1%86%E9%87%8D%E6%B5%8B%E5%BA%8F%E6%96%87%E7%AB%A0%E5%A4%8D%E7%8E%B0/ title=8000å¤§è±†é‡æµ‹åºæ–‡ç« å¤ç°>2</a>
<a class=nav-num href=https://Tdxxxx-student.github.io/posts/%E7%BE%A4%E4%BD%93%E9%81%97%E4%BC%A0%E5%AD%A6%E4%B8%8E%E9%87%8D%E6%B5%8B%E5%BA%8F%E5%88%86%E6%9E%90%E8%A7%A3%E9%87%8A/ title=ç¾¤ä½“é—ä¼ å­¦ä¸é‡æµ‹åºåˆ†æè§£é‡Š>3</a>
<span class="nav-num current">4</span></div><span class="nav-btn next disabled">â€º</span>
<span class="nav-btn last disabled">Â»</span></div></nav></article><aside class=sidebar-right><div class=toc-card><div class=toc-title><span class=toc-icon>ğŸ“–</span> ç›®å½•</div><nav id=TableOfContents><nav id=TableOfContents><ul><li><a href=#ç›®å½•>ç›®å½•</a></li><li><a href=#è½¯ä»¶å®‰è£…>è½¯ä»¶å®‰è£…</a><ul><li><a href=#1-lumpy-sv>1. lumpy-sv</a></li><li><a href=#2-svtyper>2. svtyper</a></li><li><a href=#3-cnvnator>3. cnvnator</a></li></ul></li><li><a href=#å˜å¼‚æ£€æµ‹>å˜å¼‚æ£€æµ‹</a><ul><li><a href=#1-æ„å»ºåŸºå› ç»„-index>1. æ„å»ºåŸºå› ç»„ index</a></li><li><a href=#2-æ¯”å¯¹æ’åºå»é‡>2. æ¯”å¯¹æ’åºå»é‡</a></li><li><a href=#3-snpindel-æ£€æµ‹>3. SNPã€Indel æ£€æµ‹</a></li><li><a href=#4-sv-æ£€æµ‹>4. SV æ£€æµ‹</a></li><li><a href=#5-cnv-æ£€æµ‹>5. CNV æ£€æµ‹</a></li><li><a href=#6-snpindel-æ³¨é‡Š>6. SNP/InDel æ³¨é‡Š</a></li><li><a href=#7-cnv-å’Œ-sv-æ³¨é‡Š>7. CNV å’Œ SV æ³¨é‡Š</a></li></ul></li><li><a href=#ç¾¤ä½“ç»“æ„åˆ†æ>ç¾¤ä½“ç»“æ„åˆ†æ</a><ul><li><a href=#1-æ•°æ®è¿‡æ»¤>1. æ•°æ®è¿‡æ»¤</a></li><li><a href=#2-å»ºæ ‘åˆ†æ>2. å»ºæ ‘åˆ†æ</a></li><li><a href=#3-pca-åˆ†æ>3. PCA åˆ†æ</a></li><li><a href=#4-ç¾¤ä½“ç»“æ„åˆ†æ>4. ç¾¤ä½“ç»“æ„åˆ†æ</a></li><li><a href=#5-ld-è¡°å‡åˆ†æ>5. LD è¡°å‡åˆ†æ</a></li></ul></li><li><a href=#é€‰æ‹©åˆ†æ>é€‰æ‹©åˆ†æ</a><ul><li><a href=#1-Ï€-å’Œ-rod-åˆ†æ>1. Ï€ å’Œ ROD åˆ†æ</a></li><li><a href=#2-tajimas-d-åˆ†æ>2. Tajima&rsquo;s D åˆ†æ</a></li><li><a href=#3-fst-åˆ†æ>3. Fst åˆ†æ</a></li><li><a href=#4-rod--fst-è”åˆåˆ†æ>4. ROD + Fst è”åˆåˆ†æ</a></li></ul></li><li><a href=#gwas-åˆ†æ>GWAS åˆ†æ</a><ul><li><a href=#1-åŸºå› å‹å¡«å……>1. åŸºå› å‹å¡«å……</a></li><li><a href=#2-æ ‡å‡†-gwas-åˆ†æ>2. æ ‡å‡† GWAS åˆ†æ</a></li><li><a href=#3-gwas-q-åˆ†æåŠ å…¥ç¾¤ä½“ç»“æ„åå˜é‡>3. GWAS-Q åˆ†æï¼ˆåŠ å…¥ç¾¤ä½“ç»“æ„åå˜é‡ï¼‰</a></li><li><a href=#4-çœŸå®æ•°æ®-gwas>4. çœŸå®æ•°æ® GWAS</a></li></ul></li><li><a href=#qtl-seq-åˆ†æ>QTL-seq åˆ†æ</a><ul><li><a href=#1-vcf-è½¬æ¢ä¸º-table-æ ¼å¼>1. VCF è½¬æ¢ä¸º Table æ ¼å¼</a></li><li><a href=#2-qtl-seq-åˆ†ær-è„šæœ¬>2. QTL-seq åˆ†æï¼ˆR è„šæœ¬ï¼‰</a></li></ul></li><li><a href=#é™„å½•åˆ†ææµç¨‹å›¾>é™„å½•ï¼šåˆ†ææµç¨‹å›¾</a></li></ul></nav></nav></div></aside></div></div></main><footer class=footer><span>tdx0307</span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><a href=/search/ class=search-fab title="æœç´¢ (Ctrl+F)">ğŸ”</a><style>.search-fab{position:fixed;bottom:2rem;right:2rem;width:50px;height:50px;background:var(--primary);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.3rem;text-decoration:none;box-shadow:0 4px 15px rgba(0,0,0,.2);transition:all .3s ease;z-index:100}.search-fab:hover{transform:scale(1.1);box-shadow:0 6px 20px rgba(0,0,0,.3)}@media(max-width:768px){.search-fab{bottom:1rem;right:1rem;width:45px;height:45px}}</style><script>document.addEventListener("DOMContentLoaded",function(){if(document.getElementById("wide-post-layout")){var e=document.querySelector("main.main");e&&(e.style.maxWidth="100%",e.style.width="100%",e.style.padding="0",e.style.margin="0 auto"),document.body.classList.add("is-single-post")}})</script><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>