<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>äº‘å—å†œä¸šå¤§å­¦é‡æµ‹åºé¡¹ç›®æ•™ç¨‹ | æˆ‘çš„åšå®¢</title><meta name=keywords content><meta name=description content="äº‘å—å†œä¸šå¤§å­¦ äº‘å—ç”Ÿç‰©èµ„æºä¿æŠ¤ä¸åˆ©ç”¨å›½å®¶é‡ç‚¹å®éªŒå®¤
æè¯¦ | 2019å¹´12æœˆ31æ—¥
ç›®å½•
è½¯ä»¶å®‰è£…
å˜å¼‚æ£€æµ‹
ç¾¤ä½“ç»“æ„åˆ†æ
é€‰æ‹©åˆ†æ
GWASåˆ†æ
QTL-seqåˆ†æ
è½¯ä»¶å®‰è£…
âš ï¸ æ³¨æ„: è¯¥éƒ¨åˆ†è½¯ä»¶å¾ˆéš¾ç”¨condaç›´æ¥å®‰è£…ï¼Œå®‰è£…æ­¥éª¤æ¯”è¾ƒç‰¹æ®Šã€‚

lumpy-sv
ğŸ’¡ lumpy-sv ä¾èµ– Python2.7ï¼Œéœ€åˆ‡æ¢åˆ° py27 ç¯å¢ƒä¸‹è¿›è¡Œå®‰è£…ã€‚

Bash
conda activate py27
git clone &ndash;recursive https://github.com/arq5x/lumpy-sv.git
cd lumpy-sv
make
2. svtyper
Bash
conda install svtyper
3. cnvnator
ğŸ’¡ cnvnator ä¾èµ–äº root è½¯ä»¶åŒ…åŠ samtools è½¯ä»¶åŒ…ï¼ˆåŒ…å«HTSlibï¼‰ï¼Œå› æ­¤å…ˆå®‰è£…ä¾èµ–ã€‚
3.1 å®‰è£… samtools
Bash
wget https://github.com/samtools/samtools/releases/download/1.9/samtools-1.9.tar.bz2
tar -xvf samtools-1.9.tar.bz2
cd samtools-1.9/
./configure
make
3.2 å®‰è£… root è½¯ä»¶
Bash
ç›´æ¥ä¸‹è½½åè§£å‹å³å¯
wget https://root.cern/download/root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz
tar -zxvf root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz
3.3 å®‰è£… cnvnator
Bash"><meta name=author content><link rel=canonical href=https://Tdxxxx-student.github.io/posts/%E4%BA%91%E5%8D%97%E5%86%9C%E4%B8%9A%E5%A4%A7%E5%AD%A6%E9%87%8D%E6%B5%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE%E6%95%99%E7%A8%8B/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://Tdxxxx-student.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://Tdxxxx-student.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://Tdxxxx-student.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://Tdxxxx-student.github.io/apple-touch-icon.png><link rel=mask-icon href=https://Tdxxxx-student.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://Tdxxxx-student.github.io/posts/%E4%BA%91%E5%8D%97%E5%86%9C%E4%B8%9A%E5%A4%A7%E5%AD%A6%E9%87%8D%E6%B5%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE%E6%95%99%E7%A8%8B/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://Tdxxxx-student.github.io/posts/%E4%BA%91%E5%8D%97%E5%86%9C%E4%B8%9A%E5%A4%A7%E5%AD%A6%E9%87%8D%E6%B5%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE%E6%95%99%E7%A8%8B/"><meta property="og:site_name" content="æˆ‘çš„åšå®¢"><meta property="og:title" content="äº‘å—å†œä¸šå¤§å­¦é‡æµ‹åºé¡¹ç›®æ•™ç¨‹"><meta property="og:description" content="äº‘å—å†œä¸šå¤§å­¦ äº‘å—ç”Ÿç‰©èµ„æºä¿æŠ¤ä¸åˆ©ç”¨å›½å®¶é‡ç‚¹å®éªŒå®¤
æè¯¦ | 2019å¹´12æœˆ31æ—¥
ç›®å½• è½¯ä»¶å®‰è£… å˜å¼‚æ£€æµ‹ ç¾¤ä½“ç»“æ„åˆ†æ é€‰æ‹©åˆ†æ GWASåˆ†æ QTL-seqåˆ†æ è½¯ä»¶å®‰è£… âš ï¸ æ³¨æ„: è¯¥éƒ¨åˆ†è½¯ä»¶å¾ˆéš¾ç”¨condaç›´æ¥å®‰è£…ï¼Œå®‰è£…æ­¥éª¤æ¯”è¾ƒç‰¹æ®Šã€‚
lumpy-sv ğŸ’¡ lumpy-sv ä¾èµ– Python2.7ï¼Œéœ€åˆ‡æ¢åˆ° py27 ç¯å¢ƒä¸‹è¿›è¡Œå®‰è£…ã€‚ Bash
conda activate py27 git clone â€“recursive https://github.com/arq5x/lumpy-sv.git cd lumpy-sv make 2. svtyper Bash
conda install svtyper 3. cnvnator ğŸ’¡ cnvnator ä¾èµ–äº root è½¯ä»¶åŒ…åŠ samtools è½¯ä»¶åŒ…ï¼ˆåŒ…å«HTSlibï¼‰ï¼Œå› æ­¤å…ˆå®‰è£…ä¾èµ–ã€‚
3.1 å®‰è£… samtools Bash
wget https://github.com/samtools/samtools/releases/download/1.9/samtools-1.9.tar.bz2 tar -xvf samtools-1.9.tar.bz2 cd samtools-1.9/ ./configure make 3.2 å®‰è£… root è½¯ä»¶ Bash
ç›´æ¥ä¸‹è½½åè§£å‹å³å¯ wget https://root.cern/download/root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz tar -zxvf root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz 3.3 å®‰è£… cnvnator Bash"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-02-03T12:08:55+08:00"><meta property="article:modified_time" content="2026-02-03T12:08:55+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="äº‘å—å†œä¸šå¤§å­¦é‡æµ‹åºé¡¹ç›®æ•™ç¨‹"><meta name=twitter:description content="äº‘å—å†œä¸šå¤§å­¦ äº‘å—ç”Ÿç‰©èµ„æºä¿æŠ¤ä¸åˆ©ç”¨å›½å®¶é‡ç‚¹å®éªŒå®¤
æè¯¦ | 2019å¹´12æœˆ31æ—¥
ç›®å½•
è½¯ä»¶å®‰è£…
å˜å¼‚æ£€æµ‹
ç¾¤ä½“ç»“æ„åˆ†æ
é€‰æ‹©åˆ†æ
GWASåˆ†æ
QTL-seqåˆ†æ
è½¯ä»¶å®‰è£…
âš ï¸ æ³¨æ„: è¯¥éƒ¨åˆ†è½¯ä»¶å¾ˆéš¾ç”¨condaç›´æ¥å®‰è£…ï¼Œå®‰è£…æ­¥éª¤æ¯”è¾ƒç‰¹æ®Šã€‚

lumpy-sv
ğŸ’¡ lumpy-sv ä¾èµ– Python2.7ï¼Œéœ€åˆ‡æ¢åˆ° py27 ç¯å¢ƒä¸‹è¿›è¡Œå®‰è£…ã€‚

Bash
conda activate py27
git clone &ndash;recursive https://github.com/arq5x/lumpy-sv.git
cd lumpy-sv
make
2. svtyper
Bash
conda install svtyper
3. cnvnator
ğŸ’¡ cnvnator ä¾èµ–äº root è½¯ä»¶åŒ…åŠ samtools è½¯ä»¶åŒ…ï¼ˆåŒ…å«HTSlibï¼‰ï¼Œå› æ­¤å…ˆå®‰è£…ä¾èµ–ã€‚
3.1 å®‰è£… samtools
Bash
wget https://github.com/samtools/samtools/releases/download/1.9/samtools-1.9.tar.bz2
tar -xvf samtools-1.9.tar.bz2
cd samtools-1.9/
./configure
make
3.2 å®‰è£… root è½¯ä»¶
Bash
ç›´æ¥ä¸‹è½½åè§£å‹å³å¯
wget https://root.cern/download/root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz
tar -zxvf root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz
3.3 å®‰è£… cnvnator
Bash"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://Tdxxxx-student.github.io/posts/"},{"@type":"ListItem","position":2,"name":"äº‘å—å†œä¸šå¤§å­¦é‡æµ‹åºé¡¹ç›®æ•™ç¨‹","item":"https://Tdxxxx-student.github.io/posts/%E4%BA%91%E5%8D%97%E5%86%9C%E4%B8%9A%E5%A4%A7%E5%AD%A6%E9%87%8D%E6%B5%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE%E6%95%99%E7%A8%8B/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"äº‘å—å†œä¸šå¤§å­¦é‡æµ‹åºé¡¹ç›®æ•™ç¨‹","name":"äº‘å—å†œä¸šå¤§å­¦é‡æµ‹åºé¡¹ç›®æ•™ç¨‹","description":"äº‘å—å†œä¸šå¤§å­¦ äº‘å—ç”Ÿç‰©èµ„æºä¿æŠ¤ä¸åˆ©ç”¨å›½å®¶é‡ç‚¹å®éªŒå®¤\næè¯¦ | 2019å¹´12æœˆ31æ—¥\nç›®å½• è½¯ä»¶å®‰è£… å˜å¼‚æ£€æµ‹ ç¾¤ä½“ç»“æ„åˆ†æ é€‰æ‹©åˆ†æ GWASåˆ†æ QTL-seqåˆ†æ è½¯ä»¶å®‰è£… âš ï¸ æ³¨æ„: è¯¥éƒ¨åˆ†è½¯ä»¶å¾ˆéš¾ç”¨condaç›´æ¥å®‰è£…ï¼Œå®‰è£…æ­¥éª¤æ¯”è¾ƒç‰¹æ®Šã€‚\nlumpy-sv ğŸ’¡ lumpy-sv ä¾èµ– Python2.7ï¼Œéœ€åˆ‡æ¢åˆ° py27 ç¯å¢ƒä¸‹è¿›è¡Œå®‰è£…ã€‚ Bash\nconda activate py27 git clone \u0026ndash;recursive https://github.com/arq5x/lumpy-sv.git cd lumpy-sv make 2. svtyper Bash\nconda install svtyper 3. cnvnator ğŸ’¡ cnvnator ä¾èµ–äº root è½¯ä»¶åŒ…åŠ samtools è½¯ä»¶åŒ…ï¼ˆåŒ…å«HTSlibï¼‰ï¼Œå› æ­¤å…ˆå®‰è£…ä¾èµ–ã€‚\n3.1 å®‰è£… samtools Bash\nwget https://github.com/samtools/samtools/releases/download/1.9/samtools-1.9.tar.bz2 tar -xvf samtools-1.9.tar.bz2 cd samtools-1.9/ ./configure make 3.2 å®‰è£… root è½¯ä»¶ Bash\nç›´æ¥ä¸‹è½½åè§£å‹å³å¯ wget https://root.cern/download/root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz tar -zxvf root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz 3.3 å®‰è£… cnvnator Bash\n","keywords":[],"articleBody":"äº‘å—å†œä¸šå¤§å­¦ äº‘å—ç”Ÿç‰©èµ„æºä¿æŠ¤ä¸åˆ©ç”¨å›½å®¶é‡ç‚¹å®éªŒå®¤\næè¯¦ | 2019å¹´12æœˆ31æ—¥\nç›®å½• è½¯ä»¶å®‰è£… å˜å¼‚æ£€æµ‹ ç¾¤ä½“ç»“æ„åˆ†æ é€‰æ‹©åˆ†æ GWASåˆ†æ QTL-seqåˆ†æ è½¯ä»¶å®‰è£… âš ï¸ æ³¨æ„: è¯¥éƒ¨åˆ†è½¯ä»¶å¾ˆéš¾ç”¨condaç›´æ¥å®‰è£…ï¼Œå®‰è£…æ­¥éª¤æ¯”è¾ƒç‰¹æ®Šã€‚\nlumpy-sv ğŸ’¡ lumpy-sv ä¾èµ– Python2.7ï¼Œéœ€åˆ‡æ¢åˆ° py27 ç¯å¢ƒä¸‹è¿›è¡Œå®‰è£…ã€‚ Bash\nconda activate py27 git clone â€“recursive https://github.com/arq5x/lumpy-sv.git cd lumpy-sv make 2. svtyper Bash\nconda install svtyper 3. cnvnator ğŸ’¡ cnvnator ä¾èµ–äº root è½¯ä»¶åŒ…åŠ samtools è½¯ä»¶åŒ…ï¼ˆåŒ…å«HTSlibï¼‰ï¼Œå› æ­¤å…ˆå®‰è£…ä¾èµ–ã€‚\n3.1 å®‰è£… samtools Bash\nwget https://github.com/samtools/samtools/releases/download/1.9/samtools-1.9.tar.bz2 tar -xvf samtools-1.9.tar.bz2 cd samtools-1.9/ ./configure make 3.2 å®‰è£… root è½¯ä»¶ Bash\nç›´æ¥ä¸‹è½½åè§£å‹å³å¯ wget https://root.cern/download/root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz tar -zxvf root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz 3.3 å®‰è£… cnvnator Bash\ngit clone https://github.com/abyzovlab/CNVnator.git cd CNVnator\né“¾æ¥samtoolsè½¯ä»¶ç›®å½•åˆ°cnvnatorç›®å½• ln -s ../samtools-1.9 ./samtools\nåŠ è½½rootè½¯ä»¶åˆ°ç¯å¢ƒå˜é‡ export ROOTSYS=/pub/software/root export PATH=/pub/software/root/bin:$PATH export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$ROOTSYS/lib\nå®‰è£…cnvnator make LIBS=\"-lcrypto\" å˜å¼‚æ£€æµ‹\næ„å»ºåŸºå› ç»„ index Bash åˆ›å»ºè½¯é“¾æ¥ ln -s ../data/genome.fasta ./genome.fasta\nfor gatk samtools faidx genome.fasta\nfor bwa bwa index genome.fasta\nfor picard picard CreateSequenceDictionary R=genome.fasta 2. æ¯”å¯¹æ’åºå»é‡ 2.1 æ¯”å¯¹æ’åº\nbwa mem -t 2 -R '@RG\\tID:S1\\tSM:S1\\tPL:illumina' \\ ../01.ref/genome.fasta \\ ../data/S1_1.fq.gz ../data/S1_2.fq.gz | \\ /pub/software/samtools/samtools sort -@ 2 -m 1G -o S1.sort.bam - bwa mem -t 2 -R '@RG\\tID:S2\\tSM:S2\\tPL:illumina' \\ ../01.ref/genome.fasta \\ ../data/S2_1.fq.gz ../data/S2_2.fq.gz | \\ /pub/software/samtools/samtools sort -@ 2 -m 1G -o S2.sort.bam - 2.2 å»é™¤é‡å¤ Bash\npicard -Xmx4g MarkDuplicates I=S1.sort.bam O=S1.sort.rmdup.bam CREATE_INDEX=true REMOVE_DUPLICATES=true M=S1.marked_dup_metrics.txt\npicard -Xmx4g MarkDuplicates I=S2.sort.bam O=S2.sort.rmdup.bam CREATE_INDEX=true REMOVE_DUPLICATES=true M=S2.marked_dup_metrics.txt 2.3 æ¯”å¯¹ç‡ç»Ÿè®¡ Bash\n/pub/software/samtools/samtools flagstat S1.sort.bam \u003e S1.sort.bam.flagstat /pub/software/samtools/samtools flagstat S2.sort.bam \u003e S2.sort.bam.flagstat 2.4 æ‰¹é‡æ¯”å¯¹è„šæœ¬ç”Ÿæˆ Bash\nless ../data/sample.list | awk â€˜{ print â€œbwa mem -t 2 -R â€˜'â€™@RG\\tID:\"$1â€\\tSM:\"$1\"\\tPL:illuminaâ€™'â€™ ../01.ref/genome.fasta ../data/\"$1\"_1.fq.gz ../data/\"$1\"_2.fq.gz | /pub/software/samtools/samtools sort -@ 2 -m 1G -o â€œ$1â€.sort.bam -\" }â€™ 3. SNPã€Indel æ£€æµ‹ 3.1 HaplotypeCaller Bash\ngatk â€“java-options â€œ-Xmx10g -Djava.io.tmpdir=./tmpâ€ HaplotypeCaller -R ../01.ref/genome.fasta -I ../02.mapping/S1.sort.rmdup.bam -ERC GVCF -O S1.g.vcf 1\u003eS1.HC.log 2\u003e\u00261\ngatk â€“java-options â€œ-Xmx10g -Djava.io.tmpdir=./tmpâ€ HaplotypeCaller -R ../01.ref/genome.fasta -I ../02.mapping/S2.sort.rmdup.bam -ERC GVCF -O S2.g.vcf 1\u003eS2.HC.log 2\u003e\u00261 3.2 CombineGVCFs Bash\nls ./S*.g.vcf \u003e gvcf.list\ngatk â€“java-options â€œ-Xmx4g -Djava.io.tmpdir=./tmpâ€ CombineGVCFs -R ../01.ref/genome.fasta -V gvcf.list -O all.merge.g.vcf 3.3 GenotypeGVCFs Bash\ngatk â€“java-options â€œ-Xmx4g -Djava.io.tmpdir=./tmpâ€ GenotypeGVCFs -R ../01.ref/genome.fasta â€“variant all.merge.g.vcf -O all.merge_raw.vcf 3.4 SNP è¿‡æ»¤ Bash\næå–SNP gatk â€“java-options â€œ-Xmx4g -Djava.io.tmpdir=./tmpâ€ SelectVariants -R ../01.ref/genome.fasta -V all.merge_raw.vcf â€“select-type SNP -O all.raw.snp.vcf\næ ‡è®°è¿‡æ»¤ gatk â€“java-options â€œ-Xmx4g -Djava.io.tmpdir=./tmpâ€ VariantFiltration -R ../01.ref/genome.fasta -V all.raw.snp.vcf â€“filter-expression â€œQD \u003c 2.0 || MQ \u003c 40.0 || FS \u003e 60.0 || SOR \u003e 3.0 || MQRankSum \u003c -12.5 || ReadPosRankSum \u003c -8.0â€ â€“filter-name â€˜SNP_filterâ€™ -O all.filter.snp.vcf\næå–è¿‡æ»¤åçš„SNP gatk â€“java-options â€œ-Xmx4g -Djava.io.tmpdir=./tmpâ€ SelectVariants -R ../01.ref/genome.fasta -V all.filter.snp.vcf â€“exclude-filtered -O all.filtered.snp.vcf 3.5 InDel è¿‡æ»¤ Bash\næå–InDel gatk â€“java-options â€œ-Xmx4g -Djava.io.tmpdir=./tmpâ€ SelectVariants -R ../01.ref/genome.fasta -V all.merge_raw.vcf â€“select-type INDEL -O all.raw.indel.vcf\næ ‡è®°è¿‡æ»¤ gatk â€“java-options â€œ-Xmx4g -Djava.io.tmpdir=./tmpâ€ VariantFiltration -R ../01.ref/genome.fasta -V all.raw.indel.vcf â€“filter-expression â€œQD \u003c 2.0 || FS \u003e 200.0 || SOR \u003e 10.0 || MQRankSum \u003c -12.5 || ReadPosRankSum \u003c -8.0â€ â€“filter-name â€˜INDEL_filterâ€™ -O all.filter.indel.vcf\næå–è¿‡æ»¤åçš„InDel gatk â€“java-options â€œ-Xmx4g -Djava.io.tmpdir=./tmpâ€ SelectVariants -R ../01.ref/genome.fasta -V all.filter.indel.vcf â€“exclude-filtered -O all.filtered.indel.vcf 4. SV æ£€æµ‹ Bash\nStep 1: æå– discordants reads /pub/software/samtools/samtools view -b -F 1294 -@ 12 ../02.mapping/S1.sort.rmdup.bam \u003e S1.discordants.bam /pub/software/samtools/samtools view -b -F 1294 -@ 12 ../02.mapping/S2.sort.rmdup.bam \u003e S2.discordants.bam\nStep 2: æå– split reads /pub/software/samtools/samtools view -h ../02.mapping/S1.sort.rmdup.bam | /pub/software/lumpy-sv/scripts/extractSplitReads_BwaMem -i stdin | /pub/software/samtools/samtools sort - \u003e S1.splitters.bam\n/pub/software/samtools/samtools view -h ../02.mapping/S2.sort.rmdup.bam | /pub/software/lumpy-sv/scripts/extractSplitReads_BwaMem -i stdin | /pub/software/samtools/samtools sort - \u003e S2.splitters.bam\nStep 3: è¿è¡Œ lumpy /pub/software/lumpy-sv/bin/lumpyexpress -B ../02.mapping/S1.sort.rmdup.bam,../02.mapping/S2.sort.rmdup.bam -S S1.splitters.bam,S2.splitters.bam -D S1.discordants.bam,S2.discordants.bam -o all.sv.lumpy.vcf\nStep 4: ä¸ªä½“åŸºå› å‹åˆ†å‹ vcftools â€“vcf all.sv.lumpy.vcf â€“indv S1 â€“recode â€“recode-INFO-all â€“out S1 \u0026\u0026 svtyper -i S1.recode.vcf -B ../02.mapping/S1.sort.rmdup.bam -o S1.genotype.vcf\nvcftools â€“vcf all.sv.lumpy.vcf â€“indv S2 â€“recode â€“recode-INFO-all â€“out S2 \u0026\u0026 svtyper -i S2.recode.vcf -B ../02.mapping/S2.sort.rmdup.bam -o S2.genotype.vcf 5. CNV æ£€æµ‹ 5.1 å‡†å¤‡åŸºå› ç»„ Bash\nå°†åŸºå› ç»„æ‹†åˆ†ä¸ºå•æ¡æŸ“è‰²ä½“ ln -s ../data/genome.fasta ./genome.fa seqkit split -i ./genome.fa -O split\né‡å‘½åæ–‡ä»¶ ls ./split/genome.id_*.fa | sed â€™s/./split/genome.id_//â€™ | awk â€˜{print â€œmv ./split/genome.id_\"$aaâ€ ./split/\"$aa}â€™ \u003e mv_name.sh sh mv_name.sh 5.2 è¿è¡Œ cnvnator Bash\nè®¾ç½®ç¯å¢ƒå˜é‡ export ROOTSYS=/pub/software/root export PATH=/pub/software/root/bin:$PATH export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$ROOTSYS/lib\né“¾æ¥æ–‡ä»¶ ln -s ../02.mapping/S1.sort.rmdup.bam\næå–æ¯”å¯¹ç»“æœ /pub/software/CNVnator/cnvnator -genome genome.fa -root S1.root -tree S1.sort.rmdup.bam\nç”Ÿæˆæ·±åº¦åˆ†å¸ƒ /pub/software/CNVnator/cnvnator -genome genome.fa -root S1.root -his 500 -d split\nè¿›è¡Œç»Ÿè®¡è®¡ç®— /pub/software/CNVnator/cnvnator -root S1.root -stat 500\næ£€æŸ¥bin sizeæ˜¯å¦åˆé€‚ /pub/software/CNVnator/cnvnator -root S1.root -eval 500 \u003e S1.eval.ratio\nRDä¿¡å·åˆ†å‰² /pub/software/CNVnator/cnvnator -root S1.root -partition 500\nè¿›è¡ŒCNVæ£€æµ‹ /pub/software/CNVnator/cnvnator -root S1.root -call 500 \u003e S1.cnv 6. SNP/InDel æ³¨é‡Š 6.1 å‡†å¤‡æ³¨é‡Šæ•°æ®åº“ Bash\nln -s ../data/genome.gtf ln -s ../data/genome.fasta\ngtfToGenePred -genePredExt genome.gtf genome_refGene.txt\n/pub/software/annovar/retrieve_seq_from_fasta.pl â€“format refGene â€“seqfile genome.fasta genome_refGene.txt â€“out genome_refGeneMrna.fa 6.2 æ³¨é‡Š VCF æ–‡ä»¶ Bash\nln -s ../03.SNP_indel/all.filtered.snp.vcf\næ ¼å¼è½¬æ¢ /pub/software/annovar/convert2annovar.pl -format vcf4old all.filtered.snp.vcf \u003e all.snp.vcf.annovar.input\nè¿›è¡Œæ³¨é‡Š /pub/software/annovar/annotate_variation.pl -geneanno â€“neargene 2000 -buildver genome -dbtype refGene -outfile all.anno -exonsort all.snp.vcf.annovar.input ./ 7. CNV å’Œ SV æ³¨é‡Š Bash\nå¤„ç†SVæ–‡ä»¶ less -S ../04.SV/all.sv.lumpy.vcf | awk -F â€œ;â€ â€˜{ if($1!~/#/){print $1\"\\t\"$2\"\\t\"$3\"\\t\"$4} }â€™ | awk â€˜{print $1\"\\t\"$2\"\\t\"$11\"\\t\"$3\"\\t\"$8}â€™ | sed â€™s/END=//â€™ | sed â€™s/SVTYPE=//â€™ \u003e SV.bed\nè¿‡æ»¤BNDç±»å‹ awk â€˜$5 !~ /BND/â€™ SV.bed \u003e SV_filter.bed\nSVæ³¨é‡Š bedtools intersect -wo -a SV_filter.bed -b gene.gtf \u003e SV_filter.Anno\nå¤„ç†CNVæ–‡ä»¶ less -S ../05.CNV/S1.cnv | awk â€˜{print $2 â€œ\\tâ€ $1}â€™ | sed â€™s/:/\\t/â€™ | sed â€™s/-/\\t/â€™ \u003e CNV.bed\nCNVæ³¨é‡Š bedtools intersect -wo -a CNV.bed -b gene.gtf \u003e CNV.Anno ç¾¤ä½“ç»“æ„åˆ†æ\næ•°æ®è¿‡æ»¤ Bash vcf=../data/all.vcf\nè¿‡æ»¤ç¼ºå¤±ç‡å’Œæœ€å°ç­‰ä½åŸºå› é¢‘ç‡ plink â€“vcf $vcf â€“geno 0.1 â€“maf 0.01 â€“out all.missing_maf â€“recode vcf-iid â€“allow-extra-chr â€“set-missing-var-ids @:# â€“keep-allele-order\nè¿‡æ»¤è¿é”ä¸å¹³è¡¡ plink â€“vcf all.missing_maf.vcf â€“indep-pairwise 50 10 0.2 â€“out tmp.ld â€“allow-extra-chr â€“set-missing-var-ids @:#\nplink â€“vcf all.missing_maf.vcf â€“make-bed â€“extract tmp.ld.prune.in â€“out all.LDfilter â€“recode vcf-iid â€“keep-allele-order â€“allow-extra-chr â€“set-missing-var-ids @:# 2. å»ºæ ‘åˆ†æ 2.1 NJ æ ‘ Bash\næ ¼å¼è½¬æ¢ perl ../../script/vcf2phy.pl ../../00.filter/all.LDfilter.vcf \u003e sequences.dat\nè®¡ç®—é—ä¼ è·ç¦» echo -e â€œsequences.dat\\nYâ€ \u003e dnadist.cfg dnadist \u003c dnadist.cfg \u003e dnadist.log mv outfile infile.dist\næ„å»ºNJæ ‘ echo -e â€œinfile.dist\\nYâ€ \u003e neighbor.cfg neighbor \u003c neighbor.cfg \u003e nj.log\næ ¼å¼æ•´ç† less infile.dist | tr â€˜\\nâ€™ â€˜|â€™ | sed â€™s/| / /gâ€™ | tr â€˜|â€™ â€˜\\nâ€™ \u003e infile.dist.table less outtree | tr â€˜\\nâ€™ â€™ â€™ | sed â€™s/ //gâ€™ \u003e outtree.nwk 2.2 SNPhylo å»ºæ ‘ Bash\n/pub/software/SNPhylo/snphylo.sh -v ../../00.filter/all.LDfilter.vcf -r -l 1 -m 0.01 -o GA0001 -b -B 2 -P tree_snphylo 3. PCA åˆ†æ Bash\nplink â€“vcf ../00.filter/all.LDfilter.vcf â€“pca 10 â€“out PCA_out â€“allow-extra-chr â€“set-missing-var-ids @:#\nRscript ../script/draw_PCA.R PCA_out.eigenvec 1 2 ../data/sample.pop PCA_out_figure 4. ç¾¤ä½“ç»“æ„åˆ†æ Bash\nStep 0: vcfè½¬bedæ ¼å¼ plink â€“vcf ../00.filter/all.LDfilter.vcf â€“make-bed â€“out all â€“allow-extra-chr â€“keep-allele-order â€“set-missing-var-ids @:#\nStep 1: ç”ŸæˆAdmixtureè¿è¡Œè„šæœ¬ seq 2 4 | awk â€˜{print â€œadmixture â€“cv -j2 all.bed â€œ$1â€ 1\u003eadmix.\"$1â€.log 2\u003e\u00261\"}â€™ \u003e admixture.sh\nStep 2: è¿è¡ŒAdmixture sh admixture.sh\nä¹Ÿå¯å•ç‹¬è¿è¡Œ admixture â€“cv -j2 all.bed 2 1\u003eadmix.2.log 2\u003e\u00261 admixture â€“cv -j2 all.bed 3 1\u003eadmix.3.log 2\u003e\u00261 admixture â€“cv -j2 all.bed 4 1\u003eadmix.4.log 2\u003e\u00261\nStep 3: ç»˜åˆ¶ç»“æ„å›¾ mkdir result cp ./*.Q result/ Rscript ../script/draw_admixture.R result all.nosex structure 5. LD è¡°å‡åˆ†æ Bash\nStep 1: è®¡ç®—LD /pub/software/PopLDdecay/bin/PopLDdecay -InVCF ../data/all.vcf -SubPop ../data/pop.SC.table -MaxDist 500 -OutStat pop.SC.stat\n/pub/software/PopLDdecay/bin/PopLDdecay -InVCF ../data/all.vcf -SubPop ../data/pop.YZR.table -MaxDist 500 -OutStat pop.YZR.stat\nStep 2: ç»˜åˆ¶å•ç¾¤ä½“LDè¡°å‡å›¾ perl /pub/software/PopLDdecay/bin/Plot_OnePop.pl -inFile pop.SC.stat.gz -output pop.SC.ld\nperl /pub/software/PopLDdecay/bin/Plot_OnePop.pl -inFile pop.YZR.stat.gz -output pop.YZR.ld\nStep 3: ç»˜åˆ¶å¤šç¾¤ä½“LDè¡°å‡å›¾ perl /pub/software/PopLDdecay/bin/Plot_MultiPop.pl -inList ld_stat.list -output ld_stat.multi é€‰æ‹©åˆ†æ\nÏ€ å’Œ ROD åˆ†æ Bash vcf=../../data/all.vcf window=20000 step=2000\nStep 1: è®¡ç®—piå€¼ vcftools â€“vcf $vcf â€“window-pi $window â€“window-pi-step $step â€“keep ../../data/pop.SC.table â€“out ./Pi.pop1\nvcftools â€“vcf $vcf â€“window-pi $window â€“window-pi-step $step â€“keep ../../data/pop.YZR.table â€“out ./Pi.pop2\nStep 2: è®¡ç®—ROD pi1=Pi.pop1.windowed.pi pi2=Pi.pop2.windowed.pi perl ../../script/merge2pi_ROD.pl $pi1 $pi2 \u003e Pi.ROD 2. Tajimaâ€™s D åˆ†æ Bash\nvcf=../../data/all.vcf window=20000\nvcftools â€“vcf $vcf â€“TajimaD $window â€“keep ../../data/pop.SC.table â€“out TajimaD.pop1\nvcftools â€“vcf $vcf â€“TajimaD $window â€“keep ../../data/pop.YZR.table â€“out TajimaD.pop2 3. Fst åˆ†æ Bash\nvcf=../../data/all.vcf window=20000 step=2000\nvcftools â€“vcf $vcf â€“fst-window-size $window â€“fst-window-step $step â€“weir-fst-pop ../../data/pop.SC.table â€“weir-fst-pop ../../data/pop.YZR.table â€“out ./Fst.pop1.pop2 4. ROD + Fst è”åˆåˆ†æ Bash\nfst=../03.Fst/Fst.pop1.pop2.windowed.weir.fst ROD=../01.pi_ROD/Pi.ROD gff=../../data/genome.gff\næå–æ˜¾è‘—ä½ç‚¹ perl ../../script/top_Fst_ROD_S.pl $fst $ROD 0.05 0.05 Fst_ROD.table Fst_ROD.stat\nç­›é€‰topä½ç‚¹ awk â€˜$NF==â€œtopâ€â€™ Fst_ROD.table \u003e Fst_ROD.table.top\næå–åŸºå› æ³¨é‡Š awk â€˜$3==â€œgeneâ€â€™ $gff \u003e gene.gff\næ³¨é‡Šå€™é€‰åŸºå›  bedtools intersect -wo -F 0.1 -a Fst_ROD.table.top -b gene.gff | awk -F â€œ\\tâ€ â€˜{print $7\"\\t\"$10\"\\t\"$11\"\\t\"$13\"\\t\"$15}â€™ | sort -u \u003e Fst_ROD.table.top.gene GWASåˆ†æ\nåŸºå› å‹å¡«å…… Bash beagle -Xmx4g -Djava.io.tmpdir=./TMP gt=../data/all.vcf out=all.impute impute=true window=10 nthreads=2 2. æ ‡å‡† GWAS åˆ†æ Bash\nStep 1: å‡†å¤‡VCFæ•°æ® plink â€“vcf ../data/all.vcf â€“maf 0.05 â€“geno 0.1 â€“recode12 â€“output-missing-genotype 0 â€“transpose â€“out snp_filter â€“set-missing-var-ids @:# â€“allow-extra-chr\nå‡†å¤‡è¡¨å‹æ•°æ® perl ../script/sort_pheno.pl snp_filter.tfam ../data/trait.table \u003e trait.sort.txt\nStep 2: è®¡ç®—äº²ç¼˜å…³ç³»çŸ©é˜µ /pub/software/emmax/emmax-kin-intel64 -v -d 10 -o ./pop.kinship snp_filter\nStep 3: è¿è¡ŒGWAS /pub/software/emmax/emmax-intel64 -v -d 10 -t snp_filter -p trait.sort.txt -k pop.kinship -o emmax.out 1\u003e emmax.log 2\u003eemmax.err\nStep 4: ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾ paste snp_filter.map emmax.out.ps | awk â€˜BEGIN{print â€œSNP\\tCHR\\tBP\\tPâ€}{if($2==$5){print $2\"\\t\"$1\"\\t\"$4\"\\t\"$NF}}â€™ \u003e emmax.out.ps.manht_input\nRscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure 3. GWAS-Q åˆ†æï¼ˆåŠ å…¥ç¾¤ä½“ç»“æ„åå˜é‡ï¼‰ Bash\né“¾æ¥æ–‡ä»¶ ln -s ../01.GWAS/snp_filter.tped ln -s ../01.GWAS/snp_filter.tfam ln -s ../01.GWAS/snp_filter.nosex ln -s ../01.GWAS/snp_filter.map ln -s ../01.GWAS/trait.sort.txt ln -s ../../02.population_genetics/03.structure/all.3.Q\nå‡†å¤‡QçŸ©é˜µ paste snp_filter.nosex all.3.Q | awk â€˜{print $1\" â€œ$1â€ 1 â€œ$3â€ â€œ$4}â€™ \u003e pop.Qmatrix\nè¿è¡ŒGWAS /pub/software/emmax/emmax-intel64 -v -d 10 -t snp_filter -p trait.sort.txt -k pop.kinship -c pop.Qmatrix -o emmax.out 1\u003e emmax.log 2\u003eemmax.err\nç»˜åˆ¶æ›¼å“ˆé¡¿å›¾ paste snp_filter.map emmax.out.ps | awk â€˜BEGIN{print â€œSNP\\tCHR\\tBP\\tPâ€}{if($2==$5){print $2â€\\t\"$1\"\\t\"$4\"\\t\"$NF}}â€™ \u003e emmax.out.ps.manht_input\nRscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure_Q 4. çœŸå®æ•°æ® GWAS Bash\nStep 1: å‡†å¤‡æ•°æ® plink â€“vcf ../data_real/Sample215.M5M8H3.2allel.vcf â€“maf 0.05 â€“geno 0.1 â€“recode12 â€“output-missing-genotype 0 â€“transpose â€“out snp_filter â€“set-missing-var-ids @:# â€“allow-extra-chr\nperl ../script/sort_pheno.pl snp_filter.tfam ../data_real/trait.C16_0.table \u003e trait.sort.txt\nStep 2: è®¡ç®—äº²ç¼˜å…³ç³»çŸ©é˜µ /pub/software/emmax/emmax-kin-intel64 -v -d 10 -o ./pop.kinship snp_filter\nStep 3: è¿è¡ŒGWAS /pub/software/emmax/emmax-intel64 -v -d 10 -t snp_filter -p trait.sort.txt -k pop.kinship -o emmax.out 1\u003e emmax.log 2\u003eemmax.err\nStep 4: ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾ paste snp_filter.map emmax.out.ps | awk â€˜BEGIN{print â€œSNP\\tCHR\\tBP\\tPâ€}{if($2==$5){print $2\"\\t\"$1\"\\t\"$4\"\\t\"$NF}}â€™ \u003e emmax.out.ps.manht_input\nRscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure_readData QTL-seqåˆ†æ\nVCF è½¬æ¢ä¸º Table æ ¼å¼ Bash ref= vcf= outfile=\ngatk VariantsToTable -R $ref -V $vcf -F CHROM -F POS -F REF -F ALT -GF AD -GF DP -GF GQ -GF PL -O $outfile 2. QTL-seq åˆ†æï¼ˆRè„šæœ¬ï¼‰ R\nlibrary(QTLseqr) library(ggplot2)\nè®¾ç½®å‚æ•° HighBulk \u003c- â€œSRR834931â€ # é«˜å€¼æ··æ± åç§° LowBulk \u003c- â€œSRR834927â€ # ä½å€¼æ··æ± åç§° Chroms \u003c- paste0(rep(â€œChrâ€, 12), 1:12) # æŸ“è‰²ä½“åˆ—è¡¨\n==================== æ•°æ®è¯»å– ==================== df \u003c- importFromGATK( file = â€œ../data/Yang_et_al_2013.tableâ€, highBulk = HighBulk, lowBulk = LowBulk, chromList = Chroms )\n==================== è´¨é‡æ£€æŸ¥å›¾ ==================== æ·±åº¦åˆ†å¸ƒå›¾ p1 \u003c- ggplot(data = df) + geom_histogram(aes(x = DP.HIGH + DP.LOW)) + xlim(0, 800) pdf(file = â€œSNP_depth.pdfâ€) p1 dev.off()\nREFç­‰ä½åŸºå› é¢‘ç‡åˆ†å¸ƒ p2 \u003c- ggplot(data = df) + geom_histogram(aes(x = REF_FRQ)) pdf(file = â€œref_allele_frequency.pdfâ€) p2 dev.off()\né«˜å€¼æ··æ± SNP-indexåˆ†å¸ƒ p3 \u003c- ggplot(data = df) + geom_histogram(aes(x = SNPindex.HIGH)) pdf(file = â€œSNPindex.HIGH.dis.pdfâ€) p3 dev.off()\nä½å€¼æ··æ± SNP-indexåˆ†å¸ƒ p4 \u003c- ggplot(data = df) + geom_histogram(aes(x = SNPindex.LOW)) pdf(file = â€œSNPindex.LOW.dis.pdfâ€) p4 dev.off()\n==================== SNPè¿‡æ»¤ ==================== df_filt \u003c- filterSNPs( SNPset = df, refAlleleFreq = 0.20, # REFç­‰ä½åŸºå› é¢‘ç‡: 0.2~0.8 minTotalDepth = 100, # æœ€å°æ€»æ·±åº¦ maxTotalDepth = 400, # æœ€å¤§æ€»æ·±åº¦ minSampleDepth = 40, # å•æ ·å“æœ€å°æ·±åº¦ minGQ = 99, # åŸºå› å‹è´¨é‡é˜ˆå€¼ verbose = TRUE )\n==================== deltaSNPindexè®¡ç®— ==================== df_filt \u003c- runQTLseqAnalysis( df_filt, windowSize = 1e6, # çª—å£å¤§å° popStruc = â€œF2â€, # ç¾¤ä½“ç±»å‹ bulkSize = c(385, 430), # æ··æ± ä¸ªä½“æ•° replications = 10000, # Bootstrapæ¬¡æ•° intervals = c(95, 99) # ç½®ä¿¡åŒºé—´ )\n==================== ç»“æœå¯è§†åŒ– ==================== SNPæ²¿æŸ“è‰²ä½“åˆ†å¸ƒ p5 \u003c- plotQTLStats(SNPset = df_filt, var = â€œnSNPsâ€) pdf(file = â€œSNP_filter.window.pdfâ€, width = 20, height = 4) p5 dev.off()\ndeltaSNPindexæ²¿æŸ“è‰²ä½“åˆ†å¸ƒ p6 \u003c- plotQTLStats( SNPset = df_filt, var = â€œdeltaSNPâ€, plotIntervals = TRUE ) pdf(file = â€œdeltaSNPindex.pdfâ€, width = 20, height = 4) p6 dev.off()\n==================== æå–æ˜¾è‘—åŒºåŸŸ ==================== QTL \u003c- getSigRegions( SNPset = df_filt, method = â€œQTLseqâ€, interval = 95 ) write.table(QTL[[1]], â€œQTLseq_result.SigRegions.tableâ€, sep = â€œ\\tâ€, quote = FALSE)\n==================== å¯¼å‡ºå®Œæ•´ç»“æœ ==================== results99 \u003c- getQTLTable( SNPset = df_filt, method = â€œQTLseqâ€, interval = 99, export = FALSE ) write.table( results99, file = â€œQTLseq_result_deltaSNPindex_CI99.tableâ€, sep = â€œ\\tâ€, quote = FALSE ) é™„å½•ï¼šåˆ†ææµç¨‹å›¾ text\nåŸå§‹æ•°æ® (FASTQ) â”‚ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ è´¨é‡æ§åˆ¶ QC â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ æ¯”å¯¹ Mapping â”‚ â”€â”€â–º BWA MEM â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ å»é‡ MarkDup â”‚ â”€â”€â–º Picard â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â–¼ â–¼ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ SNP/InDel â”‚ â”‚ SV â”‚ â”‚ CNV â”‚ â”‚ GATK â”‚ â”‚ lumpy-sv â”‚ â”‚ CNVnator â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ æ³¨é‡Š â”‚ â”‚ ANNOVAR/bedtoolsâ”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â–¼ â–¼ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ ç¾¤ä½“ç»“æ„ â”‚ â”‚ é€‰æ‹©åˆ†æ â”‚ â”‚ GWAS â”‚ â”‚ PCA/Tree â”‚ â”‚ Fst/Ï€/D â”‚ â”‚ EMMAX â”‚ â”‚ Structure â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n","wordCount":"1850","inLanguage":"en","datePublished":"2026-02-03T12:08:55+08:00","dateModified":"2026-02-03T12:08:55+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://Tdxxxx-student.github.io/posts/%E4%BA%91%E5%8D%97%E5%86%9C%E4%B8%9A%E5%A4%A7%E5%AD%A6%E9%87%8D%E6%B5%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE%E6%95%99%E7%A8%8B/"},"publisher":{"@type":"Organization","name":"æˆ‘çš„åšå®¢","logo":{"@type":"ImageObject","url":"https://Tdxxxx-student.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://Tdxxxx-student.github.io/ accesskey=h title="æˆ‘çš„åšå®¢ (Alt + H)">æˆ‘çš„åšå®¢</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://Tdxxxx-student.github.io/posts title=ä¸ªäºº><span>ä¸ªäºº</span></a></li><li><a href=https://Tdxxxx-student.github.io/docs title=æ•™ç¨‹><span>æ•™ç¨‹</span></a></li><li><a href=https://Tdxxxx-student.github.io/study title=å­¦ä¹ ><span>å­¦ä¹ </span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">äº‘å—å†œä¸šå¤§å­¦é‡æµ‹åºé¡¹ç›®æ•™ç¨‹</h1><div class=post-meta><span title='2026-02-03 12:08:55 +0800 +0800'>February 3, 2026</span></div></header><div class=post-content><p>äº‘å—å†œä¸šå¤§å­¦ äº‘å—ç”Ÿç‰©èµ„æºä¿æŠ¤ä¸åˆ©ç”¨å›½å®¶é‡ç‚¹å®éªŒå®¤</p><p>æè¯¦ | 2019å¹´12æœˆ31æ—¥</p><p>ç›®å½•
è½¯ä»¶å®‰è£…
å˜å¼‚æ£€æµ‹
ç¾¤ä½“ç»“æ„åˆ†æ
é€‰æ‹©åˆ†æ
GWASåˆ†æ
QTL-seqåˆ†æ
è½¯ä»¶å®‰è£…
âš ï¸ æ³¨æ„: è¯¥éƒ¨åˆ†è½¯ä»¶å¾ˆéš¾ç”¨condaç›´æ¥å®‰è£…ï¼Œå®‰è£…æ­¥éª¤æ¯”è¾ƒç‰¹æ®Šã€‚</p><ol><li>lumpy-sv
ğŸ’¡ lumpy-sv ä¾èµ– Python2.7ï¼Œéœ€åˆ‡æ¢åˆ° py27 ç¯å¢ƒä¸‹è¿›è¡Œå®‰è£…ã€‚</li></ol><p>Bash</p><p>conda activate py27
git clone &ndash;recursive <a href=https://github.com/arq5x/lumpy-sv.git>https://github.com/arq5x/lumpy-sv.git</a>
cd lumpy-sv
make
2. svtyper
Bash</p><p>conda install svtyper
3. cnvnator
ğŸ’¡ cnvnator ä¾èµ–äº root è½¯ä»¶åŒ…åŠ samtools è½¯ä»¶åŒ…ï¼ˆåŒ…å«HTSlibï¼‰ï¼Œå› æ­¤å…ˆå®‰è£…ä¾èµ–ã€‚</p><p>3.1 å®‰è£… samtools
Bash</p><p>wget <a href=https://github.com/samtools/samtools/releases/download/1.9/samtools-1.9.tar.bz2>https://github.com/samtools/samtools/releases/download/1.9/samtools-1.9.tar.bz2</a>
tar -xvf samtools-1.9.tar.bz2
cd samtools-1.9/
./configure
make
3.2 å®‰è£… root è½¯ä»¶
Bash</p><h1 id=ç›´æ¥ä¸‹è½½åè§£å‹å³å¯>ç›´æ¥ä¸‹è½½åè§£å‹å³å¯<a hidden class=anchor aria-hidden=true href=#ç›´æ¥ä¸‹è½½åè§£å‹å³å¯>#</a></h1><p>wget <a href=https://root.cern/download/root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz>https://root.cern/download/root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz</a>
tar -zxvf root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz
3.3 å®‰è£… cnvnator
Bash</p><p>git clone <a href=https://github.com/abyzovlab/CNVnator.git>https://github.com/abyzovlab/CNVnator.git</a>
cd CNVnator</p><h1 id=é“¾æ¥samtoolsè½¯ä»¶ç›®å½•åˆ°cnvnatorç›®å½•>é“¾æ¥samtoolsè½¯ä»¶ç›®å½•åˆ°cnvnatorç›®å½•<a hidden class=anchor aria-hidden=true href=#é“¾æ¥samtoolsè½¯ä»¶ç›®å½•åˆ°cnvnatorç›®å½•>#</a></h1><p>ln -s ../samtools-1.9 ./samtools</p><h1 id=åŠ è½½rootè½¯ä»¶åˆ°ç¯å¢ƒå˜é‡>åŠ è½½rootè½¯ä»¶åˆ°ç¯å¢ƒå˜é‡<a hidden class=anchor aria-hidden=true href=#åŠ è½½rootè½¯ä»¶åˆ°ç¯å¢ƒå˜é‡>#</a></h1><p>export ROOTSYS=/pub/software/root
export PATH=/pub/software/root/bin:$PATH
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$ROOTSYS/lib</p><h1 id=å®‰è£…cnvnator>å®‰è£…cnvnator<a hidden class=anchor aria-hidden=true href=#å®‰è£…cnvnator>#</a></h1><p>make LIBS="-lcrypto"
å˜å¼‚æ£€æµ‹</p><ol><li>æ„å»ºåŸºå› ç»„ index
Bash</li></ol><h1 id=åˆ›å»ºè½¯é“¾æ¥>åˆ›å»ºè½¯é“¾æ¥<a hidden class=anchor aria-hidden=true href=#åˆ›å»ºè½¯é“¾æ¥>#</a></h1><p>ln -s ../data/genome.fasta ./genome.fasta</p><h1 id=for-gatk>for gatk<a hidden class=anchor aria-hidden=true href=#for-gatk>#</a></h1><p>samtools faidx genome.fasta</p><h1 id=for-bwa>for bwa<a hidden class=anchor aria-hidden=true href=#for-bwa>#</a></h1><p>bwa index genome.fasta</p><h1 id=for-picard>for picard<a hidden class=anchor aria-hidden=true href=#for-picard>#</a></h1><p>picard CreateSequenceDictionary R=genome.fasta
2. æ¯”å¯¹æ’åºå»é‡
2.1 æ¯”å¯¹æ’åº</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-Bash data-lang=Bash><span style=display:flex><span>
</span></span><span style=display:flex><span>bwa mem -t <span style=color:#ae81ff>2</span> -R <span style=color:#e6db74>&#39;@RG\tID:S1\tSM:S1\tPL:illumina&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>    ../01.ref/genome.fasta <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>    ../data/S1_1.fq.gz ../data/S1_2.fq.gz | <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>    /pub/software/samtools/samtools sort -@ <span style=color:#ae81ff>2</span> -m 1G -o S1.sort.bam -
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>bwa mem -t <span style=color:#ae81ff>2</span> -R <span style=color:#e6db74>&#39;@RG\tID:S2\tSM:S2\tPL:illumina&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>    ../01.ref/genome.fasta <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>    ../data/S2_1.fq.gz ../data/S2_2.fq.gz | <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>    /pub/software/samtools/samtools sort -@ <span style=color:#ae81ff>2</span> -m 1G -o S2.sort.bam -
</span></span></code></pre></div><p>2.2 å»é™¤é‡å¤
Bash</p><p>picard -Xmx4g MarkDuplicates<br>I=S1.sort.bam<br>O=S1.sort.rmdup.bam<br>CREATE_INDEX=true<br>REMOVE_DUPLICATES=true<br>M=S1.marked_dup_metrics.txt</p><p>picard -Xmx4g MarkDuplicates<br>I=S2.sort.bam<br>O=S2.sort.rmdup.bam<br>CREATE_INDEX=true<br>REMOVE_DUPLICATES=true<br>M=S2.marked_dup_metrics.txt
2.3 æ¯”å¯¹ç‡ç»Ÿè®¡
Bash</p><p>/pub/software/samtools/samtools flagstat S1.sort.bam > S1.sort.bam.flagstat
/pub/software/samtools/samtools flagstat S2.sort.bam > S2.sort.bam.flagstat
2.4 æ‰¹é‡æ¯”å¯¹è„šæœ¬ç”Ÿæˆ
Bash</p><p>less ../data/sample.list | awk &lsquo;{
print &ldquo;bwa mem -t 2 -R &lsquo;'&rsquo;@RG\tID:"$1&rdquo;\tSM:"$1"\tPL:illumina&rsquo;'&rsquo;<br>../01.ref/genome.fasta ../data/"$1"_1.fq.gz ../data/"$1"_2.fq.gz |<br>/pub/software/samtools/samtools sort -@ 2 -m 1G -o &ldquo;$1&rdquo;.sort.bam -"
}&rsquo;
3. SNPã€Indel æ£€æµ‹
3.1 HaplotypeCaller
Bash</p><p>gatk &ndash;java-options &ldquo;-Xmx10g -Djava.io.tmpdir=./tmp&rdquo; HaplotypeCaller<br>-R ../01.ref/genome.fasta<br>-I ../02.mapping/S1.sort.rmdup.bam<br>-ERC GVCF<br>-O S1.g.vcf 1>S1.HC.log 2>&amp;1</p><p>gatk &ndash;java-options &ldquo;-Xmx10g -Djava.io.tmpdir=./tmp&rdquo; HaplotypeCaller<br>-R ../01.ref/genome.fasta<br>-I ../02.mapping/S2.sort.rmdup.bam<br>-ERC GVCF<br>-O S2.g.vcf 1>S2.HC.log 2>&amp;1
3.2 CombineGVCFs
Bash</p><p>ls ./S*.g.vcf > gvcf.list</p><p>gatk &ndash;java-options &ldquo;-Xmx4g -Djava.io.tmpdir=./tmp&rdquo; CombineGVCFs<br>-R ../01.ref/genome.fasta<br>-V gvcf.list<br>-O all.merge.g.vcf
3.3 GenotypeGVCFs
Bash</p><p>gatk &ndash;java-options &ldquo;-Xmx4g -Djava.io.tmpdir=./tmp&rdquo; GenotypeGVCFs<br>-R ../01.ref/genome.fasta<br>&ndash;variant all.merge.g.vcf<br>-O all.merge_raw.vcf
3.4 SNP è¿‡æ»¤
Bash</p><h1 id=æå–snp>æå–SNP<a hidden class=anchor aria-hidden=true href=#æå–snp>#</a></h1><p>gatk &ndash;java-options &ldquo;-Xmx4g -Djava.io.tmpdir=./tmp&rdquo; SelectVariants<br>-R ../01.ref/genome.fasta<br>-V all.merge_raw.vcf<br>&ndash;select-type SNP<br>-O all.raw.snp.vcf</p><h1 id=æ ‡è®°è¿‡æ»¤>æ ‡è®°è¿‡æ»¤<a hidden class=anchor aria-hidden=true href=#æ ‡è®°è¿‡æ»¤>#</a></h1><p>gatk &ndash;java-options &ldquo;-Xmx4g -Djava.io.tmpdir=./tmp&rdquo; VariantFiltration<br>-R ../01.ref/genome.fasta<br>-V all.raw.snp.vcf<br>&ndash;filter-expression &ldquo;QD &lt; 2.0 || MQ &lt; 40.0 || FS > 60.0 || SOR > 3.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt; -8.0&rdquo;<br>&ndash;filter-name &lsquo;SNP_filter&rsquo;<br>-O all.filter.snp.vcf</p><h1 id=æå–è¿‡æ»¤åçš„snp>æå–è¿‡æ»¤åçš„SNP<a hidden class=anchor aria-hidden=true href=#æå–è¿‡æ»¤åçš„snp>#</a></h1><p>gatk &ndash;java-options &ldquo;-Xmx4g -Djava.io.tmpdir=./tmp&rdquo; SelectVariants<br>-R ../01.ref/genome.fasta<br>-V all.filter.snp.vcf<br>&ndash;exclude-filtered<br>-O all.filtered.snp.vcf
3.5 InDel è¿‡æ»¤
Bash</p><h1 id=æå–indel>æå–InDel<a hidden class=anchor aria-hidden=true href=#æå–indel>#</a></h1><p>gatk &ndash;java-options &ldquo;-Xmx4g -Djava.io.tmpdir=./tmp&rdquo; SelectVariants<br>-R ../01.ref/genome.fasta<br>-V all.merge_raw.vcf<br>&ndash;select-type INDEL<br>-O all.raw.indel.vcf</p><h1 id=æ ‡è®°è¿‡æ»¤-1>æ ‡è®°è¿‡æ»¤<a hidden class=anchor aria-hidden=true href=#æ ‡è®°è¿‡æ»¤-1>#</a></h1><p>gatk &ndash;java-options &ldquo;-Xmx4g -Djava.io.tmpdir=./tmp&rdquo; VariantFiltration<br>-R ../01.ref/genome.fasta<br>-V all.raw.indel.vcf<br>&ndash;filter-expression &ldquo;QD &lt; 2.0 || FS > 200.0 || SOR > 10.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt; -8.0&rdquo;<br>&ndash;filter-name &lsquo;INDEL_filter&rsquo;<br>-O all.filter.indel.vcf</p><h1 id=æå–è¿‡æ»¤åçš„indel>æå–è¿‡æ»¤åçš„InDel<a hidden class=anchor aria-hidden=true href=#æå–è¿‡æ»¤åçš„indel>#</a></h1><p>gatk &ndash;java-options &ldquo;-Xmx4g -Djava.io.tmpdir=./tmp&rdquo; SelectVariants<br>-R ../01.ref/genome.fasta<br>-V all.filter.indel.vcf<br>&ndash;exclude-filtered<br>-O all.filtered.indel.vcf
4. SV æ£€æµ‹
Bash</p><h1 id=step-1-æå–-discordants-reads>Step 1: æå– discordants reads<a hidden class=anchor aria-hidden=true href=#step-1-æå–-discordants-reads>#</a></h1><p>/pub/software/samtools/samtools view -b -F 1294 -@ 12<br>../02.mapping/S1.sort.rmdup.bam > S1.discordants.bam
/pub/software/samtools/samtools view -b -F 1294 -@ 12<br>../02.mapping/S2.sort.rmdup.bam > S2.discordants.bam</p><h1 id=step-2-æå–-split-reads>Step 2: æå– split reads<a hidden class=anchor aria-hidden=true href=#step-2-æå–-split-reads>#</a></h1><p>/pub/software/samtools/samtools view -h ../02.mapping/S1.sort.rmdup.bam |<br>/pub/software/lumpy-sv/scripts/extractSplitReads_BwaMem -i stdin |<br>/pub/software/samtools/samtools sort - > S1.splitters.bam</p><p>/pub/software/samtools/samtools view -h ../02.mapping/S2.sort.rmdup.bam |<br>/pub/software/lumpy-sv/scripts/extractSplitReads_BwaMem -i stdin |<br>/pub/software/samtools/samtools sort - > S2.splitters.bam</p><h1 id=step-3-è¿è¡Œ-lumpy>Step 3: è¿è¡Œ lumpy<a hidden class=anchor aria-hidden=true href=#step-3-è¿è¡Œ-lumpy>#</a></h1><p>/pub/software/lumpy-sv/bin/lumpyexpress<br>-B ../02.mapping/S1.sort.rmdup.bam,../02.mapping/S2.sort.rmdup.bam<br>-S S1.splitters.bam,S2.splitters.bam<br>-D S1.discordants.bam,S2.discordants.bam<br>-o all.sv.lumpy.vcf</p><h1 id=step-4-ä¸ªä½“åŸºå› å‹åˆ†å‹>Step 4: ä¸ªä½“åŸºå› å‹åˆ†å‹<a hidden class=anchor aria-hidden=true href=#step-4-ä¸ªä½“åŸºå› å‹åˆ†å‹>#</a></h1><p>vcftools &ndash;vcf all.sv.lumpy.vcf &ndash;indv S1 &ndash;recode &ndash;recode-INFO-all &ndash;out S1 &&<br>svtyper -i S1.recode.vcf -B ../02.mapping/S1.sort.rmdup.bam -o S1.genotype.vcf</p><p>vcftools &ndash;vcf all.sv.lumpy.vcf &ndash;indv S2 &ndash;recode &ndash;recode-INFO-all &ndash;out S2 &&<br>svtyper -i S2.recode.vcf -B ../02.mapping/S2.sort.rmdup.bam -o S2.genotype.vcf
5. CNV æ£€æµ‹
5.1 å‡†å¤‡åŸºå› ç»„
Bash</p><h1 id=å°†åŸºå› ç»„æ‹†åˆ†ä¸ºå•æ¡æŸ“è‰²ä½“>å°†åŸºå› ç»„æ‹†åˆ†ä¸ºå•æ¡æŸ“è‰²ä½“<a hidden class=anchor aria-hidden=true href=#å°†åŸºå› ç»„æ‹†åˆ†ä¸ºå•æ¡æŸ“è‰²ä½“>#</a></h1><p>ln -s ../data/genome.fasta ./genome.fa
seqkit split -i ./genome.fa -O split</p><h1 id=é‡å‘½åæ–‡ä»¶>é‡å‘½åæ–‡ä»¶<a hidden class=anchor aria-hidden=true href=#é‡å‘½åæ–‡ä»¶>#</a></h1><p>ls ./split/genome.id_*.fa | sed &rsquo;s/./split/genome.id_//&rsquo; |<br>awk &lsquo;{print &ldquo;mv ./split/genome.id_"$aa&rdquo; ./split/"$aa}&rsquo; > mv_name.sh
sh mv_name.sh
5.2 è¿è¡Œ cnvnator
Bash</p><h1 id=è®¾ç½®ç¯å¢ƒå˜é‡>è®¾ç½®ç¯å¢ƒå˜é‡<a hidden class=anchor aria-hidden=true href=#è®¾ç½®ç¯å¢ƒå˜é‡>#</a></h1><p>export ROOTSYS=/pub/software/root
export PATH=/pub/software/root/bin:$PATH
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$ROOTSYS/lib</p><h1 id=é“¾æ¥æ–‡ä»¶>é“¾æ¥æ–‡ä»¶<a hidden class=anchor aria-hidden=true href=#é“¾æ¥æ–‡ä»¶>#</a></h1><p>ln -s ../02.mapping/S1.sort.rmdup.bam</p><h1 id=æå–æ¯”å¯¹ç»“æœ>æå–æ¯”å¯¹ç»“æœ<a hidden class=anchor aria-hidden=true href=#æå–æ¯”å¯¹ç»“æœ>#</a></h1><p>/pub/software/CNVnator/cnvnator -genome genome.fa -root S1.root -tree S1.sort.rmdup.bam</p><h1 id=ç”Ÿæˆæ·±åº¦åˆ†å¸ƒ>ç”Ÿæˆæ·±åº¦åˆ†å¸ƒ<a hidden class=anchor aria-hidden=true href=#ç”Ÿæˆæ·±åº¦åˆ†å¸ƒ>#</a></h1><p>/pub/software/CNVnator/cnvnator -genome genome.fa -root S1.root -his 500 -d split</p><h1 id=è¿›è¡Œç»Ÿè®¡è®¡ç®—>è¿›è¡Œç»Ÿè®¡è®¡ç®—<a hidden class=anchor aria-hidden=true href=#è¿›è¡Œç»Ÿè®¡è®¡ç®—>#</a></h1><p>/pub/software/CNVnator/cnvnator -root S1.root -stat 500</p><h1 id=æ£€æŸ¥bin-sizeæ˜¯å¦åˆé€‚>æ£€æŸ¥bin sizeæ˜¯å¦åˆé€‚<a hidden class=anchor aria-hidden=true href=#æ£€æŸ¥bin-sizeæ˜¯å¦åˆé€‚>#</a></h1><p>/pub/software/CNVnator/cnvnator -root S1.root -eval 500 > S1.eval.ratio</p><h1 id=rdä¿¡å·åˆ†å‰²>RDä¿¡å·åˆ†å‰²<a hidden class=anchor aria-hidden=true href=#rdä¿¡å·åˆ†å‰²>#</a></h1><p>/pub/software/CNVnator/cnvnator -root S1.root -partition 500</p><h1 id=è¿›è¡Œcnvæ£€æµ‹>è¿›è¡ŒCNVæ£€æµ‹<a hidden class=anchor aria-hidden=true href=#è¿›è¡Œcnvæ£€æµ‹>#</a></h1><p>/pub/software/CNVnator/cnvnator -root S1.root -call 500 > S1.cnv
6. SNP/InDel æ³¨é‡Š
6.1 å‡†å¤‡æ³¨é‡Šæ•°æ®åº“
Bash</p><p>ln -s ../data/genome.gtf
ln -s ../data/genome.fasta</p><p>gtfToGenePred -genePredExt genome.gtf genome_refGene.txt</p><p>/pub/software/annovar/retrieve_seq_from_fasta.pl<br>&ndash;format refGene<br>&ndash;seqfile genome.fasta<br>genome_refGene.txt<br>&ndash;out genome_refGeneMrna.fa
6.2 æ³¨é‡Š VCF æ–‡ä»¶
Bash</p><p>ln -s ../03.SNP_indel/all.filtered.snp.vcf</p><h1 id=æ ¼å¼è½¬æ¢>æ ¼å¼è½¬æ¢<a hidden class=anchor aria-hidden=true href=#æ ¼å¼è½¬æ¢>#</a></h1><p>/pub/software/annovar/convert2annovar.pl<br>-format vcf4old<br>all.filtered.snp.vcf > all.snp.vcf.annovar.input</p><h1 id=è¿›è¡Œæ³¨é‡Š>è¿›è¡Œæ³¨é‡Š<a hidden class=anchor aria-hidden=true href=#è¿›è¡Œæ³¨é‡Š>#</a></h1><p>/pub/software/annovar/annotate_variation.pl<br>-geneanno<br>&ndash;neargene 2000<br>-buildver genome<br>-dbtype refGene<br>-outfile all.anno<br>-exonsort<br>all.snp.vcf.annovar.input ./
7. CNV å’Œ SV æ³¨é‡Š
Bash</p><h1 id=å¤„ç†svæ–‡ä»¶>å¤„ç†SVæ–‡ä»¶<a hidden class=anchor aria-hidden=true href=#å¤„ç†svæ–‡ä»¶>#</a></h1><p>less -S ../04.SV/all.sv.lumpy.vcf |<br>awk -F &ldquo;;&rdquo; &lsquo;{ if($1!~/#/){print $1"\t"$2"\t"$3"\t"$4} }&rsquo; |<br>awk &lsquo;{print $1"\t"$2"\t"$11"\t"$3"\t"$8}&rsquo; |<br>sed &rsquo;s/END=//&rsquo; | sed &rsquo;s/SVTYPE=//&rsquo; > SV.bed</p><h1 id=è¿‡æ»¤bndç±»å‹>è¿‡æ»¤BNDç±»å‹<a hidden class=anchor aria-hidden=true href=#è¿‡æ»¤bndç±»å‹>#</a></h1><p>awk &lsquo;$5 !~ /BND/&rsquo; SV.bed > SV_filter.bed</p><h1 id=svæ³¨é‡Š>SVæ³¨é‡Š<a hidden class=anchor aria-hidden=true href=#svæ³¨é‡Š>#</a></h1><p>bedtools intersect -wo -a SV_filter.bed -b gene.gtf > SV_filter.Anno</p><h1 id=å¤„ç†cnvæ–‡ä»¶>å¤„ç†CNVæ–‡ä»¶<a hidden class=anchor aria-hidden=true href=#å¤„ç†cnvæ–‡ä»¶>#</a></h1><p>less -S ../05.CNV/S1.cnv |<br>awk &lsquo;{print $2 &ldquo;\t&rdquo; $1}&rsquo; |<br>sed &rsquo;s/:/\t/&rsquo; | sed &rsquo;s/-/\t/&rsquo; > CNV.bed</p><h1 id=cnvæ³¨é‡Š>CNVæ³¨é‡Š<a hidden class=anchor aria-hidden=true href=#cnvæ³¨é‡Š>#</a></h1><p>bedtools intersect -wo -a CNV.bed -b gene.gtf > CNV.Anno
ç¾¤ä½“ç»“æ„åˆ†æ</p><ol><li>æ•°æ®è¿‡æ»¤
Bash</li></ol><p>vcf=../data/all.vcf</p><h1 id=è¿‡æ»¤ç¼ºå¤±ç‡å’Œæœ€å°ç­‰ä½åŸºå› é¢‘ç‡>è¿‡æ»¤ç¼ºå¤±ç‡å’Œæœ€å°ç­‰ä½åŸºå› é¢‘ç‡<a hidden class=anchor aria-hidden=true href=#è¿‡æ»¤ç¼ºå¤±ç‡å’Œæœ€å°ç­‰ä½åŸºå› é¢‘ç‡>#</a></h1><p>plink &ndash;vcf $vcf<br>&ndash;geno 0.1<br>&ndash;maf 0.01<br>&ndash;out all.missing_maf<br>&ndash;recode vcf-iid<br>&ndash;allow-extra-chr<br>&ndash;set-missing-var-ids @:#<br>&ndash;keep-allele-order</p><h1 id=è¿‡æ»¤è¿é”ä¸å¹³è¡¡>è¿‡æ»¤è¿é”ä¸å¹³è¡¡<a hidden class=anchor aria-hidden=true href=#è¿‡æ»¤è¿é”ä¸å¹³è¡¡>#</a></h1><p>plink &ndash;vcf all.missing_maf.vcf<br>&ndash;indep-pairwise 50 10 0.2<br>&ndash;out tmp.ld<br>&ndash;allow-extra-chr<br>&ndash;set-missing-var-ids @:#</p><p>plink &ndash;vcf all.missing_maf.vcf<br>&ndash;make-bed<br>&ndash;extract tmp.ld.prune.in<br>&ndash;out all.LDfilter<br>&ndash;recode vcf-iid<br>&ndash;keep-allele-order<br>&ndash;allow-extra-chr<br>&ndash;set-missing-var-ids @:#
2. å»ºæ ‘åˆ†æ
2.1 NJ æ ‘
Bash</p><h1 id=æ ¼å¼è½¬æ¢-1>æ ¼å¼è½¬æ¢<a hidden class=anchor aria-hidden=true href=#æ ¼å¼è½¬æ¢-1>#</a></h1><p>perl ../../script/vcf2phy.pl ../../00.filter/all.LDfilter.vcf > sequences.dat</p><h1 id=è®¡ç®—é—ä¼ è·ç¦»>è®¡ç®—é—ä¼ è·ç¦»<a hidden class=anchor aria-hidden=true href=#è®¡ç®—é—ä¼ è·ç¦»>#</a></h1><p>echo -e &ldquo;sequences.dat\nY&rdquo; > dnadist.cfg
dnadist &lt; dnadist.cfg > dnadist.log
mv outfile infile.dist</p><h1 id=æ„å»ºnjæ ‘>æ„å»ºNJæ ‘<a hidden class=anchor aria-hidden=true href=#æ„å»ºnjæ ‘>#</a></h1><p>echo -e &ldquo;infile.dist\nY&rdquo; > neighbor.cfg
neighbor &lt; neighbor.cfg > nj.log</p><h1 id=æ ¼å¼æ•´ç†>æ ¼å¼æ•´ç†<a hidden class=anchor aria-hidden=true href=#æ ¼å¼æ•´ç†>#</a></h1><p>less infile.dist | tr &lsquo;\n&rsquo; &lsquo;|&rsquo; | sed &rsquo;s/| / /g&rsquo; | tr &lsquo;|&rsquo; &lsquo;\n&rsquo; > infile.dist.table
less outtree | tr &lsquo;\n&rsquo; &rsquo; &rsquo; | sed &rsquo;s/ //g&rsquo; > outtree.nwk
2.2 SNPhylo å»ºæ ‘
Bash</p><p>/pub/software/SNPhylo/snphylo.sh<br>-v ../../00.filter/all.LDfilter.vcf<br>-r<br>-l 1<br>-m 0.01<br>-o GA0001<br>-b<br>-B 2<br>-P tree_snphylo
3. PCA åˆ†æ
Bash</p><p>plink &ndash;vcf ../00.filter/all.LDfilter.vcf<br>&ndash;pca 10<br>&ndash;out PCA_out<br>&ndash;allow-extra-chr<br>&ndash;set-missing-var-ids @:#</p><p>Rscript ../script/draw_PCA.R PCA_out.eigenvec 1 2 ../data/sample.pop PCA_out_figure
4. ç¾¤ä½“ç»“æ„åˆ†æ
Bash</p><h1 id=step-0-vcfè½¬bedæ ¼å¼>Step 0: vcfè½¬bedæ ¼å¼<a hidden class=anchor aria-hidden=true href=#step-0-vcfè½¬bedæ ¼å¼>#</a></h1><p>plink &ndash;vcf ../00.filter/all.LDfilter.vcf<br>&ndash;make-bed<br>&ndash;out all<br>&ndash;allow-extra-chr<br>&ndash;keep-allele-order<br>&ndash;set-missing-var-ids @:#</p><h1 id=step-1-ç”Ÿæˆadmixtureè¿è¡Œè„šæœ¬>Step 1: ç”ŸæˆAdmixtureè¿è¡Œè„šæœ¬<a hidden class=anchor aria-hidden=true href=#step-1-ç”Ÿæˆadmixtureè¿è¡Œè„šæœ¬>#</a></h1><p>seq 2 4 | awk &lsquo;{print &ldquo;admixture &ndash;cv -j2 all.bed &ldquo;$1&rdquo; 1>admix."$1&rdquo;.log 2>&amp;1"}&rsquo; > admixture.sh</p><h1 id=step-2-è¿è¡Œadmixture>Step 2: è¿è¡ŒAdmixture<a hidden class=anchor aria-hidden=true href=#step-2-è¿è¡Œadmixture>#</a></h1><p>sh admixture.sh</p><h1 id=ä¹Ÿå¯å•ç‹¬è¿è¡Œ>ä¹Ÿå¯å•ç‹¬è¿è¡Œ<a hidden class=anchor aria-hidden=true href=#ä¹Ÿå¯å•ç‹¬è¿è¡Œ>#</a></h1><p>admixture &ndash;cv -j2 all.bed 2 1>admix.2.log 2>&amp;1
admixture &ndash;cv -j2 all.bed 3 1>admix.3.log 2>&amp;1
admixture &ndash;cv -j2 all.bed 4 1>admix.4.log 2>&amp;1</p><h1 id=step-3-ç»˜åˆ¶ç»“æ„å›¾>Step 3: ç»˜åˆ¶ç»“æ„å›¾<a hidden class=anchor aria-hidden=true href=#step-3-ç»˜åˆ¶ç»“æ„å›¾>#</a></h1><p>mkdir result
cp ./*.Q result/
Rscript ../script/draw_admixture.R result all.nosex structure
5. LD è¡°å‡åˆ†æ
Bash</p><h1 id=step-1-è®¡ç®—ld>Step 1: è®¡ç®—LD<a hidden class=anchor aria-hidden=true href=#step-1-è®¡ç®—ld>#</a></h1><p>/pub/software/PopLDdecay/bin/PopLDdecay<br>-InVCF ../data/all.vcf<br>-SubPop ../data/pop.SC.table<br>-MaxDist 500<br>-OutStat pop.SC.stat</p><p>/pub/software/PopLDdecay/bin/PopLDdecay<br>-InVCF ../data/all.vcf<br>-SubPop ../data/pop.YZR.table<br>-MaxDist 500<br>-OutStat pop.YZR.stat</p><h1 id=step-2-ç»˜åˆ¶å•ç¾¤ä½“ldè¡°å‡å›¾>Step 2: ç»˜åˆ¶å•ç¾¤ä½“LDè¡°å‡å›¾<a hidden class=anchor aria-hidden=true href=#step-2-ç»˜åˆ¶å•ç¾¤ä½“ldè¡°å‡å›¾>#</a></h1><p>perl /pub/software/PopLDdecay/bin/Plot_OnePop.pl<br>-inFile pop.SC.stat.gz<br>-output pop.SC.ld</p><p>perl /pub/software/PopLDdecay/bin/Plot_OnePop.pl<br>-inFile pop.YZR.stat.gz<br>-output pop.YZR.ld</p><h1 id=step-3-ç»˜åˆ¶å¤šç¾¤ä½“ldè¡°å‡å›¾>Step 3: ç»˜åˆ¶å¤šç¾¤ä½“LDè¡°å‡å›¾<a hidden class=anchor aria-hidden=true href=#step-3-ç»˜åˆ¶å¤šç¾¤ä½“ldè¡°å‡å›¾>#</a></h1><p>perl /pub/software/PopLDdecay/bin/Plot_MultiPop.pl<br>-inList ld_stat.list<br>-output ld_stat.multi
é€‰æ‹©åˆ†æ</p><ol><li>Ï€ å’Œ ROD åˆ†æ
Bash</li></ol><p>vcf=../../data/all.vcf
window=20000
step=2000</p><h1 id=step-1-è®¡ç®—piå€¼>Step 1: è®¡ç®—piå€¼<a hidden class=anchor aria-hidden=true href=#step-1-è®¡ç®—piå€¼>#</a></h1><p>vcftools &ndash;vcf $vcf<br>&ndash;window-pi $window<br>&ndash;window-pi-step $step<br>&ndash;keep ../../data/pop.SC.table<br>&ndash;out ./Pi.pop1</p><p>vcftools &ndash;vcf $vcf<br>&ndash;window-pi $window<br>&ndash;window-pi-step $step<br>&ndash;keep ../../data/pop.YZR.table<br>&ndash;out ./Pi.pop2</p><h1 id=step-2-è®¡ç®—rod>Step 2: è®¡ç®—ROD<a hidden class=anchor aria-hidden=true href=#step-2-è®¡ç®—rod>#</a></h1><p>pi1=Pi.pop1.windowed.pi
pi2=Pi.pop2.windowed.pi
perl ../../script/merge2pi_ROD.pl $pi1 $pi2 > Pi.ROD
2. Tajima&rsquo;s D åˆ†æ
Bash</p><p>vcf=../../data/all.vcf
window=20000</p><p>vcftools &ndash;vcf $vcf<br>&ndash;TajimaD $window<br>&ndash;keep ../../data/pop.SC.table<br>&ndash;out TajimaD.pop1</p><p>vcftools &ndash;vcf $vcf<br>&ndash;TajimaD $window<br>&ndash;keep ../../data/pop.YZR.table<br>&ndash;out TajimaD.pop2
3. Fst åˆ†æ
Bash</p><p>vcf=../../data/all.vcf
window=20000
step=2000</p><p>vcftools &ndash;vcf $vcf<br>&ndash;fst-window-size $window<br>&ndash;fst-window-step $step<br>&ndash;weir-fst-pop ../../data/pop.SC.table<br>&ndash;weir-fst-pop ../../data/pop.YZR.table<br>&ndash;out ./Fst.pop1.pop2
4. ROD + Fst è”åˆåˆ†æ
Bash</p><p>fst=../03.Fst/Fst.pop1.pop2.windowed.weir.fst
ROD=../01.pi_ROD/Pi.ROD
gff=../../data/genome.gff</p><h1 id=æå–æ˜¾è‘—ä½ç‚¹>æå–æ˜¾è‘—ä½ç‚¹<a hidden class=anchor aria-hidden=true href=#æå–æ˜¾è‘—ä½ç‚¹>#</a></h1><p>perl ../../script/top_Fst_ROD_S.pl $fst $ROD 0.05 0.05 Fst_ROD.table Fst_ROD.stat</p><h1 id=ç­›é€‰topä½ç‚¹>ç­›é€‰topä½ç‚¹<a hidden class=anchor aria-hidden=true href=#ç­›é€‰topä½ç‚¹>#</a></h1><p>awk &lsquo;$NF==&ldquo;top&rdquo;&rsquo; Fst_ROD.table > Fst_ROD.table.top</p><h1 id=æå–åŸºå› æ³¨é‡Š>æå–åŸºå› æ³¨é‡Š<a hidden class=anchor aria-hidden=true href=#æå–åŸºå› æ³¨é‡Š>#</a></h1><p>awk &lsquo;$3==&ldquo;gene&rdquo;&rsquo; $gff > gene.gff</p><h1 id=æ³¨é‡Šå€™é€‰åŸºå› >æ³¨é‡Šå€™é€‰åŸºå› <a hidden class=anchor aria-hidden=true href=#æ³¨é‡Šå€™é€‰åŸºå› >#</a></h1><p>bedtools intersect -wo -F 0.1 -a Fst_ROD.table.top -b gene.gff |<br>awk -F &ldquo;\t&rdquo; &lsquo;{print $7"\t"$10"\t"$11"\t"$13"\t"$15}&rsquo; |<br>sort -u > Fst_ROD.table.top.gene
GWASåˆ†æ</p><ol><li>åŸºå› å‹å¡«å……
Bash</li></ol><p>beagle -Xmx4g -Djava.io.tmpdir=./TMP<br>gt=../data/all.vcf<br>out=all.impute<br>impute=true<br>window=10<br>nthreads=2
2. æ ‡å‡† GWAS åˆ†æ
Bash</p><h1 id=step-1-å‡†å¤‡vcfæ•°æ®>Step 1: å‡†å¤‡VCFæ•°æ®<a hidden class=anchor aria-hidden=true href=#step-1-å‡†å¤‡vcfæ•°æ®>#</a></h1><p>plink &ndash;vcf ../data/all.vcf<br>&ndash;maf 0.05<br>&ndash;geno 0.1<br>&ndash;recode12<br>&ndash;output-missing-genotype 0<br>&ndash;transpose<br>&ndash;out snp_filter<br>&ndash;set-missing-var-ids @:#<br>&ndash;allow-extra-chr</p><h1 id=å‡†å¤‡è¡¨å‹æ•°æ®>å‡†å¤‡è¡¨å‹æ•°æ®<a hidden class=anchor aria-hidden=true href=#å‡†å¤‡è¡¨å‹æ•°æ®>#</a></h1><p>perl ../script/sort_pheno.pl snp_filter.tfam ../data/trait.table > trait.sort.txt</p><h1 id=step-2-è®¡ç®—äº²ç¼˜å…³ç³»çŸ©é˜µ>Step 2: è®¡ç®—äº²ç¼˜å…³ç³»çŸ©é˜µ<a hidden class=anchor aria-hidden=true href=#step-2-è®¡ç®—äº²ç¼˜å…³ç³»çŸ©é˜µ>#</a></h1><p>/pub/software/emmax/emmax-kin-intel64 -v -d 10 -o ./pop.kinship snp_filter</p><h1 id=step-3-è¿è¡Œgwas>Step 3: è¿è¡ŒGWAS<a hidden class=anchor aria-hidden=true href=#step-3-è¿è¡Œgwas>#</a></h1><p>/pub/software/emmax/emmax-intel64 -v -d 10<br>-t snp_filter<br>-p trait.sort.txt<br>-k pop.kinship<br>-o emmax.out 1> emmax.log 2>emmax.err</p><h1 id=step-4-ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾>Step 4: ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾<a hidden class=anchor aria-hidden=true href=#step-4-ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾>#</a></h1><p>paste snp_filter.map emmax.out.ps |<br>awk &lsquo;BEGIN{print &ldquo;SNP\tCHR\tBP\tP&rdquo;}{if($2==$5){print $2"\t"$1"\t"$4"\t"$NF}}&rsquo;<br>> emmax.out.ps.manht_input</p><p>Rscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure
3. GWAS-Q åˆ†æï¼ˆåŠ å…¥ç¾¤ä½“ç»“æ„åå˜é‡ï¼‰
Bash</p><h1 id=é“¾æ¥æ–‡ä»¶-1>é“¾æ¥æ–‡ä»¶<a hidden class=anchor aria-hidden=true href=#é“¾æ¥æ–‡ä»¶-1>#</a></h1><p>ln -s ../01.GWAS/snp_filter.tped
ln -s ../01.GWAS/snp_filter.tfam
ln -s ../01.GWAS/snp_filter.nosex
ln -s ../01.GWAS/snp_filter.map
ln -s ../01.GWAS/trait.sort.txt
ln -s ../../02.population_genetics/03.structure/all.3.Q</p><h1 id=å‡†å¤‡qçŸ©é˜µ>å‡†å¤‡QçŸ©é˜µ<a hidden class=anchor aria-hidden=true href=#å‡†å¤‡qçŸ©é˜µ>#</a></h1><p>paste snp_filter.nosex all.3.Q | awk &lsquo;{print $1" &ldquo;$1&rdquo; 1 &ldquo;$3&rdquo; &ldquo;$4}&rsquo; > pop.Qmatrix</p><h1 id=è¿è¡Œgwas>è¿è¡ŒGWAS<a hidden class=anchor aria-hidden=true href=#è¿è¡Œgwas>#</a></h1><p>/pub/software/emmax/emmax-intel64 -v -d 10<br>-t snp_filter<br>-p trait.sort.txt<br>-k pop.kinship<br>-c pop.Qmatrix<br>-o emmax.out 1> emmax.log 2>emmax.err</p><h1 id=ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾>ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾<a hidden class=anchor aria-hidden=true href=#ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾>#</a></h1><p>paste snp_filter.map emmax.out.ps |<br>awk &lsquo;BEGIN{print &ldquo;SNP\tCHR\tBP\tP&rdquo;}{if($2==$5){print $2&rdquo;\t"$1"\t"$4"\t"$NF}}&rsquo;<br>> emmax.out.ps.manht_input</p><p>Rscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure_Q
4. çœŸå®æ•°æ® GWAS
Bash</p><h1 id=step-1-å‡†å¤‡æ•°æ®>Step 1: å‡†å¤‡æ•°æ®<a hidden class=anchor aria-hidden=true href=#step-1-å‡†å¤‡æ•°æ®>#</a></h1><p>plink &ndash;vcf ../data_real/Sample215.M5M8H3.2allel.vcf<br>&ndash;maf 0.05<br>&ndash;geno 0.1<br>&ndash;recode12<br>&ndash;output-missing-genotype 0<br>&ndash;transpose<br>&ndash;out snp_filter<br>&ndash;set-missing-var-ids @:#<br>&ndash;allow-extra-chr</p><p>perl ../script/sort_pheno.pl snp_filter.tfam ../data_real/trait.C16_0.table > trait.sort.txt</p><h1 id=step-2-è®¡ç®—äº²ç¼˜å…³ç³»çŸ©é˜µ-1>Step 2: è®¡ç®—äº²ç¼˜å…³ç³»çŸ©é˜µ<a hidden class=anchor aria-hidden=true href=#step-2-è®¡ç®—äº²ç¼˜å…³ç³»çŸ©é˜µ-1>#</a></h1><p>/pub/software/emmax/emmax-kin-intel64 -v -d 10 -o ./pop.kinship snp_filter</p><h1 id=step-3-è¿è¡Œgwas-1>Step 3: è¿è¡ŒGWAS<a hidden class=anchor aria-hidden=true href=#step-3-è¿è¡Œgwas-1>#</a></h1><p>/pub/software/emmax/emmax-intel64 -v -d 10<br>-t snp_filter<br>-p trait.sort.txt<br>-k pop.kinship<br>-o emmax.out 1> emmax.log 2>emmax.err</p><h1 id=step-4-ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾-1>Step 4: ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾<a hidden class=anchor aria-hidden=true href=#step-4-ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾-1>#</a></h1><p>paste snp_filter.map emmax.out.ps |<br>awk &lsquo;BEGIN{print &ldquo;SNP\tCHR\tBP\tP&rdquo;}{if($2==$5){print $2"\t"$1"\t"$4"\t"$NF}}&rsquo;<br>> emmax.out.ps.manht_input</p><p>Rscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure_readData
QTL-seqåˆ†æ</p><ol><li>VCF è½¬æ¢ä¸º Table æ ¼å¼
Bash</li></ol><p>ref=&lt;reference.fasta>
vcf=&lt;input.vcf>
outfile=&lt;output.table></p><p>gatk VariantsToTable<br>-R $ref<br>-V $vcf<br>-F CHROM -F POS -F REF -F ALT<br>-GF AD -GF DP -GF GQ -GF PL<br>-O $outfile
2. QTL-seq åˆ†æï¼ˆRè„šæœ¬ï¼‰
R</p><p>library(QTLseqr)
library(ggplot2)</p><h1 id=è®¾ç½®å‚æ•°>è®¾ç½®å‚æ•°<a hidden class=anchor aria-hidden=true href=#è®¾ç½®å‚æ•°>#</a></h1><p>HighBulk &lt;- &ldquo;SRR834931&rdquo; # é«˜å€¼æ··æ± åç§°
LowBulk &lt;- &ldquo;SRR834927&rdquo; # ä½å€¼æ··æ± åç§°
Chroms &lt;- paste0(rep(&ldquo;Chr&rdquo;, 12), 1:12) # æŸ“è‰²ä½“åˆ—è¡¨</p><h1 id=-æ•°æ®è¯»å–->==================== æ•°æ®è¯»å– ====================<a hidden class=anchor aria-hidden=true href=#-æ•°æ®è¯»å–->#</a></h1><p>df &lt;- importFromGATK(
file = &ldquo;../data/Yang_et_al_2013.table&rdquo;,
highBulk = HighBulk,
lowBulk = LowBulk,
chromList = Chroms
)</p><h1 id=-è´¨é‡æ£€æŸ¥å›¾->==================== è´¨é‡æ£€æŸ¥å›¾ ====================<a hidden class=anchor aria-hidden=true href=#-è´¨é‡æ£€æŸ¥å›¾->#</a></h1><h1 id=æ·±åº¦åˆ†å¸ƒå›¾>æ·±åº¦åˆ†å¸ƒå›¾<a hidden class=anchor aria-hidden=true href=#æ·±åº¦åˆ†å¸ƒå›¾>#</a></h1><p>p1 &lt;- ggplot(data = df) +
geom_histogram(aes(x = DP.HIGH + DP.LOW)) +
xlim(0, 800)
pdf(file = &ldquo;SNP_depth.pdf&rdquo;)
p1
dev.off()</p><h1 id=refç­‰ä½åŸºå› é¢‘ç‡åˆ†å¸ƒ>REFç­‰ä½åŸºå› é¢‘ç‡åˆ†å¸ƒ<a hidden class=anchor aria-hidden=true href=#refç­‰ä½åŸºå› é¢‘ç‡åˆ†å¸ƒ>#</a></h1><p>p2 &lt;- ggplot(data = df) +
geom_histogram(aes(x = REF_FRQ))
pdf(file = &ldquo;ref_allele_frequency.pdf&rdquo;)
p2
dev.off()</p><h1 id=é«˜å€¼æ··æ± snp-indexåˆ†å¸ƒ>é«˜å€¼æ··æ± SNP-indexåˆ†å¸ƒ<a hidden class=anchor aria-hidden=true href=#é«˜å€¼æ··æ± snp-indexåˆ†å¸ƒ>#</a></h1><p>p3 &lt;- ggplot(data = df) +
geom_histogram(aes(x = SNPindex.HIGH))
pdf(file = &ldquo;SNPindex.HIGH.dis.pdf&rdquo;)
p3
dev.off()</p><h1 id=ä½å€¼æ··æ± snp-indexåˆ†å¸ƒ>ä½å€¼æ··æ± SNP-indexåˆ†å¸ƒ<a hidden class=anchor aria-hidden=true href=#ä½å€¼æ··æ± snp-indexåˆ†å¸ƒ>#</a></h1><p>p4 &lt;- ggplot(data = df) +
geom_histogram(aes(x = SNPindex.LOW))
pdf(file = &ldquo;SNPindex.LOW.dis.pdf&rdquo;)
p4
dev.off()</p><h1 id=-snpè¿‡æ»¤->==================== SNPè¿‡æ»¤ ====================<a hidden class=anchor aria-hidden=true href=#-snpè¿‡æ»¤->#</a></h1><p>df_filt &lt;- filterSNPs(
SNPset = df,
refAlleleFreq = 0.20, # REFç­‰ä½åŸºå› é¢‘ç‡: 0.2~0.8
minTotalDepth = 100, # æœ€å°æ€»æ·±åº¦
maxTotalDepth = 400, # æœ€å¤§æ€»æ·±åº¦
minSampleDepth = 40, # å•æ ·å“æœ€å°æ·±åº¦
minGQ = 99, # åŸºå› å‹è´¨é‡é˜ˆå€¼
verbose = TRUE
)</p><h1 id=-deltasnpindexè®¡ç®—->==================== deltaSNPindexè®¡ç®— ====================<a hidden class=anchor aria-hidden=true href=#-deltasnpindexè®¡ç®—->#</a></h1><p>df_filt &lt;- runQTLseqAnalysis(
df_filt,
windowSize = 1e6, # çª—å£å¤§å°
popStruc = &ldquo;F2&rdquo;, # ç¾¤ä½“ç±»å‹
bulkSize = c(385, 430), # æ··æ± ä¸ªä½“æ•°
replications = 10000, # Bootstrapæ¬¡æ•°
intervals = c(95, 99) # ç½®ä¿¡åŒºé—´
)</p><h1 id=-ç»“æœå¯è§†åŒ–->==================== ç»“æœå¯è§†åŒ– ====================<a hidden class=anchor aria-hidden=true href=#-ç»“æœå¯è§†åŒ–->#</a></h1><h1 id=snpæ²¿æŸ“è‰²ä½“åˆ†å¸ƒ>SNPæ²¿æŸ“è‰²ä½“åˆ†å¸ƒ<a hidden class=anchor aria-hidden=true href=#snpæ²¿æŸ“è‰²ä½“åˆ†å¸ƒ>#</a></h1><p>p5 &lt;- plotQTLStats(SNPset = df_filt, var = &ldquo;nSNPs&rdquo;)
pdf(file = &ldquo;SNP_filter.window.pdf&rdquo;, width = 20, height = 4)
p5
dev.off()</p><h1 id=deltasnpindexæ²¿æŸ“è‰²ä½“åˆ†å¸ƒ>deltaSNPindexæ²¿æŸ“è‰²ä½“åˆ†å¸ƒ<a hidden class=anchor aria-hidden=true href=#deltasnpindexæ²¿æŸ“è‰²ä½“åˆ†å¸ƒ>#</a></h1><p>p6 &lt;- plotQTLStats(
SNPset = df_filt,
var = &ldquo;deltaSNP&rdquo;,
plotIntervals = TRUE
)
pdf(file = &ldquo;deltaSNPindex.pdf&rdquo;, width = 20, height = 4)
p6
dev.off()</p><h1 id=-æå–æ˜¾è‘—åŒºåŸŸ->==================== æå–æ˜¾è‘—åŒºåŸŸ ====================<a hidden class=anchor aria-hidden=true href=#-æå–æ˜¾è‘—åŒºåŸŸ->#</a></h1><p>QTL &lt;- getSigRegions(
SNPset = df_filt,
method = &ldquo;QTLseq&rdquo;,
interval = 95
)
write.table(QTL[[1]], &ldquo;QTLseq_result.SigRegions.table&rdquo;, sep = &ldquo;\t&rdquo;, quote = FALSE)</p><h1 id=-å¯¼å‡ºå®Œæ•´ç»“æœ->==================== å¯¼å‡ºå®Œæ•´ç»“æœ ====================<a hidden class=anchor aria-hidden=true href=#-å¯¼å‡ºå®Œæ•´ç»“æœ->#</a></h1><p>results99 &lt;- getQTLTable(
SNPset = df_filt,
method = &ldquo;QTLseq&rdquo;,
interval = 99,
export = FALSE
)
write.table(
results99,
file = &ldquo;QTLseq_result_deltaSNPindex_CI99.table&rdquo;,
sep = &ldquo;\t&rdquo;,
quote = FALSE
)
é™„å½•ï¼šåˆ†ææµç¨‹å›¾
text</p><p>åŸå§‹æ•°æ® (FASTQ)
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è´¨é‡æ§åˆ¶ QC â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ¯”å¯¹ Mapping â”‚ â”€â”€â–º BWA MEM
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å»é‡ MarkDup â”‚ â”€â”€â–º Picard
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â–¼ â–¼ â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SNP/InDel â”‚ â”‚ SV â”‚ â”‚ CNV â”‚
â”‚ GATK â”‚ â”‚ lumpy-sv â”‚ â”‚ CNVnator â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ³¨é‡Š â”‚
â”‚ ANNOVAR/bedtoolsâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â–¼ â–¼ â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç¾¤ä½“ç»“æ„ â”‚ â”‚ é€‰æ‹©åˆ†æ â”‚ â”‚ GWAS â”‚
â”‚ PCA/Tree â”‚ â”‚ Fst/Ï€/D â”‚ â”‚ EMMAX â”‚
â”‚ Structure â”‚ â”‚ â”‚ â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://Tdxxxx-student.github.io/>æˆ‘çš„åšå®¢</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>