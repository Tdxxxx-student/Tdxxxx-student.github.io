[{"content":"基因家族分析流程与文章撰写思路 基因家族分析是一种常见的生物信息学分析套路，也是生物信息学数据挖掘发表小文章常用的分析方法，和GEO挖掘等类似。基因家族的分析鉴定可以用pfam上的hmm文件进行基因家族的检索鉴定，也可以用blast的方法进行比对鉴定，通常是适用拟南芥对应的基因家族进行比对鉴定。\n植物转录因子数据库，点击访问。\n基因家族分析思路及文章撰写思路 基因家族分析是继GEO数据挖掘后，一种新的生物信息学挖掘策略。\n如何做基因家族研究，可以参考这个帖子：http://www.planttech.com.cn/blog/58882464a46。\n数据准备 需要准备的数据主要是参考基因组数据，包括fasta格式的序列文件、gff或gtf格式的基因组注释文件、蛋白质序列文件（通常是每个转录本的蛋白序列）、cDNA序列等文件。如果有转录组数据的话进行对应的转录组分析即可。除开上述这些文件外，还需要适用的文件还有.hmm格式的文件。\n软件准备 只需要会使用Linux系统，会安装Docker即可，然后下载组学大讲堂的镜像即可。点击浏览镜像地址。Docker的安装适用方法参考@ref(WSL4Docker)。\n分析过程 mRNA_ID与基因ID的提取 由于一个基因会对应多个转录本，因此一个基因下会对应多个mRNA的编号。在后续的分析中，每个基因只需要选择一个转录本的编号进行分析即可，因为每个基因不同的转录本的序列差异是较小的。提取的代码：\nbash\nperl code/script/mRNAid_to_geneid.pl data/unzip_data/*.gff* results/step.1.get.mRNA.and.gene.ID/mRNA2geneID.txt perl code/script/geneid_to_mRNAid.pl data/unzip_data/*.gff* results/step.1.get.mRNA.and.gene.ID/geneID2mRNAid.txt 检索结构域 这一步主要是以.hmm文件为基础检索该物种蛋白序列中含有该结构域的序列。输入文件包括.hmm文件和蛋白文件，输出hmmsearch的检索结果。其中用于后续筛选的是evalue这个参数，部分文章以0.001为阈值。of那一列表示的是某个基因对应的这个结构域有几个。\nhmmsearch --domtblout results/step.2.domain.search/hmm.txt --cut_tc data/unzip_data/*.hmm data/unzip_data/*.pep* 选择结构域 由于一个基因的单个转录本可能会比对到多个结构域，因此需要对比对到的结构域进行选择。默认选择的是第一个结构域。下面代码的最后一个参数是hmmsearch输出文件里面的E-value,如果需要全部的第一个结构域，将阈值设置为1即可。\nperl code/script/domain_xulie.pl results/step.2.domain.search/hmm.txt data/unzip_data/*.pep* results/step.2.domain.search/domain.fa 1.2e-28 多序列比对 之所以要进行多序列比对，是因为下载的.hmm文件是来自很多物种的这个结构域组成的隐马尔科夫模型，进行多序列比对后将该物种检索到的结构域序列进行比对，再次构建该物种该基因家族的隐马尔科夫模型，会更加准确。\necho -e \u0026#39;1\\nresults/step.2.domain.search/domain.fa\\n2\\n1\\nresults/step.2.domain.search/out.aln\\nr.domain.search/out.dnd\\nX\\n\\n\\nX\\n\u0026#39; |clustalw 重构隐马尔科夫模型 hmmbuild results/step.2.domain.search/new.hmm results/step.2.domain.search/out.aln 重新进行检索 利用构建得到的新的隐马尔科夫模型重新进行检索结构域。\nhmmsearch --domtblout results/step.2.domain.search/new.out.txt --cut_tc results/step.2.domain.search/new.hmm data/unzip_data/*.pep* 筛选输出结果 对重新检索后的结果进行筛选，也是对E-value进行筛选。\nbash\ngrep -v \u0026#34;^#\u0026#34; results/step.2.domain.search/new.out.txt|awk \u0026#39;$7\u0026lt;0.001 {print}\u0026#39; \u0026gt; results/step.2.domain.search/domain.new.out.selected.txt 去除重复的ID 上一步筛选得到的是该种中哪些基因是潜在的目标基因家族成员，而一个基因对应了多个mRNA，因此，只需要在筛选后的每个基因中选择一个具有代表性的mRNA进行后续的分析即可。这个提取唯一ID的步骤需要手动完成（PS：手动完成也很快）。手动挑选完mRNA的ID放在第一列，另存为文件uniqueID.txt。\nperl code/script/select_redundant_mRNA.pl results/step.1.get.mRNA.and.gene.ID/mRNA2geneID.txt results/step.2.domain.search/domain.new.out.selected.txt results/step.2.domain.search/remove_redundant_IDlist.txt 提取蛋白序列 在得到基因ID后需要提取蛋白序列进行后续的分析。在SMART或者Pfam或NCBI CDD确认这些基因是真真正正含有该结构域，没有的基因要剔除！在SMART中没有检索到结构域的基因在gene.not.in.SMART.txt中；在Pfam中全都是WRKY结构域，对应文件为Pfam.results.txt。\nperl code/script/get_fa_by_id.pl results/step.2.domain.search/uniqueID.txt data/unzip_data/*.pep* results/step .2.domain.search/pep.need.confirm.fa 计算蛋白质分子量等 perl code/script/stat_protein_fa.pl results/step.2.domain.search/pep.need.confirm.fa results/step.2.domain.search/pep.MW.txt 构建进化树 选择利用软件CLUSTALW进行多序列比对，然后利用MEGA构建进化树。CLUSTALW输出结果转换成.fasta格式的方法参考@ref(pac4xiang)。\nMotif分析 meme results/step.3.seq.and.tree/pep_confirmed.fa -protein -oc results/step.4.motif/ -nostatus -time 18000 -maxsize 6000000 -mod anr -nmotifs 10 -minw 6 -maxw 100 基因结构分析 perl code/script/get_gene_exon_from_gff.pl -in1 results/step.2.domain.search/uniqueID.txt -in2 data/unzip_data/*.gff* -out results/step.5.gene.structure/gene_exon_info.gff 基因在染色体上的定位 samtools faidx data/unzip_data/*.dna* cp data/unzip_data/*.fai results/step.5.gene.structure/ perl code/script/get_gene_weizhi.pl -in1 results/step.2.domain.search/uniqueID.txt -in2 data/unzip_data/*.gff* -out results/step.5.gene.structure/mrna_location.txt 顺式作用元件分析 脚本默认的启动子长度是1500bp。将提取得到的启动子序列上传到Plane CARE进行分析。\nperl code/script/get_promoter.pl data/unzip_data/*dna.top* results/step.5.gene.structure/mrna_location.txt results/step.6.cis.acting.element/promoter.txt 基因家族成员的亚细胞定位分析 两个网站：WolfPsort和Cello。\n基因组共线性分析 从geneid2mRNAid.txt文件中每个基因挑一个转录本ID存储到allmRNAID.txt，也就是每个基因挑选一个转录本。\nmkdir MCScanX cd MCScanX mkdir mcscan 获取转录本的位置信息： perl ../script/get_mRNA_position.pl allmRNAID.txt ../Arabidopsis_thaliana.TAIR10.41.gff3 AT.gff 输出示例：\ntext\n# 分别是染色体位置，转录本ID，起始位置和终止位置 1 Pno01G013682.t2 7993891 8000167 1 Pno01G011207.t1 6521081 6522022 1 Pno01G002381.t1 15982661 15984634 1 Pno01G006728.t1 32747373 32748586 1 Pno01G001298.t1 134750756 134753812 1 Pno01G000565.t1 11549686 11558266 1 Pno01G005598.t1 23981500 23984173 1 Pno01G012140.t1 707333 718266 1 Pno01G006114.t1 27812391 27816942 1 Pno01G001551.t1 14123991 14125021 获取挑选的转录本的蛋白序列： perl ../script/get_fa_by_id.pl allmRNAID.txt ../Arabidopsis_thaliana.TAIR10.pep.all.fa pep.fa 对所有蛋白进行建库： makeblastdb -in pep.fa -dbtype prot -title pep.fa blast比对： blastall -i pep.fa -d pep.fa -e 1e-10 -p blastp -b 5 -v 5 -m 8 -o mcscan/AT.blast cp AT.gff mcscan/AT.gff MCScanX查找共线性： MCScanX mcscan/AT 得到的结果是整个基因组的结果：\ntext\n-rwxrwxrwx 1 xiang xiang 17M Dec 6 23:59 sanqi.blast -rwxrwxrwx 1 xiang xiang 339K Dec 7 10:48 sanqi.collinearity # 基因组的所有大片段复制 -rwxrwxrwx 1 xiang xiang 1.7M Dec 7 10:47 sanqi.gff drwxrwxrwx 1 xiang xiang 4.0K Dec 7 10:48 sanqi.html -rwxrwxrwx 1 xiang xiang 39K Dec 7 10:48 sanqi.tandem # 基因组的所有串联重复 结果解读： 串联重复：当一行里面的两个基因都是感兴趣的基因家族基因的时候，就是需要的串联重复基因。\ntext\nPno01G001040.t1,Pno01G001042.t1 Pno01G001410.t1,Pno01G001412.t1 Pno01G001524.t1,Pno01G001525.t1 Pno01G001558.t1,Pno01G001560.t1 Pno01G001628.t1,Pno01G001629.t1 大片段复制：当一行里面的两个基因都是感兴趣的基因家族基因的时候，就是需要的大片段复制基因。\ntext\n############### Parameters ############### # MATCH_SCORE: 50 # MATCH_SIZE: 5 # GAP_PENALTY: -1 # OVERLAP_WINDOW: 5 # E_VALUE: 1e-05 # MAX GAPS: 25 ############### Statistics ############### # Number of collinear genes: 10371, Percentage: 21.66 # Number of all genes: 47870 ########################################## ## Alignment 0: score=269.0 e_value=4.6e-10 N=6 1\u0026amp;1 plus 0- 0: Pno01G005483.t1 Pno01G005033.t2 8e-54 0- 1: Pno01G005544.t1 Pno01G005040.t3 7e-159 0- 2: Pno01G005828.t1 Pno01G005055.t1 2e-103 0- 3: Pno01G005829.t1 Pno01G005058.t1 0 0- 4: Pno01G005897.t1 Pno01G005088.t1 1e-164 0- 5: Pno01G006072.t2 Pno01G005092.t1 1e-80 ## Alignment 1: score=362.0 e_value=2.8e-14 N=8 1\u0026amp;1 minus 1- 0: Pno01G000527.t2 Pno01G004765.t1 2e-75 1- 1: Pno01G000535.t1 Pno01G004763.t1 0 1- 2: Pno01G000542.t2 Pno01G004760.t2 4e-152 1- 3: Pno01G000545.t2 Pno01G004757.t1 7e-68 1- 4: Pno01G000558.t1 Pno01G004741.t6 8e-20 1- 5: Pno01G000568.t2 Pno01G004737.t2 4e-144 1- 6: Pno01G000599.t1 Pno01G004735.t1 2e-68 1- 7: Pno01G000636.t1 Pno01G004716.t1 1e-144 ## Alignment 2: score=290.0 e_value=3.9e-11 N=7 1\u0026amp;1 minus 2- 0: Pno01G006165.t1 Pno01G002002.t1 1e-23 2- 1: Pno01G006238.t1 Pno01G001895.t1 0 2- 2: Pno01G006400.t1 Pno01G001832.t2 3e-87 2- 3: Pno01G006416.t2 Pno01G001818.t1 3e-48 2- 4: Pno01G006555.t1 Pno01G001725.t1 2e-130 2- 5: Pno01G006745.t1 Pno01G001684.t1 2e-46 2- 6: Pno01G006864.t1 Pno01G001662.t1 0 找打目标基因家族中存在串联重复的基因： perl /biosoft/MCScanX/MCScanX/downstream_analyses/detect_collinearity_within_gene_families.pl -i WRKY_family.txt -d mcscan/AT.collinearity -o WRKY.collinear.pairs perl ../script/get_tandem_gene.pl -id gene_list.txt -tandem mcscan/AT.tandem -od ./ -name WRKY 基因加倍绘图： mkdir circos cd circos cp ../MCScanX/mcscan/AT.collinearity . cp ../MCScanX/WRKY.collinear.pairs . perl ../script/colline_v3.pl -gff ../MCScanX/AT.gff -list WRKY.collinear.pairs -colline AT.collinearity -od data -name WRKY cd data circos -conf config3.txt -outputdir ./ -outputfile WRKY 配置文件： chromosomes_units=1000000 #刻度单位Mb karyotype=./chr.info #染色体信息配置文件 show_tick_labels=yes show_ticks=yes spacing=10u \u0026lt;ticks\u0026gt; #设置染色体刻度 color=black format=%d multiplier=1e-6 radius=1r thickness=2p \u0026lt;tick\u0026gt; size=10p spacing=5u \u0026lt;/tick\u0026gt; \u0026lt;tick\u0026gt; color=black format=%d label_offset=10p label_size=25p show_label=yes size=15p spacing=25u thickness=4p \u0026lt;/tick\u0026gt; \u0026lt;/ticks\u0026gt; \u0026lt;ideogram\u0026gt; #染色体绘制设置 fill=yes #是否填充颜色 label_font=default label_parallel=yes label_radius=dims(image,radius)-60p label_size=45 radius=0.8r #设置半径，以免基因名称过长超出显示范围 show_label=yes \u0026lt;spacing\u0026gt; default=0.005r \u0026lt;/spacing\u0026gt; stroke_color=dgrey stroke_thickness=2p thickness=0.03r \u0026lt;/ideogram\u0026gt; \u0026lt;links\u0026gt; #设置连线 bezier_radius=0r bezier_radius_purity=0.75 color=black crest=0.5 \u0026lt;link\u0026gt; #基因家族共线性 bezier_radius=0r bezier_radius_purity=0.75 color=set2-8-qual-1 crest=0.5 file=./nlr.link.txt #输入文件 radius=0.98r \u0026lt;rules\u0026gt; \u0026lt;rule\u0026gt; color=red condition=var(intrachr) \u0026lt;/rule\u0026gt; \u0026lt;rule\u0026gt; color=red condition=var(interchr) \u0026lt;/rule\u0026gt; \u0026lt;/rules\u0026gt; thickness=8 z=20 #层数 \u0026lt;/link\u0026gt; \u0026lt;link\u0026gt; #全基因组共线性 bezier_radius=0r bezier_radius_purity=0.75 color=230,230,230,0.2 crest=0.5 ribbon=yes file=./genome.blocklink.txt #输入文件 radius=0.98r thickness=1 z=15 \u0026lt;/link\u0026gt; radius=0.40r thickness=1 \u0026lt;/links\u0026gt; \u0026lt;plots\u0026gt; \u0026lt;plot\u0026gt; color=black label_snuggle=yes #如多个文本文字距离过近，避免重叠 参考：https://www.omicsclass.com/article/678 file=./nlr.text.txt #输入文件 label_font=condensed label_size=24p link_color=red link_dims=10p,10p,50p,20p,10p link_thickness=2p r0=1r r1=1r+500p rpadding=0p padding=0p show_links=yes type=text \u0026lt;/plot\u0026gt; type=histogram \u0026lt;/plots\u0026gt; \u0026lt;colors\u0026gt; \u0026lt;\u0026lt;include etc/colors.conf\u0026gt;\u0026gt; \u0026lt;\u0026lt;include etc/brewer.conf\u0026gt;\u0026gt; #\u0026lt;\u0026lt;include etc/colors_fonts_patterns.conf\u0026gt;\u0026gt; #\u0026lt;\u0026lt;include colors.ucsc.conf\u0026gt;\u0026gt; #\u0026lt;\u0026lt;include colors.hsv.conf\u0026gt;\u0026gt; \u0026lt;/colors\u0026gt; \u0026lt;fonts\u0026gt; \u0026lt;\u0026lt;include etc/fonts.conf\u0026gt;\u0026gt; \u0026lt;/fonts\u0026gt; \u0026lt;image\u0026gt; \u0026lt;\u0026lt;include etc/image.conf\u0026gt;\u0026gt; \u0026lt;/image\u0026gt; \u0026lt;\u0026lt;include etc/housekeeping.conf\u0026gt;\u0026gt; 软件JCVI：https://github.com/lixiang117423/jcvi\n","permalink":"https://Tdxxxx-student.github.io/posts/%E5%9F%BA%E5%9B%A0%E5%AE%B6%E6%97%8F%E5%88%86%E6%9E%90/","summary":"\u003ch1 id=\"基因家族分析流程与文章撰写思路\"\u003e基因家族分析流程与文章撰写思路\u003c/h1\u003e\n\u003cp\u003e基因家族分析是一种常见的生物信息学分析套路，也是生物信息学数据挖掘发表小文章常用的分析方法，和GEO挖掘等类似。基因家族的分析鉴定可以用pfam上的hmm文件进行基因家族的检索鉴定，也可以用blast的方法进行比对鉴定，通常是适用拟南芥对应的基因家族进行比对鉴定。\u003c/p\u003e\n\u003cp\u003e植物转录因子数据库，点击访问。\u003c/p\u003e\n\u003ch2 id=\"基因家族分析思路及文章撰写思路\"\u003e基因家族分析思路及文章撰写思路\u003c/h2\u003e\n\u003cp\u003e基因家族分析是继GEO数据挖掘后，一种新的生物信息学挖掘策略。\u003c/p\u003e\n\u003cp\u003e如何做基因家族研究，可以参考这个帖子：\u003ca href=\"http://www.planttech.com.cn/blog/58882464a46\"\u003ehttp://www.planttech.com.cn/blog/58882464a46\u003c/a\u003e。\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"数据准备\"\u003e数据准备\u003c/h2\u003e\n\u003cp\u003e需要准备的数据主要是参考基因组数据，包括fasta格式的序列文件、gff或gtf格式的基因组注释文件、蛋白质序列文件（通常是每个转录本的蛋白序列）、cDNA序列等文件。如果有转录组数据的话进行对应的转录组分析即可。除开上述这些文件外，还需要适用的文件还有.hmm格式的文件。\u003c/p\u003e\n\u003ch2 id=\"软件准备\"\u003e软件准备\u003c/h2\u003e\n\u003cp\u003e只需要会使用Linux系统，会安装Docker即可，然后下载组学大讲堂的镜像即可。点击浏览镜像地址。Docker的安装适用方法参考@ref(WSL4Docker)。\u003c/p\u003e\n\u003chr\u003e\n\u003ch2 id=\"分析过程\"\u003e分析过程\u003c/h2\u003e\n\u003ch3 id=\"mrna_id与基因id的提取\"\u003emRNA_ID与基因ID的提取\u003c/h3\u003e\n\u003cp\u003e由于一个基因会对应多个转录本，因此一个基因下会对应多个mRNA的编号。在后续的分析中，每个基因只需要选择一个转录本的编号进行分析即可，因为每个基因不同的转录本的序列差异是较小的。提取的代码：\u003c/p\u003e\n\u003cp\u003ebash\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eperl code/script/mRNAid_to_geneid.pl data/unzip_data/*.gff* results/step.1.get.mRNA.and.gene.ID/mRNA2geneID.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eperl code/script/geneid_to_mRNAid.pl data/unzip_data/*.gff* results/step.1.get.mRNA.and.gene.ID/geneID2mRNAid.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"检索结构域\"\u003e检索结构域\u003c/h3\u003e\n\u003cp\u003e这一步主要是以.hmm文件为基础检索该物种蛋白序列中含有该结构域的序列。输入文件包括.hmm文件和蛋白文件，输出hmmsearch的检索结果。其中用于后续筛选的是evalue这个参数，部分文章以0.001为阈值。of那一列表示的是某个基因对应的这个结构域有几个。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehmmsearch --domtblout results/step.2.domain.search/hmm.txt --cut_tc data/unzip_data/*.hmm data/unzip_data/*.pep*\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"选择结构域\"\u003e选择结构域\u003c/h3\u003e\n\u003cp\u003e由于一个基因的单个转录本可能会比对到多个结构域，因此需要对比对到的结构域进行选择。默认选择的是第一个结构域。下面代码的最后一个参数是hmmsearch输出文件里面的E-value,如果需要全部的第一个结构域，将阈值设置为1即可。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eperl code/script/domain_xulie.pl results/step.2.domain.search/hmm.txt data/unzip_data/*.pep* results/step.2.domain.search/domain.fa 1.2e-28\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"多序列比对\"\u003e多序列比对\u003c/h3\u003e\n\u003cp\u003e之所以要进行多序列比对，是因为下载的.hmm文件是来自很多物种的这个结构域组成的隐马尔科夫模型，进行多序列比对后将该物种检索到的结构域序列进行比对，再次构建该物种该基因家族的隐马尔科夫模型，会更加准确。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;1\\nresults/step.2.domain.search/domain.fa\\n2\\n1\\nresults/step.2.domain.search/out.aln\\nr.domain.search/out.dnd\\nX\\n\\n\\nX\\n\u0026#39;\u003c/span\u003e |clustalw\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"重构隐马尔科夫模型\"\u003e重构隐马尔科夫模型\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehmmbuild results/step.2.domain.search/new.hmm results/step.2.domain.search/out.aln\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"重新进行检索\"\u003e重新进行检索\u003c/h3\u003e\n\u003cp\u003e利用构建得到的新的隐马尔科夫模型重新进行检索结构域。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehmmsearch --domtblout results/step.2.domain.search/new.out.txt --cut_tc results/step.2.domain.search/new.hmm data/unzip_data/*.pep*\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"筛选输出结果\"\u003e筛选输出结果\u003c/h3\u003e\n\u003cp\u003e对重新检索后的结果进行筛选，也是对E-value进行筛选。\u003c/p\u003e\n\u003cp\u003ebash\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003egrep -v \u0026#34;^#\u0026#34; results/step.2.domain.search/new.out.txt|awk \u0026#39;$7\u0026lt;0.001 {print}\u0026#39; \u0026gt; results/step.2.domain.search/domain.new.out.selected.txt\n\u003c/code\u003e\u003c/pre\u003e\u003ch3 id=\"去除重复的id\"\u003e去除重复的ID\u003c/h3\u003e\n\u003cp\u003e上一步筛选得到的是该种中哪些基因是潜在的目标基因家族成员，而一个基因对应了多个mRNA，因此，只需要在筛选后的每个基因中选择一个具有代表性的mRNA进行后续的分析即可。这个提取唯一ID的步骤需要手动完成（PS：手动完成也很快）。手动挑选完mRNA的ID放在第一列，另存为文件uniqueID.txt。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-shell\" data-lang=\"shell\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eperl code/script/select_redundant_mRNA.pl results/step.1.get.mRNA.and.gene.ID/mRNA2geneID.txt results/step.2.domain.search/domain.new.out.selected.txt results/step.2.domain.search/remove_redundant_IDlist.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"提取蛋白序列\"\u003e提取蛋白序列\u003c/h3\u003e\n\u003cp\u003e在得到基因ID后需要提取蛋白序列进行后续的分析。在SMART或者Pfam或NCBI CDD确认这些基因是真真正正含有该结构域，没有的基因要剔除！在SMART中没有检索到结构域的基因在gene.not.in.SMART.txt中；在Pfam中全都是WRKY结构域，对应文件为Pfam.results.txt。\u003c/p\u003e","title":"基因家族分析"},{"content":"分子层面对生物的研究，在个体水平上主要是看单个基因的变化以及全转录本的变化（RNA-seq）；在对个体的研究的基础上，开始了群体水平的研究。如果说常规的遗传学主要的研究对象是个体或者个体家系的话，那么群体遗传学则是主要研究由不同个体组成的群体的遗传规律。 在测序技术大力发展之前，对群体主要是依靠表型进行研究，如加拉巴哥群岛的13中鸟雀有着不同的喙，达尔文认为这是自然选择造成的后果1。达尔文的进化论对应的观点可以简单概括为“物竞天择，适者生存”，这也是最为大众所接受的一种进化学说。直到1968年，日本遗传学家提出了中性进化理论[2]，也叫中性演化理论。中性理论的提出很大程度上是基于分子生物化学的发展。可以这样理解中性理论：一群人抽奖，在没有内幕的情况下，每个人抽到一等奖的概率是相等的，这个可能性和参与抽奖的人的身高、年龄、爱好等因素都没有关系。中性理论常作为群体遗传研究中的假设理论（CK）来计算其他各种统计指标。 群体遗传学，研究的单位是群体，比如粳稻、籼稻、野生稻，就能够构成不同的群体；我们国内的各省份的水稻也可以作为一个个群体。 群体遗传学大概可以分为群体内的研究和群体间的研究。比如研究云南元阳的水稻的遗传多样性；如果研究是的云南元阳的水稻和东北的水稻，那就可以算成是群体间的研究。群体间和群体内的研究是相互的。 测序价格的急剧下降[3]使得大规模的群体测序得以实现。\n几种变异类型 常见的变异类型有SNP、IdDel、SV、CNV等。重测序中最关注的是SNP，其次是InDel。其他的几种结构变异的研究不是太多。\n重测序和从头组装 有参考基因组的物种的全基因组测序叫做重测序，没有参考基因组的物种的全基因组测序则需要从头组装。随着测序价格的降低，越来越多物种的参考基因组都已经测序组装完成。plant genomes$^{[4]}$网站实时显示全基因组测序已经完成的植物，其中2012年以后爆发式增长。在群体遗传学研究中更多的是有参考基因组的物种，尤其是模式物种，植物中常见的是拟南芥、水稻和玉米。\n重测序分析流程 主要的分析流程见下图。现在的测序公司基本上都会帮客户完成整个的分析流程，因为主要耗费的资源是计算资源。我认为在整个分析的流程中最重要的是Linux目录的构建，混乱的目录会导致后续的分析频频出问题，重测序分析会生成很多的中间文件，良好的目录管理会使得项目分析流程井然有序。 该部分涉及到的软件的安装和基础的Linux基础知识就不详细说明了。\n群体进化选择 正选择 正选择似乎可以更好地用自然选择来解释。就是一个基因or位点能够使个体有着更强的生存力或者是育性，这样就会使得这个个体的后代更多，如此一来，这个基因or位点在群体中就越来越多。\n正选择能够使有利的突变基因or位点在群体中得到传播，但是与此同时却降低了群体的多态性水平。也就是说原先该位点周围的核苷酸组成是多样性的，在经过正选择之后，这个位点周围核苷酸的多样性就渐渐的趋于同质化了。这就好比一块田，里面本来有水稻和稗草及其他杂草，由于稗草的适应性增强，稗草在逐渐增多，水稻慢慢变少，最后甚至是只剩下了稗草。 我们将这种选择之后多态性降低的情况叫做选择扫荡（Selective Sweep)。检测选择扫荡的软件有SweeD$^{[7]}$。选择扫荡有可能是人工选择的结果，如2014年 Nature Genetics关于非洲栽培稻的文章就使用了SweeD来检测非洲栽培稻基因组上受人工选择的区域$^{[8]}$。\n负选择 负选择和正选择刚好是相反的。简单理解成群体中的某个个体出现了一个致命的突变，从而自己或者是后代从群体中被淘汰。这也导致群体中该位点的多态性的降低。就好比我有10株水稻，其中一株在成长过程中突然不见了，那么对我的这个小的水稻群体来说，这个消失的水稻的独有的位点在群体中就不见了，整体的多态性就降低了。\n平衡选择 平衡选择指多个等位基因在一个群体的基因库中以高于遗传漂变预期的频率被保留，如杂合子优势。\n平衡选择检测的算法有BetaScan2$^{[10]}$，这是个Python脚本，输入文件只需要过滤好的SNP数据即可。\n群体遗传学中的统计指标 群体多态性参数 计算公式为：\n其中$N_e$是有效群体大小，$\\mu$是每个位点的突变速率。但是群体大小往往是无法精确知道的，需要对其进行估计。\n分离位点数目 分离位点数$\\theta_w$是$\\theta$的估计值，表示相关基因在多序列比对中表现出多态性的位置。计算公式为：\n其中$K$为分离位点数量，比如SNP数量。 $a_n$为个体数量的倒数和：\n核苷酸多样性$\\pi$ $\\pi$指的是核苷酸多样性，值越大说明核苷酸多样性越高。通常用于衡量群体内的核苷酸多样性，也可以用来推演进化关系$^{[11]}$。计算公式为：\n可以理解成现在群体内两两求$\\pi$，再计算群体的均值。计算的软件最常见的是vcftools，也有对应的R包PopGenome。通常是选定有一定的基因组区域，设定好窗口大小，然后滑动窗口进行计算。 3KRGP文章就计算了水稻不同亚群间4号染色体部分区域上的$\\pi$值$^{[12]}$，能够看出控制水稻籽粒落粒性的基因Sh4$^{[13]}$位置多态性在所有的亚群中都降低了。说明这个基因在所有的亚群中都是受到选择的，这可能是人工选择的结果。\n群体内选择检验：Tajima’s D Tajima’s D是日本学者Tajima Fumio 1989年提出的一种统计检验方法，用于检验DNA序列在演化过程中是否遵循中性演化模型$^{[14]}$。计算公式为：\nD值大小有如下三种生物学意义：\n群体间分歧度检验：$F_{st}$ $F_{st}$叫固定分化指数，用于估计亚群间平均多态性大小与整个种群平均多态性大小的差异，反映的是群体结构的变化。其简单估计的计算公式为：\n$F*{st}$的取值范围是[0,1]。当$F*{st}=1$时，表明亚群间有着明显的种群分化。 在中性进化条件下，$F*{st}$的大小主要取决于遗传漂变和迁移等因素的影响。假设种群中的某个等位基因因为对特定的生境的适应度较高而经历适应性选择，那该基因的频率在种群中会升高，种群的分化水平增大，使得种群有着较高的$F*{st}$值。 $F*{st}$值可以和GWAS的结果一起进行分析，$F*{st}$超过一定阈值的区域往往和GWAS筛选到的位点是一致的，如2018年棉花重测序的文章$^{[15]}$：\n群体分歧度检验：ROD ROD可以基于野生群体和驯化群体间核苷酸多态性参数$\\pi$的差异识别选择型号，也可以测量驯化群体和野生型群体相比损失的多态性。计算公式为：\n和$F_{st}$一样，ROD也可以和GWAS结合起来：\n群体结构分析 群体结构分析可以简单理解成采样测序的这些个体可以分成几个小组，以及给每个个体之间的远近关系是怎么样的。群体结构分析三剑客， 分别是进化树、PCA和群体结构图。\n进化树 进化树就是将个体按照远近关系分别连接起来的图。\n进化树算法 基于距离 非加权算术平均对群法UPGMA 邻接法Neighbor-joining 基于特征 最大简约法—最小变化数（祖先状态最小化） 最大似然法—所有枝长和模型参数最优化 贝叶斯推断—基于后验概率 进化树类型 有根树 有根树就是所有的个体都有一个共同的祖先。就像这样的： 无根树 无根树只展示个体间的距离，无共同祖先，就像这样的： 进化树软件 常用的绘图软件是Phylip和Snpphylo。进化树修饰的软件有MEGA，ggtree等，推荐网页版工具iTOL，无比强大。 外群定根法：当群体的个体的差异很小时，可以引入其他物种作为根。如在对三叶草建树时可以引入水稻的序列作为根进行建树。\nPCA图 PCA是很常见的降维方法，如微生物研究中常用来检验样品分群情况。PCA计算的软件很多，plink可以直接用vcf文件计算PCA，R语言也可以进行PCA计算。\nPCA图在群体重测序中有如下几种作用：\n查看分群信息，就是测序的样品大概分成几个群。如2015年大豆重测序文章的图[17]: 检测离群样本 离群样本就是在PCA图看起来和其他样本差异很大的样本，有可能是这个样本的遗传背景和其他样本本来就很大，也有可能是样本混淆了，比如了将野生型的样本标记成了驯化种进行测序。如果有离群样本，那在后续的类似于GWAS的分析中就需要将离群样本进行剔除。当然如果样本本来就是个很特别的，那就另当别论。 推断亚群进化关系 可以从PCA图可以看出群体的进化关系，尤其是地理位置的进化关系。 群体分层图 进化树和PCA能够看出来群体是不是分层的，但是无法知道群体分成几个群合适，也无法看出群体间的基因交流，更无法看出个体的混血程度。这时候就需要群体分层图了。\n群体分层图的本质是堆叠的柱状图，和微生物研究中的物种组成柱状图类似。每个柱子是一个样本，可以看出一个样本的血缘组成，有几种颜色就说明该样本由几个祖先而来，如果只有一个色，那就说明这个个体很纯。 常用的软件有structure和ADMIXTURE$^{[19]}$。两款软件给出的结果都是$K$值。一般选择最低的点为最终的$K$值。\n群体分层图的可视化有个极强大的R包：Pophelper$^{[20]}$。\n其他 可以将进化树和群体分层图结合进行展示，如下图：\n连锁不平衡分析 先了解下概念，此处借鉴基迪奥生物网站的解释[22]。 要理解 LD 衰减图，我们就必须先理解连锁不平衡（Linkage disequilibrium，LD）的概念。连锁不平衡是由两个名词构成，连锁 + 不平衡。前者，很容易让我们产生概念混淆；后者，让这个概念变得愈加晦涩。因此从一个类似的概念入手，大家可能更容易理解 LD 的概念，那就是基因的共表达。 基因的共表达，通常指的是两个基因的表达量呈现相关性。比较常见的例子就是：转录组因子和靶基因间的关系。因为转录因子对它的靶基因有正调控作用，所以转录因子的表达量提高会导致靶基因的表达量也上调，两者往往存在正相关关系。这个正相关关系，可以使用相关系数 $r^2$ 来度量，这个数值在 - 1~1 之间。总而言之，相关性可以理解为两个元素共同变化，步调一致。 类似的，连锁不平衡（LD）就是度量两个分子标记的基因型变化是否步调一致，存在相关性的指标。如果两个 SNP 标记位置相邻，那么在群体中也会呈现基因型步调一致的情况。比如有两个基因座，分别对应 A/a 和 B/b 两种等位基因。如果两个基因座是相关的，我们将会看到某些基因型往往共同遗传，即某些单倍型的频率会高于期望值。 参照王荣焕等$^{[23]}$的方法进行LD参数计算：\nLD衰减分析 随着标记间的距离增加，平均的LD程度将降低，呈现出衰减状态，这种情况叫LD衰减。LD衰减分析的作用：\n判断群体的多样性差异，一般野生型群体的LD衰减快于驯化群体； 估计GWAS中标记的覆盖度，通过比较LD衰减距离(0.1)和标记间的平均距离来判断标记是否足够。 GWAS GWAS(genome-wide association study)，全基因组关联分析，常用在医学和农学领域。简单理解成将SNP等遗传标记和表型数据进行关联分析，检测和表型相关的位点，然后再倒回去找到对应的基因，研究其对表型的影响。这些被研究的表型在医学上常常是疾病的表型；在农学上常常是受关注的农艺性状，比如水稻的株高、产量、穗粒数等。GWAS思想首次提出是在心肌梗塞的治疗上[24]，首次应用是在2005年的文章上$^{[25]}$。\nGWAS流程 样品准备就是要收集不同的个体，比如3KRGP就3000多个水稻材料[12]，然后对这些材料进行全基因组测序，还需要表型数据，比如水稻的株高、产量等。 基因型的检测就是前面的变异检测，只是变异检测完的SNP数据还需要过滤才能进行后续的关联分析。 关联分析这一步只需要将基因型数据和表型数据丢给软件就行了。 GWAS数学模型 目前使用最广泛的模型是混合线性模型$^{[26]}$：\n所有的参数软件（如Emmax）会自动完成计算。\nGWAS结果 GWAS结果文件通常只有两个图，一个是曼哈顿图，另外一个是Q-Q图。一般是先看Q-Q图，如果Q-Q正常，曼哈顿图的结果才有意义。\nQ-Q图 用于推断关联分析使用的模型是否正确，如下图： 如果模型不正确，那就只能换算法或者软件。 曼哈顿图 之所以叫曼哈顿图，是由于这种图长得像曼哈顿： 图中横着的虚线通常是研究者设定的，最严格的的阈值线是Bonfferonin($\\frac{0.05}{total{SNPs}}$)。阈值线以上的点就是很值得关注的位点。 后续就是验证实验了，比如验证不同的单倍型的生物学功能。 其他统计指标和算法 MSMC MSMC（multiple sequentially Markovian coalescent）$^{[27]}$，底层算法很复杂，类似于PSMC。MSMC的主要功能是推断有效群体大小和群体分离历史。\n这样看起来更直观：\nLAMP LAMP(Local Ancestry in Admixed Populations，混杂群体的局部族源推断)，用于推断采用聚类的方法假设同时检测的位点间不存在重组情况，对每组相邻的 SNP 进行检测分析$^{[28]}$，在运算速度和推断准确度上都有了质的飞跃。\nTreemix 用于推断群体分离和混合[29]。图是这样的：\n这种图和进化树长得特别相似，可以将得到的结果和进化树进行比较。如2019年NC上关于Cushion willow的文章中就用到了这种算法根据。图是这样的：\n前文提到的很多软件和算法都是用来推断群体进化的，也就是找到群体的祖先。都可以看成族源推断。具体的差异可以参考综述法医族源推断的分子生物学进展$^{[31]}$。\n群体重测序方案推荐 测序方案关系到后续的分析，不同的样本量对应不同的测序方法和分析方法。\n参考文献 [1]. 自然选择(维基百科) [2]. Kimura, Motoo. “Evolutionary rate at the molecular level.” Nature. 217.5129 (1968): 624-626 . [3]. 测序价格变化趋势 [4]. plant genomes [5]. DePristo, Mark A., et al. “A framework for variation discovery and genotyping using next-generation DNA sequencing data.” Nature Genetics. 43.5 (2011): 491. [6]. Biswas, Shameek, and Joshua M. Akey. “Genomic insights into positive selection.” TRENDS in Genetics . 22.8 (2006): 437-446. [7]. Pavlidis, Pavlos, et al. “Sweed: likelihood-based detection of selective sweeps in thousands of genomes.” Molecular biology and evolution 30.9 (2013): 2224-2234. [8]. Wang, Muhua, et al. “The genome sequence of African rice (Oryza glaberrima) and evidence for independent domestication.” Nature Genetics 46.9 (2014): 982. [9]. Bamshad, Michael, and Stephen P. Wooding. “Signatures of natural selection in the human genome.” Nature Reviews Genetics 4.2 (2003): 99. [10]. Siewert, Katherine M., and Benjamin F. Voight. “BetaScan2: Standardized statistics to detect balancing selection utilizing substitution data.” BioRxiv (2018): 497255. [11]. Yu, N.; Jensen-Seaman MI; Chemnick L; Ryder O; Li WH (March 2004). Genetics. 166 (3): 1375–83. [12]. Wang, Wensheng, et al. “Genomic variation in 3,010 diverse accessions of Asian cultivated rice.” Nature 557.7703 (2018): 43. [13]. Li, C., Zhou, A. \u0026amp; Sang, T. Rice domestication by reducing shattering. Science 311, 1936–1939 (2006). [14]. Tajima, Fumio. “Statistical method for testing the neutral mutation hypothesis by DNA polymorphism.” Genetics 123.3 (1989): 585-595. [15]. Du, Xiongming, et al. “Resequencing of 243 diploid cotton accessions based on an updated A genome identifies the genetic basis of key agronomic traits.” Nature Genetics 50.6 (2018): 796. [16]. Lu, Kun, et al. “Whole-genome resequencing reveals Brassica napus origin and genetic loci involved in its improvement.” Nature communications. 10.1 (2019): 1154. [17]. Zhou, Z., Jiang, Y., Wang, Z. et al. Resequencing 302 wild and cultivated accessions identifies genes related to domestication and improvement in soybean. Nat Biotechnol 33, 408–414 (2015). [18]. Liang, Z., Duan, S., Sheng, J. et al. Whole-genome resequencing of 472 Vitis accessions for grapevine diversity and demographic history analyses. Nat Commun 10, 1190 (2019). [19]. Alexander, D.H., Lange, K. Enhancements to the ADMIXTURE algorithm for individual ancestry estimation. BMC Bioinformatics 12, 246 (2011). [20]. Francis, Roy M. “pophelper: an R package and web app to analyse and visualize population structure.” Molecular ecology resources 17.1 (2017): 27-32. [21]. http://www.royfrancis.com/pophelper/articles/index.html. [22]. https://www.omicshare.com/forum/thread-878-1-1.html. [23]. WANG Rong-Huan, WANG Tian-Yu, LI Yu. Linkage disequilibrium in plant genomes[J]. HEREDITAS, 2007, 29(11): 1317-1323. [24]. Ozaki, K., Ohnishi, Y., Iida, A. et al. Functional SNPs in the lymphotoxin-α gene that are associated with susceptibility to myocardial infarction. Nat Genet 32, 650–654 (2002). [25]. Klein, Robert J., et al. “Complement factor H polymorphism in age-related macular degeneration.” Science 308.5720 (2005): 385-389. [26]. Yu, Jianming, et al. “A unified mixed-model method for association mapping that accounts for multiple levels of relatedness.” Nature genetics 38.2 (2006): 203. [27]. Schiffels, Stephan, and Richard Durbin. “Inferring human population size and separation history from multiple genome sequences.” Nature genetics 46.8 (2014): 919. [28]. Sankararaman, Sriram, et al. “Estimating local ancestry in admixed populations.” The American Journal of Human Genetics 82.2 (2008): 290-303. [29]. Pickrell, Joseph K., and Jonathan K. Pritchard. “Inference of population splits and mixtures from genome-wide allele frequency data.” PLoS genetics 8.11 (2012): e1002967. [30]. Chen, Jia-hui, et al. “Genome-wide analysis of Cushion willow provides insights into alpine plant divergence in a biodiversity hotspot.” Nature communications 10.1 (2019): 1-12. [31]. 孙宽，侯一平。法医族源推断的分子生物学进展 [J]. 法医学杂志，2018,34 (03):286-293. [32]. genek.tv\n","permalink":"https://Tdxxxx-student.github.io/posts/%E7%BE%A4%E4%BD%93%E9%81%97%E4%BC%A0%E5%AD%A6%E4%B8%8E%E9%87%8D%E6%B5%8B%E5%BA%8F%E5%88%86%E6%9E%90%E8%A7%A3%E9%87%8A/","summary":"\u003cp\u003e分子层面对生物的研究，在个体水平上主要是看单个基因的变化以及全转录本的变化（RNA-seq）；在对个体的研究的基础上，开始了群体水平的研究。如果说常规的遗传学主要的研究对象是个体或者个体家系的话，那么群体遗传学则是主要研究由不同个体组成的群体的遗传规律。\n在测序技术大力发展之前，对群体主要是依靠表型进行研究，如加拉巴哥群岛的13中鸟雀有着不同的喙，达尔文认为这是自然选择造成的后果1。达尔文的进化论对应的观点可以简单概括为“物竞天择，适者生存”，这也是最为大众所接受的一种进化学说。直到1968年，日本遗传学家提出了中性进化理论[2]，也叫中性演化理论。中性理论的提出很大程度上是基于分子生物化学的发展。可以这样理解中性理论：一群人抽奖，在没有内幕的情况下，每个人抽到一等奖的概率是相等的，这个可能性和参与抽奖的人的身高、年龄、爱好等因素都没有关系。中性理论常作为群体遗传研究中的假设理论（CK）来计算其他各种统计指标。\n群体遗传学，研究的单位是群体，比如粳稻、籼稻、野生稻，就能够构成不同的群体；我们国内的各省份的水稻也可以作为一个个群体。 群体遗传学大概可以分为群体内的研究和群体间的研究。比如研究云南元阳的水稻的遗传多样性；如果研究是的云南元阳的水稻和东北的水稻，那就可以算成是群体间的研究。群体间和群体内的研究是相互的。\n测序价格的急剧下降[3]使得大规模的群体测序得以实现。\u003c/p\u003e\n\u003chr\u003e\n\u003ch1 id=\"几种变异类型\"\u003e几种变异类型\u003c/h1\u003e\n\u003cp\u003e常见的变异类型有SNP、IdDel、SV、CNV等。重测序中最关注的是SNP，其次是InDel。其他的几种结构变异的研究不是太多。\u003c/p\u003e\n\u003ch1 id=\"重测序和从头组装\"\u003e重测序和从头组装\u003c/h1\u003e\n\u003cp\u003e有参考基因组的物种的全基因组测序叫做重测序，没有参考基因组的物种的全基因组测序则需要从头组装。随着测序价格的降低，越来越多物种的参考基因组都已经测序组装完成。\u003cem\u003eplant genomes\u003c/em\u003e$^{[4]}$网站实时显示全基因组测序已经完成的植物，其中2012年以后爆发式增长。在群体遗传学研究中更多的是有参考基因组的物种，尤其是模式物种，植物中常见的是拟南芥、水稻和玉米。\u003c/p\u003e\n\u003ch1 id=\"重测序分析流程\"\u003e重测序分析流程\u003c/h1\u003e\n\u003cp\u003e主要的分析流程见下图。现在的测序公司基本上都会帮客户完成整个的分析流程，因为主要耗费的资源是计算资源。我认为在整个分析的流程中最重要的是Linux目录的构建，混乱的目录会导致后续的分析频频出问题，重测序分析会生成很多的中间文件，良好的目录管理会使得项目分析流程井然有序。\n该部分涉及到的软件的安装和基础的Linux基础知识就不详细说明了。\u003c/p\u003e\n\u003ch1 id=\"群体进化选择\"\u003e群体进化选择\u003c/h1\u003e\n\u003ch2 id=\"正选择\"\u003e正选择\u003c/h2\u003e\n\u003cp\u003e正选择似乎可以更好地用自然选择来解释。就是一个基因or位点能够使个体有着更强的生存力或者是育性，这样就会使得这个个体的后代更多，如此一来，这个基因or位点在群体中就越来越多。\u003c/p\u003e\n\u003cp\u003e正选择能够使有利的突变基因or位点在群体中得到传播，但是与此同时却降低了群体的多态性水平。也就是说原先该位点周围的核苷酸组成是多样性的，在经过正选择之后，这个位点周围核苷酸的多样性就渐渐的趋于同质化了。这就好比一块田，里面本来有水稻和稗草及其他杂草，由于稗草的适应性增强，稗草在逐渐增多，水稻慢慢变少，最后甚至是只剩下了稗草。\n我们将这种选择之后多态性降低的情况叫做选择扫荡（Selective Sweep)。检测选择扫荡的软件有SweeD$^{[7]}$。选择扫荡有可能是人工选择的结果，如2014年 Nature Genetics关于非洲栽培稻的文章就使用了SweeD来检测非洲栽培稻基因组上受人工选择的区域$^{[8]}$。\u003c/p\u003e\n\u003ch2 id=\"负选择\"\u003e负选择\u003c/h2\u003e\n\u003cp\u003e负选择和正选择刚好是相反的。简单理解成群体中的某个个体出现了一个致命的突变，从而自己或者是后代从群体中被淘汰。这也导致群体中该位点的多态性的降低。就好比我有10株水稻，其中一株在成长过程中突然不见了，那么对我的这个小的水稻群体来说，这个消失的水稻的独有的位点在群体中就不见了，整体的多态性就降低了。\u003c/p\u003e\n\u003ch2 id=\"平衡选择\"\u003e平衡选择\u003c/h2\u003e\n\u003cp\u003e平衡选择指多个等位基因在一个群体的基因库中以高于遗传漂变预期的频率被保留，如杂合子优势。\u003c/p\u003e\n\u003cp\u003e平衡选择检测的算法有BetaScan2$^{[10]}$，这是个Python脚本，输入文件只需要过滤好的SNP数据即可。\u003c/p\u003e\n\u003chr\u003e\n\u003ch1 id=\"群体遗传学中的统计指标\"\u003e群体遗传学中的统计指标\u003c/h1\u003e\n\u003ch2 id=\"群体多态性参数\"\u003e群体多态性参数\u003c/h2\u003e\n\u003cp\u003e计算公式为：\u003c/p\u003e\n\u003cp\u003e其中$N_e$是有效群体大小，$\\mu$是每个位点的突变速率。\u003cem\u003e但是群体大小往往是无法精确知道的，需要对其进行估计。\u003c/em\u003e\u003c/p\u003e\n\u003ch2 id=\"分离位点数目\"\u003e分离位点数目\u003c/h2\u003e\n\u003cp\u003e分离位点数$\\theta_w$是$\\theta$的估计值，表示相关基因在多序列比对中表现出多态性的位置。计算公式为：\u003c/p\u003e\n\u003cp\u003e其中$K$为分离位点数量，比如SNP数量。\n$a_n$为个体数量的倒数和：\u003c/p\u003e\n\u003ch2 id=\"核苷酸多样性pi\"\u003e核苷酸多样性$\\pi$\u003c/h2\u003e\n\u003cp\u003e$\\pi$指的是核苷酸多样性，值越大说明核苷酸多样性越高。通常用于衡量群体内的核苷酸多样性，也可以用来推演进化关系$^{[11]}$。计算公式为：\u003c/p\u003e\n\u003cp\u003e可以理解成现在群体内两两求$\\pi$，再计算群体的均值。计算的软件最常见的是\u003cem\u003evcftools\u003c/em\u003e，也有对应的R包\u003cem\u003ePopGenome\u003c/em\u003e。通常是选定有一定的基因组区域，设定好窗口大小，然后滑动窗口进行计算。\n3KRGP文章就计算了水稻不同亚群间4号染色体部分区域上的$\\pi$值$^{[12]}$，能够看出控制水稻籽粒落粒性的基因\u003cem\u003eSh4\u003c/em\u003e$^{[13]}$位置多态性在所有的亚群中都降低了。说明这个基因在所有的亚群中都是受到选择的，这可能是人工选择的结果。\u003c/p\u003e\n\u003ch2 id=\"群体内选择检验tajimas-d\"\u003e群体内选择检验：Tajima’s D\u003c/h2\u003e\n\u003cp\u003eTajima’s D是日本学者Tajima Fumio 1989年提出的一种统计检验方法，用于检验DNA序列在演化过程中是否遵循中性演化模型$^{[14]}$。计算公式为：\u003c/p\u003e\n\u003cp\u003eD值大小有如下三种生物学意义：\u003c/p\u003e\n\u003ch2 id=\"群体间分歧度检验f_\"\u003e群体间分歧度检验：\u003cem\u003e$F_{st}$\u003c/em\u003e\u003c/h2\u003e\n\u003cp\u003e$F_{st}$叫固定分化指数，用于估计亚群间平均多态性大小与整个种群平均多态性大小的差异，反映的是群体结构的变化。其简单估计的计算公式为：\u003c/p\u003e\n\u003cp\u003e$F*{st}$的取值范围是[0,1]。当$F*{st}=1$时，表明亚群间有着明显的种群分化。\n在中性进化条件下，$F*{st}$的大小主要取决于遗传漂变和迁移等因素的影响。假设种群中的某个等位基因因为对特定的生境的适应度较高而经历适应性选择，那该基因的频率在种群中会升高，种群的分化水平增大，使得种群有着较高的$F*{st}$值。\n$F*{st}$值可以和GWAS的结果一起进行分析，$F*{st}$超过一定阈值的区域往往和GWAS筛选到的位点是一致的，如2018年棉花重测序的文章$^{[15]}$：\u003c/p\u003e\n\u003ch2 id=\"群体分歧度检验rod\"\u003e群体分歧度检验：ROD\u003c/h2\u003e\n\u003cp\u003eROD可以基于野生群体和驯化群体间核苷酸多态性参数$\\pi$的差异识别选择型号，也可以测量驯化群体和野生型群体相比损失的多态性。计算公式为：\u003c/p\u003e\n\u003cp\u003e和$F_{st}$一样，ROD也可以和GWAS结合起来：\u003c/p\u003e\n\u003ch1 id=\"群体结构分析\"\u003e群体结构分析\u003c/h1\u003e\n\u003cp\u003e群体结构分析可以简单理解成采样测序的这些个体可以分成几个小组，以及给每个个体之间的远近关系是怎么样的。群体结构分析三剑客， 分别是\u003cem\u003e进化树\u003c/em\u003e、\u003cem\u003ePCA\u003c/em\u003e和\u003cem\u003e群体结构图\u003c/em\u003e。\u003c/p\u003e\n\u003ch2 id=\"进化树\"\u003e进化树\u003c/h2\u003e\n\u003cp\u003e进化树就是将个体按照远近关系分别连接起来的图。\u003c/p\u003e\n\u003ch3 id=\"进化树算法\"\u003e进化树算法\u003c/h3\u003e\n\u003ch4 id=\"基于距离\"\u003e基于距离\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e非加权算术平均对群法UPGMA\u003c/li\u003e\n\u003cli\u003e邻接法Neighbor-joining\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4 id=\"基于特征\"\u003e基于特征\u003c/h4\u003e\n\u003cul\u003e\n\u003cli\u003e最大简约法—最小变化数（祖先状态最小化）\u003c/li\u003e\n\u003cli\u003e最大似然法—所有枝长和模型参数最优化\u003c/li\u003e\n\u003cli\u003e贝叶斯推断—基于后验概率\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"进化树类型\"\u003e进化树类型\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e有根树\n有根树就是所有的个体都有一个共同的祖先。就像这样的：\u003c/li\u003e\n\u003cli\u003e无根树\n无根树只展示个体间的距离，无共同祖先，就像这样的：\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"进化树软件\"\u003e进化树软件\u003c/h3\u003e\n\u003cp\u003e常用的绘图软件是\u003cem\u003ePhylip\u003c/em\u003e和\u003cem\u003eSnpphylo\u003c/em\u003e。进化树修饰的软件有\u003cem\u003eMEGA\u003c/em\u003e，\u003cem\u003eggtree\u003c/em\u003e等，推荐网页版工具\u003ca href=\"https://itol.embl.de/\"\u003eiTOL\u003c/a\u003e，无比强大。\n外群定根法：当群体的个体的差异很小时，可以引入其他物种作为根。如在对三叶草建树时可以引入水稻的序列作为根进行建树。\u003c/p\u003e","title":"群体遗传学与重测序分析解释"},{"content":"云南农业大学 云南生物资源保护与利用国家重点实验室\n李详 | 2019 年 12 月 31 日\n目录 软件安装 变异检测 群体结构分析 选择分析 GWAS 分析 QTL-seq 分析 附录：分析流程图 软件安装 ⚠️ 注意：该部分软件很难用 conda 直接安装，安装步骤比较特殊。\n1. lumpy-sv 💡 lumpy-sv 依赖 Python2.7，需切换到 py27 环境下进行安装。\nconda activate py27 git clone --recursive https://github.com/arq5x/lumpy-sv.git cd lumpy-sv make 2. svtyper conda install svtyper 3. cnvnator 💡 cnvnator 依赖于 root 软件包及 samtools 软件包（包含 HTSlib），因此先安装依赖。\n3.1 安装 samtools wget https://github.com/samtools/samtools/releases/download/1.9/samtools-1.9.tar.bz2 tar -xvf samtools-1.9.tar.bz2 cd samtools-1.9/ ./configure make 3.2 安装 root 软件 # 直接下载后解压即可 wget https://root.cern/download/root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz tar -zxvf root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz 3.3 安装 cnvnator git clone https://github.com/abyzovlab/CNVnator.git cd CNVnator # 链接samtools软件目录到cnvnator目录 ln -s ../samtools-1.9 ./samtools # 加载root软件到环境变量 export ROOTSYS=/pub/software/root export PATH=/pub/software/root/bin:$PATH export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$ROOTSYS/lib # 安装cnvnator make LIBS=\u0026#34;-lcrypto\u0026#34; 变异检测 1. 构建基因组 index # 创建软链接 ln -s ../data/genome.fasta ./genome.fasta # for gatk samtools faidx genome.fasta # for bwa bwa index genome.fasta # for picard picard CreateSequenceDictionary R=genome.fasta 2. 比对排序去重 2.1 比对排序 bwa mem -t 2 -R \u0026#39;@RG\\tID:S1\\tSM:S1\\tPL:illumina\u0026#39; \\ ../01.ref/genome.fasta \\ ../data/S1_1.fq.gz ../data/S1_2.fq.gz | \\ /pub/software/samtools/samtools sort -@ 2 -m 1G -o S1.sort.bam - bwa mem -t 2 -R \u0026#39;@RG\\tID:S2\\tSM:S2\\tPL:illumina\u0026#39; \\ ../01.ref/genome.fasta \\ ../data/S2_1.fq.gz ../data/S2_2.fq.gz | \\ /pub/software/samtools/samtools sort -@ 2 -m 1G -o S2.sort.bam - 2.2 去除重复 picard -Xmx4g MarkDuplicates \\ I=S1.sort.bam \\ O=S1.sort.rmdup.bam \\ CREATE_INDEX=true \\ REMOVE_DUPLICATES=true \\ M=S1.marked_dup_metrics.txt picard -Xmx4g MarkDuplicates \\ I=S2.sort.bam \\ O=S2.sort.rmdup.bam \\ CREATE_INDEX=true \\ REMOVE_DUPLICATES=true \\ M=S2.marked_dup_metrics.txt 2.3 比对率统计 /pub/software/samtools/samtools flagstat S1.sort.bam \u0026gt; S1.sort.bam.flagstat /pub/software/samtools/samtools flagstat S2.sort.bam \u0026gt; S2.sort.bam.flagstat 2.4 批量比对脚本生成 less ../data/sample.list | awk \u0026#39;{ print \u0026#34;bwa mem -t 2 -R \u0026#39;\\\u0026#39;\u0026#39;@RG\\\\tID:\u0026#34;$1\u0026#34;\\\\tSM:\u0026#34;$1\u0026#34;\\\\tPL:illumina\u0026#39;\\\u0026#39;\u0026#39; \\ ../01.ref/genome.fasta ../data/\u0026#34;$1\u0026#34;_1.fq.gz ../data/\u0026#34;$1\u0026#34;_2.fq.gz | \\ /pub/software/samtools/samtools sort -@ 2 -m 1G -o \u0026#34;$1\u0026#34;.sort.bam -\u0026#34; }\u0026#39; 3. SNP、Indel 检测 3.1 HaplotypeCaller gatk --java-options \u0026#34;-Xmx10g -Djava.io.tmpdir=./tmp\u0026#34; HaplotypeCaller \\ -R ../01.ref/genome.fasta \\ -I ../02.mapping/S1.sort.rmdup.bam \\ -ERC GVCF \\ -O S1.g.vcf 1\u0026gt;S1.HC.log 2\u0026gt;\u0026amp;1 gatk --java-options \u0026#34;-Xmx10g -Djava.io.tmpdir=./tmp\u0026#34; HaplotypeCaller \\ -R ../01.ref/genome.fasta \\ -I ../02.mapping/S2.sort.rmdup.bam \\ -ERC GVCF \\ -O S2.g.vcf 1\u0026gt;S2.HC.log 2\u0026gt;\u0026amp;1 3.2 CombineGVCFs ls ./S*.g.vcf \u0026gt; gvcf.list gatk --java-options \u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34; CombineGVCFs \\ -R ../01.ref/genome.fasta \\ -V gvcf.list \\ -O all.merge.g.vcf 3.3GenotpeGVCFs gatk --java-options \u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34; GenotypeGVCFs \\ -R ../01.ref/genome.fasta \\ --variant all.merge.g.vcf \\ -O all.merge_raw.vcf 3.4 SNP 过滤 # 提取SNP gatk --java-options \u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34; SelectVariants \\ -R ../01.ref/genome.fasta \\ -V all.merge_raw.vcf \\ --select-type SNP \\ -O all.raw.snp.vcf # 标记过滤 gatk --java-options \u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34; VariantFiltration \\ -R ../01.ref/genome.fasta \\ -V all.raw.snp.vcf \\ --filter-expression \u0026#34;QD \u0026lt; 2.0 || MQ \u0026lt; 40.0 || FS \u0026gt; 60.0 || SOR \u0026gt; 3.0 || MQRankSum \u0026lt; -12.5 || ReadPosRankSum \u0026lt; -8.0\u0026#34; \\ --filter-name \u0026#39;SNP_filter\u0026#39; \\ -O all.filter.snp.vcf # 提取过滤后的SNP gatk --java-options \u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34; SelectVariants \\ -R ../01.ref/genome.fasta \\ -V all.filter.snp.vcf \\ --exclude-filtered \\ -O all.filtered.snp.vcf 3.5 InDel 过滤 # 提取InDel gatk --java-options \u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34; SelectVariants \\ -R ../01.ref/genome.fasta \\ -V all.merge_raw.vcf \\ --select-type INDEL \\ -O all.raw.indel.vcf # 标记过滤 gatk --java-options \u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34; VariantFiltration \\ -R ../01.ref/genome.fasta \\ -V all.raw.indel.vcf \\ --filter-expression \u0026#34;QD \u0026lt; 2.0 || FS \u0026gt; 200.0 || SOR \u0026gt; 10.0 || MQRankSum \u0026lt; -12.5 || ReadPosRankSum \u0026lt; -8.0\u0026#34; \\ --filter-name \u0026#39;INDEL_filter\u0026#39; \\ -O all.filter.indel.vcf # 提取过滤后的InDel gatk --java-options \u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34; SelectVariants \\ -R ../01.ref/genome.fasta \\ -V all.filter.indel.vcf \\ --exclude-filtered \\ -O all.filtered.indel.vcf 4. SV 检测 # Step 1: 提取 discordants reads /pub/software/samtools/samtools view -b -F 1294 -@ 12 \\ ../02.mapping/S1.sort.rmdup.bam \u0026gt; S1.discordants.bam /pub/software/samtools/samtools view -b -F 1294 -@ 12 \\ ../02.mapping/S2.sort.rmdup.bam \u0026gt; S2.discordants.bam # Step 2: 提取 split reads /pub/software/samtools/samtools view -h ../02.mapping/S1.sort.rmdup.bam | \\ /pub/software/lumpy-sv/scripts/extractSplitReads_BwaMem -i stdin | \\ /pub/software/samtools/samtools sort - \u0026gt; S1.splitters.bam /pub/software/samtools/samtools view -h ../02.mapping/S2.sort.rmdup.bam | \\ /pub/software/lumpy-sv/scripts/extractSplitReads_BwaMem -i stdin | \\ /pub/software/samtools/samtools sort - \u0026gt; S2.splitters.bam # Step 3: 运行 lumpy /pub/software/lumpy-sv/bin/lumpyexpress \\ -B ../02.mapping/S1.sort.rmdup.bam,../02.mapping/S2.sort.rmdup.bam \\ -S S1.splitters.bam,S2.splitters.bam \\ -D S1.discordants.bam,S2.discordants.bam \\ -o all.sv.lumpy.vcf # Step 4: 个体基因型分型 vcftools --vcf all.sv.lumpy.vcf --indv S1 --recode --recode-INFO-all --out S1 \u0026amp;\u0026amp; \\ svtyper -i S1.recode.vcf -B ../02.mapping/S1.sort.rmdup.bam -o S1.genotype.vcf vcftools --vcf all.sv.lumpy.vcf --indv S2 --recode --recode-INFO-all --out S2 \u0026amp;\u0026amp; \\ svtyper -i S2.recode.vcf -B ../02.mapping/S2.sort.rmdup.bam -o S2.genotype.vcf 5. CNV 检测 5.1 准备基因组 # 将基因组拆分为单条染色体 ln -s ../data/genome.fasta ./genome.fa seqkit split -i ./genome.fa -O split # 重命名文件 ls ./split/genome.id_*.fa | sed \u0026#39;s/./split/genome.id_//\u0026#39; | \\ awk \u0026#39;{print \u0026#34;mv ./split/genome.id_\u0026#34;$aa\u0026#34; ./split/\u0026#34;$aa}\u0026#39; \u0026gt; mv_name.sh sh mv_name.sh 5.2 运行 cnvnator # 设置环境变量 export ROOTSYS=/pub/software/root export PATH=/pub/software/root/bin:$PATH export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$ROOTSYS/lib # 链接文件 ln -s ../02.mapping/S1.sort.rmdup.bam # 提取比对结果 /pub/software/CNVnator/cnvnator -genome genome.fa -root S1.root -tree S1.sort.rmdup.bam # 生成深度分布 /pub/software/CNVnator/cnvnator -genome genome.fa -root S1.root -his 500 -d split # 进行统计计算 /pub/software/CNVnator/cnvnator -root S1.root -stat 500 # 检查bin size是否合适 /pub/software/CNVnator/cnvnator -root S1.root -eval 500 \u0026gt; S1.eval.ratio # RD信号分割 /pub/software/CNVnator/cnvnator -root S1.root -partition 500 # 进行CNV检测 /pub/software/CNVnator/cnvnator -root S1.root -call 500 \u0026gt; S1.cnv 6. SNP/InDel 注释 6.1 准备注释数据库 ln -s ../data/genome.gtf ln -s ../data/genome.fasta gtfToGenePred -genePredExt genome.gtf genome_refGene.txt /pub/software/annovar/retrieve_seq_from_fasta.pl \\ --format refGene \\ --seqfile genome.fasta \\ genome_refGene.txt \\ --out genome_refGeneMrna.fa 6.2 注释 VCF 文件 ln -s ../03.SNP_indel/all.filtered.snp.vcf # 格式转换 /pub/software/annovar/convert2annovar.pl \\ -format vcf4old \\ all.filtered.snp.vcf \u0026gt; all.snp.vcf.annovar.input # 进行注释 /pub/software/annovar/annotate_variation.pl \\ -geneanno \\ --neargene 2000 \\ -buildver genome \\ -dbtype refGene \\ -outfile all.anno \\ -exonsort \\ all.snp.vcf.annovar.input ./ 7. CNV 和 SV 注释 # 处理SV文件 less -S ../04.SV/all.sv.lumpy.vcf | \\ awk -F \u0026#34;;\u0026#34; \u0026#39;{ if($1!~/#/){print $1\u0026#34;\\t\u0026#34;$2\u0026#34;\\t\u0026#34;$3\u0026#34;\\t\u0026#34;$4} }\u0026#39; | \\ awk \u0026#39;{print $1\u0026#34;\\t\u0026#34;$2\u0026#34;\\t\u0026#34;$11\u0026#34;\\t\u0026#34;$3\u0026#34;\\t\u0026#34;$8}\u0026#39; | \\ sed \u0026#39;s/END=//\u0026#39; | sed \u0026#39;s/SVTYPE=//\u0026#39; \u0026gt; SV.bed # 过滤BND类型 awk \u0026#39;$5 !~ /BND/\u0026#39; SV.bed \u0026gt; SV_filter.bed # SV注释 bedtools intersect -wo -a SV_filter.bed -b gene.gtf \u0026gt; SV_filter.Anno # 处理CNV文件 less -S ../05.CNV/S1.cnv | \\ awk \u0026#39;{print $2 \u0026#34;\\t\u0026#34; $1}\u0026#39; | \\ sed \u0026#39;s/:/\\t/\u0026#39; | sed \u0026#39;s/-/\\t/\u0026#39; \u0026gt; CNV.bed # CNV注释 bedtools intersect -wo -a CNV.bed -b gene.gtf \u0026gt; CNV.Anno 群体结构分析 1. 数据过滤 vcf=../data/all.vcf # 过滤缺失率和最小等位基因频率 plink --vcf $vcf \\ --geno 0.1 \\ --maf 0.01 \\ --out all.missing_maf \\ --recode vcf-iid \\ --allow-extra-chr \\ --set-missing-var-ids @:# \\ --keep-allele-order # 过滤连锁不平衡 plink --vcf all.missing_maf.vcf \\ --indep-pairwise 50 10 0.2 \\ --out tmp.ld \\ --allow-extra-chr \\ --set-missing-var-ids @:# plink --vcf all.missing_maf.vcf \\ --make-bed \\ --extract tmp.ld.prune.in \\ --out all.LDfilter \\ --recode vcf-iid \\ --keep-allele-order \\ --allow-extra-chr \\ --set-missing-var-ids @:# 2. 建树分析 2.1 NJ 树 # 格式转换 perl ../../script/vcf2phy.pl ../../00.filter/all.LDfilter.vcf \u0026gt; sequences.dat # 计算遗传距离 echo -e \u0026#34;sequences.dat\\nY\u0026#34; \u0026gt; dnadist.cfg dnadist \u0026lt; dnadist.cfg \u0026gt; dnadist.log mv outfile infile.dist # 构建NJ树 echo -e \u0026#34;infile.dist\\nY\u0026#34; \u0026gt; neighbor.cfg neighbor \u0026lt; neighbor.cfg \u0026gt; nj.log # 格式整理 less infile.dist | tr \u0026#39;\\n\u0026#39; \u0026#39;|\u0026#39; | sed \u0026#39;s/| / /g\u0026#39; | tr \u0026#39;|\u0026#39; \u0026#39;\\n\u0026#39; \u0026gt; infile.dist.table less outtree | tr \u0026#39;\\n\u0026#39; \u0026#39; \u0026#39; | sed \u0026#39;s/ //g\u0026#39; \u0026gt; outtree.nwk 2.2 SNPhylo 建树 /pub/software/SNPhylo/snphylo.sh \\ -v ../../00.filter/all.LDfilter.vcf \\ -r \\ -l 1 \\ -m 0.01 \\ -o GA0001 \\ -b \\ -B 2 \\ -P tree_snphylo 3. PCA 分析 plink --vcf ../00.filter/all.LDfilter.vcf \\ --pca 10 \\ --out PCA_out \\ --allow-extra-chr \\ --set-missing-var-ids @:# Rscript ../script/draw_PCA.R PCA_out.eigenvec 1 2 ../data/sample.pop PCA_out_figure 4. 群体结构分析 # Step 0: vcf转bed格式 plink --vcf ../00.filter/all.LDfilter.vcf \\ --make-bed \\ --out all \\ --allow-extra-chr \\ --keep-allele-order \\ --set-missing-var-ids @:# # Step 1: 生成Admixture运行脚本 seq 2 4 | awk \u0026#39;{print \u0026#34;admixture --cv -j2 all.bed \u0026#34;$1\u0026#34; 1\u0026gt;admix.\u0026#34;$1\u0026#34;.log 2\u0026gt;\u0026amp;1\u0026#34;}\u0026#39; \u0026gt; admixture.sh # Step 2: 运行Admixture sh admixture.sh # 也可单独运行 admixture --cv -j2 all.bed 2 1\u0026gt;admix.2.log 2\u0026gt;\u0026amp;1 admixture --cv -j2 all.bed 3 1\u0026gt;admix.3.log 2\u0026gt;\u0026amp;1 admixture --cv -j2 all.bed 4 1\u0026gt;admix.4.log 2\u0026gt;\u0026amp;1 # Step 3: 绘制结构图 mkdir result cp ./*.Q result/ Rscript ../script/draw_admixture.R result all.nosex structure 5. LD 衰减分析 # Step 1: 计算LD /pub/software/PopLDdecay/bin/PopLDdecay \\ -InVCF ../data/all.vcf \\ -SubPop ../data/pop.SC.table \\ -MaxDist 500 \\ -OutStat pop.SC.stat /pub/software/PopLDdecay/bin/PopLDdecay \\ -InVCF ../data/all.vcf \\ -SubPop ../data/pop.YZR.table \\ -MaxDist 500 \\ -OutStat pop.YZR.stat # Step 2: 绘制单群体LD衰减图 perl /pub/software/PopLDdecay/bin/Plot_OnePop.pl \\ -inFile pop.SC.stat.gz \\ -output pop.SC.ld perl /pub/software/PopLDdecay/bin/Plot_OnePop.pl \\ -inFile pop.YZR.stat.gz \\ -output pop.YZR.ld # Step 3: 绘制多群体LD衰减图 perl /pub/software/PopLDdecay/bin/Plot_MultiPop.pl \\ -inList ld_stat.list \\ -output ld_stat.multi 选择分析 1. π 和 ROD 分析 vcf=../../data/all.vcf window=20000 step=2000 # Step 1: 计算pi值 vcftools --vcf $vcf \\ --window-pi $window \\ --window-pi-step $step \\ --keep ../../data/pop.SC.table \\ --out ./Pi.pop1 vcftools --vcf $vcf \\ --window-pi $window \\ --window-pi-step $step \\ --keep ../../data/pop.YZR.table \\ --out ./Pi.pop2 # Step 2: 计算ROD pi1=Pi.pop1.windowed.pi pi2=Pi.pop2.windowed.pi perl ../../script/merge2pi_ROD.pl $pi1 $pi2 \u0026gt; Pi.ROD 2. Tajima\u0026rsquo;s D 分析 vcf=../../data/all.vcf window=20000 vcftools --vcf $vcf \\ --TajimaD $window \\ --keep ../../data/pop.SC.table \\ --out TajimaD.pop1 vcftools --vcf $vcf \\ --TajimaD $window \\ --keep ../../data/pop.YZR.table \\ --out TajimaD.pop2 3. Fst 分析 vcf=../../data/all.vcf window=20000 step=2000 vcftools --vcf $vcf \\ --fst-window-size $window \\ --fst-window-step $step \\ --weir-fst-pop ../../data/pop.SC.table \\ --weir-fst-pop ../../data/pop.YZR.table \\ --out ./Fst.pop1.pop2 4. ROD + Fst 联合分析 fst=../03.Fst/Fst.pop1.pop2.windowed.weir.fst ROD=../01.pi_ROD/Pi.ROD gff=../../data/genome.gff # 提取显著位点 perl ../../script/top_Fst_ROD_S.pl $fst $ROD 0.05 0.05 Fst_ROD.table Fst_ROD.stat # 筛选top位点 awk \u0026#39;$NF==\u0026#34;top\u0026#34;\u0026#39; Fst_ROD.table \u0026gt; Fst_ROD.table.top # 提取基因注释 awk \u0026#39;$3==\u0026#34;gene\u0026#34;\u0026#39; $gff \u0026gt; gene.gff # 注释候选基因 bedtools intersect -wo -F 0.1 -a Fst_ROD.table.top -b gene.gff | \\ awk -F \u0026#34;\\t\u0026#34; \u0026#39;{print $7\u0026#34;\\t\u0026#34;$10\u0026#34;\\t\u0026#34;$11\u0026#34;\\t\u0026#34;$13\u0026#34;\\t\u0026#34;$15}\u0026#39; | \\ sort -u \u0026gt; Fst_ROD.table.top.gene GWAS 分析 1. 基因型填充 beagle -Xmx4g -Djava.io.tmpdir=./TMP \\ gt=../data/all.vcf \\ out=all.impute \\ impute=true \\ window=10 \\ nthreads=2 2. 标准 GWAS 分析 # Step 1: 准备VCF数据 plink --vcf ../data/all.vcf \\ --maf 0.05 \\ --geno 0.1 \\ --recode12 \\ --output-missing-genotype 0 \\ --transpose \\ --out snp_filter \\ --set-missing-var-ids @:# \\ --allow-extra-chr # 准备表型数据 perl ../script/sort_pheno.pl snp_filter.tfam ../data/trait.table \u0026gt; trait.sort.txt # Step 2: 计算亲缘关系矩阵 /pub/software/emmax/emmax-kin-intel64 -v -d 10 -o ./pop.kinship snp_filter # Step 3: 运行GWAS /pub/software/emmax/emmax-intel64 -v -d 10 \\ -t snp_filter \\ -p trait.sort.txt \\ -k pop.kinship \\ -o emmax.out 1\u0026gt; emmax.log 2\u0026gt;emmax.err # Step 4: 绘制曼哈顿图 paste snp_filter.map emmax.out.ps | \\ awk \u0026#39;BEGIN{print \u0026#34;SNP\\tCHR\\tBP\\tP\u0026#34;}{if($2==$5){print $2\u0026#34;\\t\u0026#34;$1\u0026#34;\\t\u0026#34;$4\u0026#34;\\t\u0026#34;$NF}}\u0026#39; \\ \u0026gt; emmax.out.ps.manht_input Rscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure 3. GWAS-Q 分析（加入群体结构协变量） # 链接文件 ln -s ../01.GWAS/snp_filter.tped ln -s ../01.GWAS/snp_filter.tfam ln -s ../01.GWAS/snp_filter.nosex ln -s ../01.GWAS/snp_filter.map ln -s ../01.GWAS/trait.sort.txt ln -s ../../02.population_genetics/03.structure/all.3.Q # 准备Q矩阵 paste snp_filter.nosex all.3.Q | awk \u0026#39;{print $1\u0026#34; \u0026#34;$1\u0026#34; 1 \u0026#34;$3\u0026#34; \u0026#34;$4}\u0026#39; \u0026gt; pop.Qmatrix # 运行GWAS /pub/software/emmax/emmax-intel64 -v -d 10 \\ -t snp_filter \\ -p trait.sort.txt \\ -k pop.kinship \\ -c pop.Qmatrix \\ -o emmax.out 1\u0026gt; emmax.log 2\u0026gt;emmax.err # 绘制曼哈顿图 paste snp_filter.map emmax.out.ps | \\ awk \u0026#39;BEGIN{print \u0026#34;SNP\\tCHR\\tBP\\tP\u0026#34;}{if($2==$5){print $2\u0026#34;\\t\u0026#34;$1\u0026#34;\\t\u0026#34;$4\u0026#34;\\t\u0026#34;$NF}}\u0026#39; \\ \u0026gt; emmax.out.ps.manht_input Rscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure_Q 4. 真实数据 GWAS # Step 1: 准备数据 plink --vcf ../data_real/Sample215.M5M8H3.2allel.vcf \\ --maf 0.05 \\ --geno 0.1 \\ --recode12 \\ --output-missing-genotype 0 \\ --transpose \\ --out snp_filter \\ --set-missing-var-ids @:# \\ --allow-extra-chr perl ../script/sort_pheno.pl snp_filter.tfam ../data_real/trait.C16_0.table \u0026gt; trait.sort.txt # Step 2: 计算亲缘关系矩阵 /pub/software/emmax/emmax-kin-intel64 -v -d 10 -o ./pop.kinship snp_filter # Step 3: 运行GWAS /pub/software/emmax/emmax-intel64 -v -d 10 \\ -t snp_filter \\ -p trait.sort.txt \\ -k pop.kinship \\ -o emmax.out 1\u0026gt; emmax.log 2\u0026gt;emmax.err # Step 4: 绘制曼哈顿图 paste snp_filter.map emmax.out.ps | \\ awk \u0026#39;BEGIN{print \u0026#34;SNP\\tCHR\\tBP\\tP\u0026#34;}{if($2==$5){print $2\u0026#34;\\t\u0026#34;$1\u0026#34;\\t\u0026#34;$4\u0026#34;\\t\u0026#34;$NF}}\u0026#39; \\ \u0026gt; emmax.out.ps.manht_input Rscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure_readData QTL-seq 分析 1. VCF 转换为 Table 格式 ref=\u0026lt;reference.fasta\u0026gt; vcf=\u0026lt;input.vcf\u0026gt; outfile=\u0026lt;output.table\u0026gt; gatk VariantsToTable \\ -R $ref \\ -V $vcf \\ -F CHROM -F POS -F REF -F ALT \\ -GF AD -GF DP -GF GQ -GF PL \\ -O $outfile 2. QTL-seq 分析（R 脚本） library(QTLseqr) library(ggplot2) # 设置参数 HighBulk \u0026lt;- \u0026#34;SRR834931\u0026#34; # 高值混池名称 LowBulk \u0026lt;- \u0026#34;SRR834927\u0026#34; # 低值混池名称 Chroms \u0026lt;- paste0(rep(\u0026#34;Chr\u0026#34;, 12), 1:12) # 染色体列表 # ==================== 数据读取 ==================== df \u0026lt;- importFromGATK( file = \u0026#34;../data/Yang_et_al_2013.table\u0026#34;, highBulk = HighBulk, lowBulk = LowBulk, chromList = Chroms ) # ==================== 质量检查图 ==================== # 深度分布图 p1 \u0026lt;- ggplot(data = df) + geom_histogram(aes(x = DP.HIGH + DP.LOW)) + xlim(0, 800) pdf(file = \u0026#34;SNP_depth.pdf\u0026#34;) p1 dev.off() # REF等位基因频率分布 p2 \u0026lt;- ggplot(data = df) + geom_histogram(aes(x = REF_FRQ)) pdf(file = \u0026#34;ref_allele_frequency.pdf\u0026#34;) p2 dev.off() # 高值混池SNP-index分布 p3 \u0026lt;- ggplot(data = df) + geom_histogram(aes(x = SNPindex.HIGH)) pdf(file = \u0026#34;SNPindex.HIGH.dis.pdf\u0026#34;) p3 dev.off() # 低值混池SNP-index分布 p4 \u0026lt;- ggplot(data = df) + geom_histogram(aes(x = SNPindex.LOW)) pdf(file = \u0026#34;SNPindex.LOW.dis.pdf\u0026#34;) p4 dev.off() # ==================== SNP过滤 ==================== df_filt \u0026lt;- filterSNPs( SNPset = df, refAlleleFreq = 0.20, # REF等位基因频率: 0.2~0.8 minTotalDepth = 100, # 最小总深度 maxTotalDepth = 400, # 最大总深度 minSampleDepth = 40, # 单样品最小深度 minGQ = 99, # 基因型质量阈值 verbose = TRUE ) # ==================== deltaSNPindex计算 ==================== df_filt \u0026lt;- runQTLseqAnalysis( df_filt, windowSize = 1e6, # 窗口大小 popStruc = \u0026#34;F2\u0026#34;, # 群体类型 bulkSize = c(385, 430), # 混池个体数 replications = 10000, # Bootstrap次数 intervals = c(95, 99) # 置信区间 ) # ==================== 结果可视化 ==================== # SNP沿染色体分布 p5 \u0026lt;- plotQTLStats(SNPset = df_filt, var = \u0026#34;nSNPs\u0026#34;) pdf(file = \u0026#34;SNP_filter.window.pdf\u0026#34;, width = 20, height = 4) p5 dev.off() # deltaSNPindex沿染色体分布 p6 \u0026lt;- plotQTLStats( SNPset = df_filt, var = \u0026#34;deltaSNP\u0026#34;, plotIntervals = TRUE ) pdf(file = \u0026#34;deltaSNPindex.pdf\u0026#34;, width = 20, height = 4) p6 dev.off() # ==================== 提取显著区域 ==================== QTL \u0026lt;- getSigRegions( SNPset = df_filt, method = \u0026#34;QTLseq\u0026#34;, interval = 95 ) write.table(QTL[[1]], \u0026#34;QTLseq_result.SigRegions.table\u0026#34;, sep = \u0026#34;\\t\u0026#34;, quote = FALSE) # ==================== 导出完整结果 ==================== results99 \u0026lt;- getQTLTable( SNPset = df_filt, method = \u0026#34;QTLseq\u0026#34;, interval = 99, export = FALSE ) write.table( results99, file = \u0026#34;QTLseq_result_deltaSNPindex_CI99.table\u0026#34;, sep = \u0026#34;\\t\u0026#34;, quote = FALSE ) 附录：分析流程图 plaintext\n原始数据 (FASTQ) │ ▼ ┌─────────────────┐ │ 质量控制 QC │ └─────────────────┘ │ ▼ ┌─────────────────┐ │ 比对 Mapping │ ──► BWA MEM └─────────────────┘ │ ▼ ┌─────────────────┐ │ 去重 MarkDup │ ──► Picard └─────────────────┘ │ ├──────────────────────┬──────────────────────┐ ▼ ▼ ▼ ┌───────────┐ ┌───────────┐ ┌───────────┐ │ SNP/InDel │ │ SV │ │ CNV │ │ GATK │ │ lumpy-sv │ │ CNVnator │ └───────────┘ └───────────┘ └───────────┘ │ │ │ └──────────────────────┴──────────────────────┘ │ ▼ ┌─────────────────┐ │ 注释 │ │ ANNOVAR/bedtools│ └─────────────────┘ │ ┌───────────────────┼───────────────────┐ ▼ ▼ ▼ ┌───────────┐ ┌───────────┐ ┌───────────┐ │ 群体结构 │ │ 选择分析 │ │ GWAS │ │ PCA/Tree │ │ Fst/π/D │ │ EMMAX │ │ Structure │ │ │ │ │ └───────────┘ └───────────┘ └───────────┘ ","permalink":"https://Tdxxxx-student.github.io/posts/%E4%BA%91%E5%8D%97%E5%86%9C%E4%B8%9A%E5%A4%A7%E5%AD%A6%E9%87%8D%E6%B5%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE%E6%95%99%E7%A8%8B/","summary":"\u003cp\u003e云南农业大学 云南生物资源保护与利用国家重点实验室\u003c/p\u003e\n\u003cp\u003e李详 | 2019 年 12 月 31 日\u003c/p\u003e\n\u003ch2 id=\"目录\"\u003e目录\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"#%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85\"\u003e软件安装\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E5%8F%98%E5%BC%82%E6%A3%80%E6%B5%8B\"\u003e变异检测\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E7%BE%A4%E4%BD%93%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90\"\u003e群体结构分析\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E9%80%89%E6%8B%A9%E5%88%86%E6%9E%90\"\u003e选择分析\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#gwas%E5%88%86%E6%9E%90\"\u003eGWAS 分析\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#qtl-seq%E5%88%86%E6%9E%90\"\u003eQTL-seq 分析\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#%E9%99%84%E5%BD%95%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B%E5%9B%BE\"\u003e附录：分析流程图\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"软件安装\"\u003e软件安装\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e⚠️ 注意：该部分软件很难用 conda 直接安装，安装步骤比较特殊。\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"1-lumpy-sv\"\u003e1. lumpy-sv\u003c/h3\u003e\n\u003cp\u003e💡 lumpy-sv 依赖 Python2.7，需切换到 py27 环境下进行安装。\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda activate py27\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit clone --recursive https://github.com/arq5x/lumpy-sv.git\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd lumpy-sv\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-svtyper\"\u003e2. svtyper\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003econda install svtyper\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"3-cnvnator\"\u003e3. cnvnator\u003c/h3\u003e\n\u003cp\u003e💡 cnvnator 依赖于 root 软件包及 samtools 软件包（包含 HTSlib），因此先安装依赖。\u003c/p\u003e\n\u003ch4 id=\"31-安装-samtools\"\u003e3.1 安装 samtools\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewget https://github.com/samtools/samtools/releases/download/1.9/samtools-1.9.tar.bz2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etar -xvf samtools-1.9.tar.bz2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd samtools-1.9/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e./configure\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"32-安装-root-软件\"\u003e3.2 安装 root 软件\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 直接下载后解压即可\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewget https://root.cern/download/root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003etar -zxvf root_v6.18.04.Linux-ubuntu18-x86_64-gcc7.4.tar.gz\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"33-安装-cnvnator\"\u003e3.3 安装 cnvnator\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit clone https://github.com/abyzovlab/CNVnator.git\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd CNVnator\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 链接samtools软件目录到cnvnator目录\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eln -s ../samtools-1.9 ./samtools\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 加载root软件到环境变量\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport ROOTSYS\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/pub/software/root\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport PATH\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/pub/software/root/bin:$PATH\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport LD_LIBRARY_PATH\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e$LD_LIBRARY_PATH:$ROOTSYS/lib\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 安装cnvnator\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emake LIBS\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-lcrypto\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"变异检测\"\u003e变异检测\u003c/h2\u003e\n\u003ch3 id=\"1-构建基因组-index\"\u003e1. 构建基因组 index\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 创建软链接\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eln -s ../data/genome.fasta ./genome.fasta\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# for gatk\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esamtools faidx genome.fasta\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# for bwa\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebwa index genome.fasta\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# for picard\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epicard CreateSequenceDictionary R\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003egenome.fasta\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-比对排序去重\"\u003e2. 比对排序去重\u003c/h3\u003e\n\u003ch4 id=\"21-比对排序\"\u003e2.1 比对排序\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebwa mem -t \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e -R \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;@RG\\tID:S1\\tSM:S1\\tPL:illumina\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ../01.ref/genome.fasta \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ../data/S1_1.fq.gz ../data/S1_2.fq.gz | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    /pub/software/samtools/samtools sort -@ \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e -m 1G -o S1.sort.bam -\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebwa mem -t \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e -R \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;@RG\\tID:S2\\tSM:S2\\tPL:illumina\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ../01.ref/genome.fasta \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ../data/S2_1.fq.gz ../data/S2_2.fq.gz | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    /pub/software/samtools/samtools sort -@ \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e -m 1G -o S2.sort.bam -\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"22-去除重复\"\u003e2.2 去除重复\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epicard -Xmx4g MarkDuplicates \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    I\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eS1.sort.bam \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    O\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eS1.sort.rmdup.bam \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    CREATE_INDEX\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etrue \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    REMOVE_DUPLICATES\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etrue \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    M\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eS1.marked_dup_metrics.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epicard -Xmx4g MarkDuplicates \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    I\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eS2.sort.bam \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    O\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eS2.sort.rmdup.bam \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    CREATE_INDEX\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etrue \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    REMOVE_DUPLICATES\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etrue \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    M\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eS2.marked_dup_metrics.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"23-比对率统计\"\u003e2.3 比对率统计\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/samtools/samtools flagstat S1.sort.bam \u0026gt; S1.sort.bam.flagstat\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/samtools/samtools flagstat S2.sort.bam \u0026gt; S2.sort.bam.flagstat\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"24-批量比对脚本生成\"\u003e2.4 批量比对脚本生成\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eless ../data/sample.list | awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{ \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    print \u0026#34;bwa mem -t 2 -R \u0026#39;\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39;@RG\\\\tID:\u0026#34;$1\u0026#34;\\\\tSM:\u0026#34;$1\u0026#34;\\\\tPL:illumina\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e\\\u0026#39;\u003c/span\u003e\u003cspan style=\"color:#e6db74\"\u003e\u0026#39; \\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    ../01.ref/genome.fasta ../data/\u0026#34;$1\u0026#34;_1.fq.gz ../data/\u0026#34;$1\u0026#34;_2.fq.gz | \\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e    /pub/software/samtools/samtools sort -@ 2 -m 1G -o \u0026#34;$1\u0026#34;.sort.bam -\u0026#34; \n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#e6db74\"\u003e}\u0026#39;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"3-snpindel-检测\"\u003e3. SNP、Indel 检测\u003c/h3\u003e\n\u003ch4 id=\"31-haplotypecaller\"\u003e3.1 HaplotypeCaller\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egatk --java-options \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-Xmx10g -Djava.io.tmpdir=./tmp\u0026#34;\u003c/span\u003e HaplotypeCaller \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -R ../01.ref/genome.fasta \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -I ../02.mapping/S1.sort.rmdup.bam \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -ERC GVCF \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -O S1.g.vcf 1\u0026gt;S1.HC.log 2\u0026gt;\u0026amp;\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egatk --java-options \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-Xmx10g -Djava.io.tmpdir=./tmp\u0026#34;\u003c/span\u003e HaplotypeCaller \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -R ../01.ref/genome.fasta \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -I ../02.mapping/S2.sort.rmdup.bam \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -ERC GVCF \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -O S2.g.vcf 1\u0026gt;S2.HC.log 2\u0026gt;\u0026amp;\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"32-combinegvcfs\"\u003e3.2 CombineGVCFs\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003els ./S*.g.vcf \u0026gt; gvcf.list\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egatk --java-options \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34;\u003c/span\u003e CombineGVCFs \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -R ../01.ref/genome.fasta \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -V gvcf.list \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -O all.merge.g.vcf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"33genotpegvcfs\"\u003e3.3GenotpeGVCFs\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egatk --java-options \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34;\u003c/span\u003e GenotypeGVCFs \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -R ../01.ref/genome.fasta \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --variant all.merge.g.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -O all.merge_raw.vcf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"34-snp-过滤\"\u003e3.4 SNP 过滤\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 提取SNP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egatk --java-options \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34;\u003c/span\u003e SelectVariants \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -R ../01.ref/genome.fasta \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -V all.merge_raw.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --select-type SNP \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -O all.raw.snp.vcf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 标记过滤\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egatk --java-options \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34;\u003c/span\u003e VariantFiltration \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -R ../01.ref/genome.fasta \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -V all.raw.snp.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --filter-expression \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;QD \u0026lt; 2.0 || MQ \u0026lt; 40.0 || FS \u0026gt; 60.0 || SOR \u0026gt; 3.0 || MQRankSum \u0026lt; -12.5 || ReadPosRankSum \u0026lt; -8.0\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --filter-name \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;SNP_filter\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -O all.filter.snp.vcf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 提取过滤后的SNP\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egatk --java-options \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34;\u003c/span\u003e SelectVariants \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -R ../01.ref/genome.fasta \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -V all.filter.snp.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --exclude-filtered \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -O all.filtered.snp.vcf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"35-indel-过滤\"\u003e3.5 InDel 过滤\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 提取InDel\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egatk --java-options \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34;\u003c/span\u003e SelectVariants \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -R ../01.ref/genome.fasta \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -V all.merge_raw.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --select-type INDEL \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -O all.raw.indel.vcf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 标记过滤\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egatk --java-options \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34;\u003c/span\u003e VariantFiltration \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -R ../01.ref/genome.fasta \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -V all.raw.indel.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --filter-expression \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;QD \u0026lt; 2.0 || FS \u0026gt; 200.0 || SOR \u0026gt; 10.0 || MQRankSum \u0026lt; -12.5 || ReadPosRankSum \u0026lt; -8.0\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --filter-name \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;INDEL_filter\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -O all.filter.indel.vcf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 提取过滤后的InDel\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egatk --java-options \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;-Xmx4g -Djava.io.tmpdir=./tmp\u0026#34;\u003c/span\u003e SelectVariants \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -R ../01.ref/genome.fasta \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -V all.filter.indel.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --exclude-filtered \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -O all.filtered.indel.vcf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"4-sv-检测\"\u003e4. SV 检测\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 1: 提取 discordants reads\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/samtools/samtools view -b -F \u003cspan style=\"color:#ae81ff\"\u003e1294\u003c/span\u003e -@ \u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ../02.mapping/S1.sort.rmdup.bam \u0026gt; S1.discordants.bam\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/samtools/samtools view -b -F \u003cspan style=\"color:#ae81ff\"\u003e1294\u003c/span\u003e -@ \u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    ../02.mapping/S2.sort.rmdup.bam \u0026gt; S2.discordants.bam\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 2: 提取 split reads\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/samtools/samtools view -h ../02.mapping/S1.sort.rmdup.bam | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    /pub/software/lumpy-sv/scripts/extractSplitReads_BwaMem -i stdin | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    /pub/software/samtools/samtools sort - \u0026gt; S1.splitters.bam\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/samtools/samtools view -h ../02.mapping/S2.sort.rmdup.bam | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    /pub/software/lumpy-sv/scripts/extractSplitReads_BwaMem -i stdin | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    /pub/software/samtools/samtools sort - \u0026gt; S2.splitters.bam\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 3: 运行 lumpy\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/lumpy-sv/bin/lumpyexpress \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -B ../02.mapping/S1.sort.rmdup.bam,../02.mapping/S2.sort.rmdup.bam \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -S S1.splitters.bam,S2.splitters.bam \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -D S1.discordants.bam,S2.discordants.bam \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -o all.sv.lumpy.vcf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 4: 个体基因型分型\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evcftools --vcf all.sv.lumpy.vcf --indv S1 --recode --recode-INFO-all --out S1 \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    svtyper -i S1.recode.vcf -B ../02.mapping/S1.sort.rmdup.bam -o S1.genotype.vcf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evcftools --vcf all.sv.lumpy.vcf --indv S2 --recode --recode-INFO-all --out S2 \u003cspan style=\"color:#f92672\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    svtyper -i S2.recode.vcf -B ../02.mapping/S2.sort.rmdup.bam -o S2.genotype.vcf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"5-cnv-检测\"\u003e5. CNV 检测\u003c/h3\u003e\n\u003ch4 id=\"51-准备基因组\"\u003e5.1 准备基因组\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 将基因组拆分为单条染色体\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eln -s ../data/genome.fasta ./genome.fa\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eseqkit split -i ./genome.fa -O split\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 重命名文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003els ./split/genome.id_*.fa | sed \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;s/./split/genome.id_//\u0026#39;\u003c/span\u003e | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print \u0026#34;mv ./split/genome.id_\u0026#34;$aa\u0026#34; ./split/\u0026#34;$aa}\u0026#39;\u003c/span\u003e \u0026gt; mv_name.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esh mv_name.sh\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"52-运行-cnvnator\"\u003e5.2 运行 cnvnator\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 设置环境变量\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport ROOTSYS\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/pub/software/root\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport PATH\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e/pub/software/root/bin:$PATH\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eexport LD_LIBRARY_PATH\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e$LD_LIBRARY_PATH:$ROOTSYS/lib\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 链接文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eln -s ../02.mapping/S1.sort.rmdup.bam\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 提取比对结果\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/CNVnator/cnvnator -genome genome.fa -root S1.root -tree S1.sort.rmdup.bam\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 生成深度分布\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/CNVnator/cnvnator -genome genome.fa -root S1.root -his \u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e -d split\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 进行统计计算\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/CNVnator/cnvnator -root S1.root -stat \u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 检查bin size是否合适\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/CNVnator/cnvnator -root S1.root -eval \u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e \u0026gt; S1.eval.ratio\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# RD信号分割\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/CNVnator/cnvnator -root S1.root -partition \u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 进行CNV检测\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/CNVnator/cnvnator -root S1.root -call \u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e \u0026gt; S1.cnv\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"6-snpindel-注释\"\u003e6. SNP/InDel 注释\u003c/h3\u003e\n\u003ch4 id=\"61-准备注释数据库\"\u003e6.1 准备注释数据库\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eln -s ../data/genome.gtf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eln -s ../data/genome.fasta\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egtfToGenePred -genePredExt genome.gtf genome_refGene.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/annovar/retrieve_seq_from_fasta.pl \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --format refGene \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --seqfile genome.fasta \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    genome_refGene.txt \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --out genome_refGeneMrna.fa\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"62-注释-vcf-文件\"\u003e6.2 注释 VCF 文件\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eln -s ../03.SNP_indel/all.filtered.snp.vcf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 格式转换\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/annovar/convert2annovar.pl \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -format vcf4old \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    all.filtered.snp.vcf \u0026gt; all.snp.vcf.annovar.input\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 进行注释\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/annovar/annotate_variation.pl \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -geneanno \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --neargene \u003cspan style=\"color:#ae81ff\"\u003e2000\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -buildver genome \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -dbtype refGene \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -outfile all.anno \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -exonsort \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    all.snp.vcf.annovar.input ./\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"7-cnv-和-sv-注释\"\u003e7. CNV 和 SV 注释\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 处理SV文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eless -S ../04.SV/all.sv.lumpy.vcf | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    awk -F \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;;\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{ if($1!~/#/){print $1\u0026#34;\\t\u0026#34;$2\u0026#34;\\t\u0026#34;$3\u0026#34;\\t\u0026#34;$4} }\u0026#39;\u003c/span\u003e | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print $1\u0026#34;\\t\u0026#34;$2\u0026#34;\\t\u0026#34;$11\u0026#34;\\t\u0026#34;$3\u0026#34;\\t\u0026#34;$8}\u0026#39;\u003c/span\u003e | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sed \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;s/END=//\u0026#39;\u003c/span\u003e | sed \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;s/SVTYPE=//\u0026#39;\u003c/span\u003e \u0026gt; SV.bed\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 过滤BND类型\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eawk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;$5 !~ /BND/\u0026#39;\u003c/span\u003e SV.bed \u0026gt; SV_filter.bed\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# SV注释\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebedtools intersect -wo -a SV_filter.bed -b gene.gtf \u0026gt; SV_filter.Anno\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 处理CNV文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eless -S ../05.CNV/S1.cnv | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print $2 \u0026#34;\\t\u0026#34; $1}\u0026#39;\u003c/span\u003e | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sed \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;s/:/\\t/\u0026#39;\u003c/span\u003e | sed \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;s/-/\\t/\u0026#39;\u003c/span\u003e \u0026gt; CNV.bed\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# CNV注释\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebedtools intersect -wo -a CNV.bed -b gene.gtf \u0026gt; CNV.Anno\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"群体结构分析\"\u003e群体结构分析\u003c/h2\u003e\n\u003ch3 id=\"1-数据过滤\"\u003e1. 数据过滤\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evcf\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e../data/all.vcf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 过滤缺失率和最小等位基因频率\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eplink --vcf $vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --geno 0.1 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --maf 0.01 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --out all.missing_maf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --recode vcf-iid \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --allow-extra-chr \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --set-missing-var-ids @:# \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --keep-allele-order\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 过滤连锁不平衡\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eplink --vcf all.missing_maf.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --indep-pairwise \u003cspan style=\"color:#ae81ff\"\u003e50\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e 0.2 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --out tmp.ld \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --allow-extra-chr \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --set-missing-var-ids @:#\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eplink --vcf all.missing_maf.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --make-bed \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --extract tmp.ld.prune.in \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --out all.LDfilter \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --recode vcf-iid \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --keep-allele-order \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --allow-extra-chr \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --set-missing-var-ids @:#\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-建树分析\"\u003e2. 建树分析\u003c/h3\u003e\n\u003ch4 id=\"21-nj-树\"\u003e2.1 NJ 树\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 格式转换\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eperl ../../script/vcf2phy.pl ../../00.filter/all.LDfilter.vcf \u0026gt; sequences.dat\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 计算遗传距离\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;sequences.dat\\nY\u0026#34;\u003c/span\u003e \u0026gt; dnadist.cfg\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ednadist \u0026lt; dnadist.cfg \u0026gt; dnadist.log\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emv outfile infile.dist\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 构建NJ树\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eecho -e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;infile.dist\\nY\u0026#34;\u003c/span\u003e \u0026gt; neighbor.cfg\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eneighbor \u0026lt; neighbor.cfg \u0026gt; nj.log\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 格式整理\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eless infile.dist | tr \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\\n\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;|\u0026#39;\u003c/span\u003e | sed \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;s/| / /g\u0026#39;\u003c/span\u003e | tr \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;|\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\\n\u0026#39;\u003c/span\u003e \u0026gt; infile.dist.table\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eless outtree | tr \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;\\n\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39; \u0026#39;\u003c/span\u003e | sed \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;s/ //g\u0026#39;\u003c/span\u003e \u0026gt; outtree.nwk\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch4 id=\"22-snphylo-建树\"\u003e2.2 SNPhylo 建树\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/SNPhylo/snphylo.sh \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -v ../../00.filter/all.LDfilter.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -r \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -l \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -m 0.01 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -o GA0001 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -b \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -B \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -P tree_snphylo\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"3-pca-分析\"\u003e3. PCA 分析\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eplink --vcf ../00.filter/all.LDfilter.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --pca \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --out PCA_out \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --allow-extra-chr \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --set-missing-var-ids @:#\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRscript ../script/draw_PCA.R PCA_out.eigenvec \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e ../data/sample.pop PCA_out_figure\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"4-群体结构分析\"\u003e4. 群体结构分析\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 0: vcf转bed格式\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eplink --vcf ../00.filter/all.LDfilter.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --make-bed \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --out all \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --allow-extra-chr \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --keep-allele-order \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --set-missing-var-ids @:#\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 1: 生成Admixture运行脚本\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eseq \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e | awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print \u0026#34;admixture --cv -j2 all.bed \u0026#34;$1\u0026#34; 1\u0026gt;admix.\u0026#34;$1\u0026#34;.log 2\u0026gt;\u0026amp;1\u0026#34;}\u0026#39;\u003c/span\u003e \u0026gt; admixture.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 2: 运行Admixture\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003esh admixture.sh\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 也可单独运行\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eadmixture --cv -j2 all.bed \u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e 1\u0026gt;admix.2.log 2\u0026gt;\u0026amp;\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eadmixture --cv -j2 all.bed \u003cspan style=\"color:#ae81ff\"\u003e3\u003c/span\u003e 1\u0026gt;admix.3.log 2\u0026gt;\u0026amp;\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eadmixture --cv -j2 all.bed \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e 1\u0026gt;admix.4.log 2\u0026gt;\u0026amp;\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 3: 绘制结构图\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003emkdir result\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecp ./*.Q result/\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRscript ../script/draw_admixture.R result all.nosex structure\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"5-ld-衰减分析\"\u003e5. LD 衰减分析\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 1: 计算LD\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/PopLDdecay/bin/PopLDdecay \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -InVCF ../data/all.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -SubPop ../data/pop.SC.table \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -MaxDist \u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -OutStat pop.SC.stat\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/PopLDdecay/bin/PopLDdecay \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -InVCF ../data/all.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -SubPop ../data/pop.YZR.table \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -MaxDist \u003cspan style=\"color:#ae81ff\"\u003e500\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -OutStat pop.YZR.stat\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 2: 绘制单群体LD衰减图\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eperl /pub/software/PopLDdecay/bin/Plot_OnePop.pl \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -inFile pop.SC.stat.gz \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -output pop.SC.ld\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eperl /pub/software/PopLDdecay/bin/Plot_OnePop.pl \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -inFile pop.YZR.stat.gz \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -output pop.YZR.ld\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 3: 绘制多群体LD衰减图\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eperl /pub/software/PopLDdecay/bin/Plot_MultiPop.pl \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -inList ld_stat.list \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -output ld_stat.multi\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"选择分析\"\u003e选择分析\u003c/h2\u003e\n\u003ch3 id=\"1-π-和-rod-分析\"\u003e1. π 和 ROD 分析\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evcf\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e../../data/all.vcf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewindow\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 1: 计算pi值\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evcftools --vcf $vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --window-pi $window \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --window-pi-step $step \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --keep ../../data/pop.SC.table \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --out ./Pi.pop1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evcftools --vcf $vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --window-pi $window \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --window-pi-step $step \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --keep ../../data/pop.YZR.table \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --out ./Pi.pop2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 2: 计算ROD\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epi1\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ePi.pop1.windowed.pi\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epi2\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003ePi.pop2.windowed.pi\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eperl ../../script/merge2pi_ROD.pl $pi1 $pi2 \u0026gt; Pi.ROD\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-tajimas-d-分析\"\u003e2. Tajima\u0026rsquo;s D 分析\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evcf\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e../../data/all.vcf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewindow\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evcftools --vcf $vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --TajimaD $window \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --keep ../../data/pop.SC.table \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --out TajimaD.pop1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evcftools --vcf $vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --TajimaD $window \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --keep ../../data/pop.YZR.table \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --out TajimaD.pop2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"3-fst-分析\"\u003e3. Fst 分析\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evcf\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e../../data/all.vcf\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewindow\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e20000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003estep\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2000\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evcftools --vcf $vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --fst-window-size $window \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --fst-window-step $step \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --weir-fst-pop ../../data/pop.SC.table \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --weir-fst-pop ../../data/pop.YZR.table \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --out ./Fst.pop1.pop2\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"4-rod--fst-联合分析\"\u003e4. ROD + Fst 联合分析\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003efst\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e../03.Fst/Fst.pop1.pop2.windowed.weir.fst\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eROD\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e../01.pi_ROD/Pi.ROD\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egff\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e../../data/genome.gff\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 提取显著位点\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eperl ../../script/top_Fst_ROD_S.pl $fst $ROD 0.05 0.05 Fst_ROD.table Fst_ROD.stat\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 筛选top位点\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eawk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;$NF==\u0026#34;top\u0026#34;\u0026#39;\u003c/span\u003e Fst_ROD.table \u0026gt; Fst_ROD.table.top\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 提取基因注释\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eawk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;$3==\u0026#34;gene\u0026#34;\u0026#39;\u003c/span\u003e $gff \u0026gt; gene.gff\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 注释候选基因\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebedtools intersect -wo -F 0.1 -a Fst_ROD.table.top -b gene.gff | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    awk -F \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\\t\u0026#34;\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print $7\u0026#34;\\t\u0026#34;$10\u0026#34;\\t\u0026#34;$11\u0026#34;\\t\u0026#34;$13\u0026#34;\\t\u0026#34;$15}\u0026#39;\u003c/span\u003e | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sort -u \u0026gt; Fst_ROD.table.top.gene\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"gwas-分析\"\u003eGWAS 分析\u003c/h2\u003e\n\u003ch3 id=\"1-基因型填充\"\u003e1. 基因型填充\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ebeagle -Xmx4g -Djava.io.tmpdir\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e./TMP \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    gt\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e../data/all.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    out\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003eall.impute \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    impute\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003etrue \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    window\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    nthreads\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e2\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-标准-gwas-分析\"\u003e2. 标准 GWAS 分析\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 1: 准备VCF数据\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eplink --vcf ../data/all.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --maf 0.05 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --geno 0.1 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --recode12 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --output-missing-genotype \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --transpose \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --out snp_filter \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --set-missing-var-ids @:# \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --allow-extra-chr\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 准备表型数据\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eperl ../script/sort_pheno.pl snp_filter.tfam ../data/trait.table \u0026gt; trait.sort.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 2: 计算亲缘关系矩阵\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/emmax/emmax-kin-intel64 -v -d \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e -o ./pop.kinship snp_filter\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 3: 运行GWAS\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/emmax/emmax-intel64 -v -d \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -t snp_filter \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -p trait.sort.txt \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -k pop.kinship \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -o emmax.out 1\u0026gt; emmax.log 2\u0026gt;emmax.err\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 4: 绘制曼哈顿图\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epaste snp_filter.map emmax.out.ps | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;BEGIN{print \u0026#34;SNP\\tCHR\\tBP\\tP\u0026#34;}{if($2==$5){print $2\u0026#34;\\t\u0026#34;$1\u0026#34;\\t\u0026#34;$4\u0026#34;\\t\u0026#34;$NF}}\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026gt; emmax.out.ps.manht_input\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"3-gwas-q-分析加入群体结构协变量\"\u003e3. GWAS-Q 分析（加入群体结构协变量）\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 链接文件\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eln -s ../01.GWAS/snp_filter.tped\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eln -s ../01.GWAS/snp_filter.tfam\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eln -s ../01.GWAS/snp_filter.nosex\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eln -s ../01.GWAS/snp_filter.map\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eln -s ../01.GWAS/trait.sort.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eln -s ../../02.population_genetics/03.structure/all.3.Q\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 准备Q矩阵\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epaste snp_filter.nosex all.3.Q | awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;{print $1\u0026#34; \u0026#34;$1\u0026#34; 1 \u0026#34;$3\u0026#34; \u0026#34;$4}\u0026#39;\u003c/span\u003e \u0026gt; pop.Qmatrix\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 运行GWAS\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/emmax/emmax-intel64 -v -d \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -t snp_filter \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -p trait.sort.txt \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -k pop.kinship \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -c pop.Qmatrix \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -o emmax.out 1\u0026gt; emmax.log 2\u0026gt;emmax.err\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 绘制曼哈顿图\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epaste snp_filter.map emmax.out.ps | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;BEGIN{print \u0026#34;SNP\\tCHR\\tBP\\tP\u0026#34;}{if($2==$5){print $2\u0026#34;\\t\u0026#34;$1\u0026#34;\\t\u0026#34;$4\u0026#34;\\t\u0026#34;$NF}}\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026gt; emmax.out.ps.manht_input\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure_Q\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"4-真实数据-gwas\"\u003e4. 真实数据 GWAS\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 1: 准备数据\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eplink --vcf ../data_real/Sample215.M5M8H3.2allel.vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --maf 0.05 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --geno 0.1 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --recode12 \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --output-missing-genotype \u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --transpose \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --out snp_filter \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --set-missing-var-ids @:# \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    --allow-extra-chr\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eperl ../script/sort_pheno.pl snp_filter.tfam ../data_real/trait.C16_0.table \u0026gt; trait.sort.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 2: 计算亲缘关系矩阵\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/emmax/emmax-kin-intel64 -v -d \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e -o ./pop.kinship snp_filter\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 3: 运行GWAS\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e/pub/software/emmax/emmax-intel64 -v -d \u003cspan style=\"color:#ae81ff\"\u003e10\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -t snp_filter \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -p trait.sort.txt \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -k pop.kinship \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -o emmax.out 1\u0026gt; emmax.log 2\u0026gt;emmax.err\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# Step 4: 绘制曼哈顿图\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003epaste snp_filter.map emmax.out.ps | \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    awk \u003cspan style=\"color:#e6db74\"\u003e\u0026#39;BEGIN{print \u0026#34;SNP\\tCHR\\tBP\\tP\u0026#34;}{if($2==$5){print $2\u0026#34;\\t\u0026#34;$1\u0026#34;\\t\u0026#34;$4\u0026#34;\\t\u0026#34;$NF}}\u0026#39;\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u0026gt; emmax.out.ps.manht_input\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eRscript ../script/manhattan.R emmax.out.ps.manht_input emmax.out.ps.manht_figure_readData\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"qtl-seq-分析\"\u003eQTL-seq 分析\u003c/h2\u003e\n\u003ch3 id=\"1-vcf-转换为-table-格式\"\u003e1. VCF 转换为 Table 格式\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eref\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026lt;reference.fasta\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003evcf\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026lt;input.vcf\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eoutfile\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u0026lt;output.table\u0026gt;\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egatk VariantsToTable \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -R $ref \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -V $vcf \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -F CHROM -F POS -F REF -F ALT \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -GF AD -GF DP -GF GQ -GF PL \u003cspan style=\"color:#ae81ff\"\u003e\\\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    -O $outfile\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch3 id=\"2-qtl-seq-分析r-脚本\"\u003e2. QTL-seq 分析（R 脚本）\u003c/h3\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-R\" data-lang=\"R\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elibrary\u003c/span\u003e(QTLseqr)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003elibrary\u003c/span\u003e(ggplot2)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 设置参数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eHighBulk \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;SRR834931\u0026#34;\u003c/span\u003e  \u003cspan style=\"color:#75715e\"\u003e# 高值混池名称\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eLowBulk \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;SRR834927\u0026#34;\u003c/span\u003e   \u003cspan style=\"color:#75715e\"\u003e# 低值混池名称\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eChroms \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003epaste0\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003erep\u003c/span\u003e(\u003cspan style=\"color:#e6db74\"\u003e\u0026#34;Chr\u0026#34;\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e), \u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#f92672\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e12\u003c/span\u003e)  \u003cspan style=\"color:#75715e\"\u003e# 染色体列表\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# ==================== 数据读取 ====================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eimportFromGATK\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    file \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;../data/Yang_et_al_2013.table\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    highBulk \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e HighBulk,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    lowBulk \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e LowBulk,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    chromList \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e Chroms\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# ==================== 质量检查图 ====================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 深度分布图\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ep1 \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eggplot\u003c/span\u003e(data \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003egeom_histogram\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eaes\u003c/span\u003e(x \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e DP.HIGH \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e DP.LOW)) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003exlim\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e0\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e800\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003epdf\u003c/span\u003e(file \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;SNP_depth.pdf\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ep1\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edev.off\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# REF等位基因频率分布\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ep2 \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eggplot\u003c/span\u003e(data \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003egeom_histogram\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eaes\u003c/span\u003e(x \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e REF_FRQ))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003epdf\u003c/span\u003e(file \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;ref_allele_frequency.pdf\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ep2\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edev.off\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 高值混池SNP-index分布\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ep3 \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eggplot\u003c/span\u003e(data \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003egeom_histogram\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eaes\u003c/span\u003e(x \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e SNPindex.HIGH))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003epdf\u003c/span\u003e(file \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;SNPindex.HIGH.dis.pdf\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ep3\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edev.off\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 低值混池SNP-index分布\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ep4 \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eggplot\u003c/span\u003e(data \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df) \u003cspan style=\"color:#f92672\"\u003e+\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    \u003cspan style=\"color:#a6e22e\"\u003egeom_histogram\u003c/span\u003e(\u003cspan style=\"color:#a6e22e\"\u003eaes\u003c/span\u003e(x \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e SNPindex.LOW))\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003epdf\u003c/span\u003e(file \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;SNPindex.LOW.dis.pdf\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ep4\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edev.off\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# ==================== SNP过滤 ====================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf_filt \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003efilterSNPs\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    SNPset \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    refAlleleFreq \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e0.20\u003c/span\u003e,    \u003cspan style=\"color:#75715e\"\u003e# REF等位基因频率: 0.2~0.8\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    minTotalDepth \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e100\u003c/span\u003e,     \u003cspan style=\"color:#75715e\"\u003e# 最小总深度\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    maxTotalDepth \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e400\u003c/span\u003e,     \u003cspan style=\"color:#75715e\"\u003e# 最大总深度\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    minSampleDepth \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e40\u003c/span\u003e,     \u003cspan style=\"color:#75715e\"\u003e# 单样品最小深度\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    minGQ \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e99\u003c/span\u003e,              \u003cspan style=\"color:#75715e\"\u003e# 基因型质量阈值\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    verbose \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTRUE\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# ==================== deltaSNPindex计算 ====================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003edf_filt \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003erunQTLseqAnalysis\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    df_filt,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    windowSize \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e1e6\u003c/span\u003e,        \u003cspan style=\"color:#75715e\"\u003e# 窗口大小\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    popStruc \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;F2\u0026#34;\u003c/span\u003e,         \u003cspan style=\"color:#75715e\"\u003e# 群体类型\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    bulkSize \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e385\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e430\u003c/span\u003e),  \u003cspan style=\"color:#75715e\"\u003e# 混池个体数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    replications \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e10000\u003c/span\u003e,    \u003cspan style=\"color:#75715e\"\u003e# Bootstrap次数\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    intervals \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003ec\u003c/span\u003e(\u003cspan style=\"color:#ae81ff\"\u003e95\u003c/span\u003e, \u003cspan style=\"color:#ae81ff\"\u003e99\u003c/span\u003e)    \u003cspan style=\"color:#75715e\"\u003e# 置信区间\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# ==================== 结果可视化 ====================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# SNP沿染色体分布\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ep5 \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eplotQTLStats\u003c/span\u003e(SNPset \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df_filt, var \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;nSNPs\u0026#34;\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003epdf\u003c/span\u003e(file \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;SNP_filter.window.pdf\u0026#34;\u003c/span\u003e, width \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e, height \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ep5\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edev.off\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# deltaSNPindex沿染色体分布\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ep6 \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003eplotQTLStats\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    SNPset \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df_filt, \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    var \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;deltaSNP\u0026#34;\u003c/span\u003e, \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    plotIntervals \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eTRUE\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003epdf\u003c/span\u003e(file \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;deltaSNPindex.pdf\u0026#34;\u003c/span\u003e, width \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e20\u003c/span\u003e, height \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e4\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ep6\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003edev.off\u003c/span\u003e()\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# ==================== 提取显著区域 ====================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eQTL \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egetSigRegions\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    SNPset \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df_filt, \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    method \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;QTLseq\u0026#34;\u003c/span\u003e, \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    interval \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e95\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ewrite.table\u003c/span\u003e(QTL[[1]], \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;QTLseq_result.SigRegions.table\u0026#34;\u003c/span\u003e, sep \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\\t\u0026#34;\u003c/span\u003e, quote \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eFALSE\u003c/span\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# ==================== 导出完整结果 ====================\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eresults99 \u003cspan style=\"color:#f92672\"\u003e\u0026lt;-\u003c/span\u003e \u003cspan style=\"color:#a6e22e\"\u003egetQTLTable\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    SNPset \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e df_filt,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    method \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;QTLseq\u0026#34;\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    interval \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#ae81ff\"\u003e99\u003c/span\u003e,\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    export \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eFALSE\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#a6e22e\"\u003ewrite.table\u003c/span\u003e(\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    results99, \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    file \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;QTLseq_result_deltaSNPindex_CI99.table\u0026#34;\u003c/span\u003e, \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    sep \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#e6db74\"\u003e\u0026#34;\\t\u0026#34;\u003c/span\u003e, \n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e    quote \u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e \u003cspan style=\"color:#66d9ef\"\u003eFALSE\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e)\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"附录分析流程图\"\u003e附录：分析流程图\u003c/h2\u003e\n\u003cp\u003eplaintext\u003c/p\u003e","title":"云南农业大学重测序项目教程"},{"content":"这是基于我们刚才排查过的所有坑（环境报错、配置乱码、Git权限、部署冲突、文章不显示等），为你量身定制的**“避坑版”极简教程**。\n这套方案采用 Hugo + GitHub Actions (自动部署) 方案。这是目前最稳定、最省心的方案，你只需要配置一次，以后写文章只需要“三行命令”。\n🛠 第一步：环境与建站 假设你已经安装好了 Git 和 VS Code。\n安装 Hugo (Windows 推荐) 打开 CMD 或 PowerShell：\nwinget install Hugo.Hugo.Extended (安装完后重启电脑，或者重启终端)\n创建博客项目 找个盘符（比如 D 盘），右键打开 Git Bash：\n# 1. 创建站点 hugo new site myblog cd myblog # 2. 初始化 Git git init # 3. 下载主题 (直接下载，避开 submodule 报错坑) git clone https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth=1 ⚙️ 第二步：配置核心文件 (直接复制，不要改乱) 用 VS Code 打开 myblog 文件夹，找到 hugo.toml，全选删除，粘贴以下内容：\nbaseURL = \u0026#39;https://你的用户名.github.io/\u0026#39; languageCode = \u0026#39;zh-cn\u0026#39; title = \u0026#39;我的博客\u0026#39; theme = \u0026#39;PaperMod\u0026#39; # 注意：不要加 publishDir = \u0026#34;docs\u0026#34;，我们用自动脚本处理 [params] defaultTheme = \u0026#34;auto\u0026#34; [params.homeInfoParams] Title = \u0026#34;你好，我是博主\u0026#34; Content = \u0026#34;欢迎来到我的个人博客\u0026#34; [[menu.main]] name = \u0026#34;文章\u0026#34; url = \u0026#34;/posts\u0026#34; weight = 1 📝 第三步：写第一篇文章 (注意格式) 在终端输入：hugo new posts/hello.md 然后打开该文件，确保头部信息是这样的（TOML 格式）：\n+++ title = \u0026#34;我的第一篇文章\u0026#34; date = 2024-05-01T12:00:00+08:00 draft = false +++ 这里写正文... (注意：date 不要写未来的时间，draft 必须是 false) 🤖 第四步：配置自动部署脚本 (一次性工作) 在项目根目录下，手动新建文件夹：.github 在 .github 里面新建文件夹：workflows 在 workflows 里面新建文件：deploy.yml 粘贴以下内容（这是让机器人干活的指令）： name: Deploy to GitHub Pages on: push: branches: - main # 监听 main 分支 jobs: deploy: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 with: submodules: true # Fetch Hugo themes (true OR recursive) fetch-depth: 0 # Fetch all history for .GitInfo and .Lastmod - name: Setup Hugo uses: peaceiris/actions-hugo@v2 with: hugo-version: \u0026#39;latest\u0026#39; extended: true - name: Build run: hugo --minify - name: Deploy uses: peaceiris/actions-gh-pages@v3 with: github_token: ${{ secrets.GITHUB_TOKEN }} publish_dir: ./public # 机器人把这里生成的网页发布出去 🔐 第五步：GitHub 仓库与权限设置 (最关键！) 去 GitHub 创建仓库： 仓库名必须是 你的用户名.github.io。 设置权限 (解决 403 报错)： 进入仓库 -\u0026gt; Settings -\u0026gt; Actions -\u0026gt; General。 拉到最下 Workflow permissions。 勾选 Read and write permissions。 点击 Save。 🚀 第六步：推送到 GitHub 回到本地 Git Bash，执行：\n# 1. 关联远程仓库 (如果你还没做过) git remote add origin https://github.com/你的用户名/你的用户名.github.io.git # 如果提示已存在，用 git remote set-url origin ... # 2. 推送三连击 git add . git commit -m \u0026#34;首次发布\u0026#34; git push -u origin main (如果网络卡住，记得开手机热点；如果提示冲突，用 git push -f origin main)\n🌍 第七步：最后的开关 等待 GitHub Actions 跑完（仓库页面顶部 Actions 标签变绿）。 进入仓库 -\u0026gt; Settings -\u0026gt; Pages。 Build and deployment 设置： Source: Deploy from a branch Branch: 选 gh-pages (注意：机器人会自动创建这个分支) Folder: 选 /(root) 点击 Save。 等待 1 分钟，访问 https://你的用户名.github.io，成功！\n📅 以后怎么写新文章？(日常流程) 以后你只需要做这几步，不需要再动配置，也不需要管 public 文件夹：\nhugo new posts/新文章.md 写内容，改 draft = false。 执行推送命令： git add . git commit -m \u0026#34;新文章\u0026#34; git push 结束！ 剩下的交给机器人，喝杯茶等网站自动更新。 ","permalink":"https://Tdxxxx-student.github.io/posts/ai%E8%BE%85%E5%8A%A9%E6%95%99%E7%A8%8B/","summary":"\u003cp\u003e这是基于我们刚才排查过的所有坑（环境报错、配置乱码、Git权限、部署冲突、文章不显示等），为你量身定制的**“避坑版”极简教程**。\u003c/p\u003e\n\u003cp\u003e这套方案采用 \u003cstrong\u003eHugo + GitHub Actions (自动部署)\u003c/strong\u003e 方案。这是目前最稳定、最省心的方案，你只需要配置一次，以后写文章只需要“三行命令”。\u003c/p\u003e\n\u003chr\u003e\n\u003ch3 id=\"-第一步环境与建站\"\u003e🛠 第一步：环境与建站\u003c/h3\u003e\n\u003cp\u003e假设你已经安装好了 Git 和 VS Code。\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e安装 Hugo (Windows 推荐)\u003c/strong\u003e\n打开 CMD 或 PowerShell：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ewinget install Hugo.Hugo.Extended\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003cem\u003e(安装完后重启电脑，或者重启终端)\u003c/em\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e创建博客项目\u003c/strong\u003e\n找个盘符（比如 D 盘），右键打开 Git Bash：\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 1. 创建站点\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ehugo new site myblog\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003ecd myblog\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 2. 初始化 Git\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit init\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003e\u003cspan style=\"color:#75715e\"\u003e# 3. 下载主题 (直接下载，避开 submodule 报错坑)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003egit clone https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod --depth\u003cspan style=\"color:#f92672\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#ae81ff\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003chr\u003e\n\u003ch3 id=\"-第二步配置核心文件-直接复制不要改乱\"\u003e⚙️ 第二步：配置核心文件 (直接复制，不要改乱)\u003c/h3\u003e\n\u003cp\u003e用 VS Code 打开 \u003ccode\u003emyblog\u003c/code\u003e 文件夹，找到 \u003cstrong\u003e\u003ccode\u003ehugo.toml\u003c/code\u003e\u003c/strong\u003e，全选删除，粘贴以下内容：\u003c/p\u003e","title":"AI辅助教程"},{"content":"使用Hugo 搭建博客并部署到 GitHub Pages April 4, 2025 本教程将从 0 开始，手把手教你在 Windows 系统中使用 Hugo 创建一个静态博客，并通过 GitHub Actions 自动部署到 GitHub Pages.\n🧰 一、准备工作 ✅ 1. 安装 Git 下载并安装：https://git-scm.com 安装完成后，右键菜单应该出现 “Git Bash Here” 验证安装：\n打开 power shell 检查 git 安装成功 git \u0026ndash;version ✅ 2. 安装 Hugo（建议扩展版） 仅需在 power shell 输入\n安装 winget install Hugo.Hugo.Extended\n如需卸载 winget uninstall \u0026ndash;name \u0026ldquo;Hugo (Extended)\u0026rdquo;\n检查 Hugo是否安装成功 (重启终端 或 重启电脑) hugo version ✅ 3. 注册 GitHub 并创建仓库 Github 注册: https://github.com 创建一个与你用户名相同的仓库，比如: \u0026lt;Github用户名\u0026gt;.github.io tu\n🏗 二、创建 Hugo 博客项目 在本地找个位置存储 源代码\n创建文件夹 mkdir blog\n打开文件夹 cd blog\n使用 hugo 创建文件夹(此处是您的代码仓库) hugo new site \u0026lt;你的文件夹名\u0026gt;\n#打开你的文件夹 cd \u0026lt;你的文件夹名\u0026gt; 🎨 三、添加主题 PaperMod (此处使用 主题 - PaperMod 作为例子)\n在当前文件夹目录下 powershell :\ngit初始化本地仓库 git init\n将 PaperMod下载到本地 git submodule add https://github.com/adityatelange/hugo-PaperMod.git themes/PaperMod\n如果 git submodule add 不行，则可以网页浏览到PaperMod主页点击 \u0026lt;\u0026gt;Code 下载 zip 文件，压缩文件将文件名改为 PaperMod 并复制粘贴到当前themes目录下即可。 📝 四、配置 hugo.toml 将下面代码复制粘贴到hugo.toml下。 baseURL = \u0026lsquo;https://你的用户名.github.io/\u0026rsquo; languageCode = \u0026lsquo;zh-cn\u0026rsquo; title = \u0026lsquo;我的博客\u0026rsquo; theme = \u0026lsquo;PaperMod\u0026rsquo;\n[params] defaultTheme = \u0026ldquo;auto\u0026rdquo;\n这里 homeInfoParams 下注意不要换行，否则 hugo server可能打开不了（复制时候删除这行注释） homeInfoParams = { Title = \u0026ldquo;你好，我是 \u0026lt;你的用户名\u0026gt; \u0026ldquo;, Content = \u0026ldquo;欢迎来到我的博客主页：个人 / 博客 / 教程 \u0026quot; }\n[[menu.main]] name = \u0026ldquo;个人\u0026rdquo; url = \u0026ldquo;/posts\u0026rdquo; weight = 1\n[[menu.main]] name = \u0026ldquo;教程\u0026rdquo; url = \u0026ldquo;/docs\u0026rdquo; weight = 2\n[[menu.main]] name = \u0026ldquo;学习\u0026rdquo; url = \u0026ldquo;/study\u0026rdquo; weight = 3 baseURL: 访问你个人网页的链接; url: 链接的是当前目录下content下的文件夹; weight: 表示网页部署位置 后续视个人情况修改 ✍️ 五、写第一篇文章\n在当前 根目录 下输入 hugo new posts/hello-hugo.md 使用hugo new会链接脚本创建markdown的上述链接: title: \u0026ldquo;你好 Hugo\u0026rdquo; date: 2025-04-04 draft: false 在当前md下输入\u0026lt;您的内容\u0026gt;: title: \u0026ldquo;你好 Hugo\u0026rdquo; date: 2025-04-04 draft: false 这是我的第一篇文章！我正在学习 Hugo 😊 🌐 六、本地预览网站 \u0026amp; 📁 构建 public/ 文件夹\n当前根目录下输入 hugo server -D\n使用浏览器打开，查看效果 http://localhost:1313 当你想部署网站时，运行： hugo 这条命令会生成 public/ 文件夹，它包含了 构建好的静态网页内容，可以直接部署。 你部署到网页上的内容应该是在 public/ 下\n进入 public/ 目录并初始化 Git cd public git init git remote add origin https://github.com/你的用户名/你的用户名.github.io.git git checkout -b gh-pages\n提交构建结果并推送到 gh-pages 分支 git add . git commit -m \u0026ldquo;手动部署 Hugo 页面\u0026rdquo; git push -f origin gh-pages 在 GitHub 设置 Pages 分支 打开你的 GitHub 仓库 点击菜单栏 Settings → Pages 在 Source 选项中选择： 分支：gh-pages 目录：/(root) 保存并等待 GitHub 自动生成网页（几分钟内）tu 🚀 七、部署到 GitHub Pages（使用 Actions 自动部署）\n初始化 git 并推送到 GitHub 在根目录下 git init git add . git commit -m \u0026ldquo;first commit\u0026rdquo; git branch -M main git remote add origin git@github.com:你的用户名/你的用户名.github.io.git git push -u origin main ⚠️ 如果你使用的是 HTTPS，请把 git@github.com… 改为 https://github.com/你的用户名/你的用户名.github.io.git 2. 添加部署工作流 创建文件 (在根目录下).github/workflows/deploy.yml：(注意 .github 的文件夹也是自己创建的) 复制一下内容到 deploy.yml 下 name: Deploy Hugo site to GitHub Pages\non: push: branches: - main # 👈 每次推送到 main 分支就会自动部署\njobs: build: runs-on: ubuntu-latest\nsteps: - name: Checkout code uses: actions/checkout@v4 - name: Setup Hugo uses: peaceiris/actions-hugo@v2 with: hugo-version: 'latest' extended: true - name: Build Hugo site run: hugo --minify - name: Deploy to GitHub Pages 🚀 uses: peaceiris/actions-gh-pages@v3 with: github_token: ${{ secrets.GITHUB_TOKEN }} publish_dir: ./public 八、总结 每次想新写内容直接\n文件存储在content下 hugo new \u0026lt;你的文件路径\u0026gt;\n本地查看 hugo server -D\n浏览器查看 http://localhost:1313\n之后直接在根目录下,注意你当前的分支应该是 main 查看分支 git branch\ngit add . git commit -m \u0026ldquo;你的日志\u0026rdquo; git push origin main 此后你写的 deploy.yml 会在 actions 下自动部署网页，无需在进入到public下再次推送静态网页 您的网页源代码在main分支下，静态部署网页代码在pulic文件夹下(也是访问您网页的代码内容) 🛠 九、自动提交脚本（可选） 若您想省去 git add . 过程，以下提供python脚本参考\n在当前 根目录 下创建auto_push.py import subprocess from datetime import datetime\ndef auto_push(): now = datetime.now().strftime(\u0026quot;%Y-%m-%d %H:%M:%S\u0026rdquo;) msg = f\u0026quot;update: {now}\u0026rdquo; subprocess.run([\u0026ldquo;git\u0026rdquo;, \u0026ldquo;add\u0026rdquo;, \u0026ldquo;.\u0026rdquo;], check=True) subprocess.run([\u0026ldquo;git\u0026rdquo;, \u0026ldquo;commit\u0026rdquo;, \u0026ldquo;-m\u0026rdquo;, msg], check=True) subprocess.run([\u0026ldquo;git\u0026rdquo;, \u0026ldquo;push\u0026rdquo;, \u0026ldquo;origin\u0026rdquo;, \u0026ldquo;main\u0026rdquo;], check=True)\nauto_push() 运行方式： python auto_push.py 🎉 恭喜！ 你已经成功在 Windows 环境下，使用 Hugo + GitHub Pages 创建并部署了自己的博客！\n","permalink":"https://Tdxxxx-student.github.io/posts/hello-hugo/","summary":"\u003cp\u003e使用Hugo 搭建博客并部署到 GitHub Pages\nApril 4, 2025\n本教程将从 0 开始，手把手教你在 Windows 系统中使用 Hugo 创建一个静态博客，并通过 GitHub Actions 自动部署到 GitHub Pages.\u003c/p\u003e\n\u003cp\u003e🧰 一、准备工作\n✅ 1. 安装 Git\n下载并安装：https://git-scm.com\n安装完成后，右键菜单应该出现 “Git Bash Here”\n验证安装：\u003c/p\u003e\n\u003ch1 id=\"打开-power-shell-检查-git-安装成功\"\u003e打开 power shell 检查 git 安装成功\u003c/h1\u003e\n\u003cp\u003egit \u0026ndash;version\n✅ 2. 安装 Hugo（建议扩展版）\n仅需在 power shell 输入\u003c/p\u003e\n\u003ch1 id=\"安装\"\u003e安装\u003c/h1\u003e\n\u003cp\u003ewinget install Hugo.Hugo.Extended\u003c/p\u003e\n\u003ch1 id=\"如需卸载\"\u003e如需卸载\u003c/h1\u003e\n\u003cp\u003ewinget uninstall \u0026ndash;name \u0026ldquo;Hugo (Extended)\u0026rdquo;\u003c/p\u003e\n\u003ch1 id=\"检查-hugo是否安装成功-重启终端-或-重启电脑\"\u003e检查 Hugo是否安装成功 (重启终端 或 重启电脑)\u003c/h1\u003e\n\u003cp\u003ehugo version\n✅ 3. 注册 GitHub 并创建仓库\nGithub 注册: \u003ca href=\"https://github.com\"\u003ehttps://github.com\u003c/a\u003e\n创建一个与你用户名相同的仓库，比如:\n\u0026lt;Github用户名\u0026gt;.github.io\ntu\u003c/p\u003e","title":"部署文章"}]