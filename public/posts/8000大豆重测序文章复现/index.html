<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>8000å¤§è±†é‡æµ‹åºæ–‡ç« å¤ç° | æˆ‘çš„ç©ºé—´</title>
<meta name="keywords" content="é‡æµ‹åº, GWAS, å˜å¼‚æ£€æµ‹">
<meta name="description" content="å€Ÿé‰´åˆ«äººçš„æ–‡ç« å¤ç°ç»“æœæµç¨‹ï¼ŒåŠ å…¥äº†ä¸€äº›å‰å¸ˆå§çš„åšæ³•è„šæœ¬ä½¿ç”¨ï¼Œæé«˜è®¡ç®—è¿è¡Œæ•ˆç‡ï¼Œå¹¶ç”¨è¯¥æµç¨‹å°è¯•å¤ç°ä¸€ç¯‡ngï¼š31ç§å¤§è±†é‡æµ‹åºæ–‡ç« ã€‚">
<meta name="author" content="tdx">
<link rel="canonical" href="https://Tdxxxx-student.github.io/posts/8000%E5%A4%A7%E8%B1%86%E9%87%8D%E6%B5%8B%E5%BA%8F%E6%96%87%E7%AB%A0%E5%A4%8D%E7%8E%B0/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.01d35acdbbaa1404939950eac1b15ada4d2a087b51757e85aec3659df639bc28.css" integrity="sha256-AdNazbuqFASTmVDqwbFa2k0qCHtRdX6FrsNlnfY5vCg=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://Tdxxxx-student.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://Tdxxxx-student.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://Tdxxxx-student.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://Tdxxxx-student.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://Tdxxxx-student.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://Tdxxxx-student.github.io/posts/8000%E5%A4%A7%E8%B1%86%E9%87%8D%E6%B5%8B%E5%BA%8F%E6%96%87%E7%AB%A0%E5%A4%8D%E7%8E%B0/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><link rel="stylesheet" href="https://Tdxxxx-student.github.io/css/custom.css"><meta property="og:url" content="https://Tdxxxx-student.github.io/posts/8000%E5%A4%A7%E8%B1%86%E9%87%8D%E6%B5%8B%E5%BA%8F%E6%96%87%E7%AB%A0%E5%A4%8D%E7%8E%B0/">
  <meta property="og:site_name" content="æˆ‘çš„ç©ºé—´">
  <meta property="og:title" content="8000å¤§è±†é‡æµ‹åºæ–‡ç« å¤ç°">
  <meta property="og:description" content="å€Ÿé‰´åˆ«äººçš„æ–‡ç« å¤ç°ç»“æœæµç¨‹ï¼ŒåŠ å…¥äº†ä¸€äº›å‰å¸ˆå§çš„åšæ³•è„šæœ¬ä½¿ç”¨ï¼Œæé«˜è®¡ç®—è¿è¡Œæ•ˆç‡ï¼Œå¹¶ç”¨è¯¥æµç¨‹å°è¯•å¤ç°ä¸€ç¯‡ngï¼š31ç§å¤§è±†é‡æµ‹åºæ–‡ç« ã€‚">
  <meta property="og:locale" content="zh-cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-02-05T14:53:16+08:00">
    <meta property="article:modified_time" content="2026-02-05T14:53:16+08:00">
    <meta property="article:tag" content="é‡æµ‹åº">
    <meta property="article:tag" content="GWAS">
    <meta property="article:tag" content="å˜å¼‚æ£€æµ‹">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="8000å¤§è±†é‡æµ‹åºæ–‡ç« å¤ç°">
<meta name="twitter:description" content="å€Ÿé‰´åˆ«äººçš„æ–‡ç« å¤ç°ç»“æœæµç¨‹ï¼ŒåŠ å…¥äº†ä¸€äº›å‰å¸ˆå§çš„åšæ³•è„šæœ¬ä½¿ç”¨ï¼Œæé«˜è®¡ç®—è¿è¡Œæ•ˆç‡ï¼Œå¹¶ç”¨è¯¥æµç¨‹å°è¯•å¤ç°ä¸€ç¯‡ngï¼š31ç§å¤§è±†é‡æµ‹åºæ–‡ç« ã€‚">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://Tdxxxx-student.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "8000å¤§è±†é‡æµ‹åºæ–‡ç« å¤ç°",
      "item": "https://Tdxxxx-student.github.io/posts/8000%E5%A4%A7%E8%B1%86%E9%87%8D%E6%B5%8B%E5%BA%8F%E6%96%87%E7%AB%A0%E5%A4%8D%E7%8E%B0/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "8000å¤§è±†é‡æµ‹åºæ–‡ç« å¤ç°",
  "name": "8000å¤§è±†é‡æµ‹åºæ–‡ç« å¤ç°",
  "description": "å€Ÿé‰´åˆ«äººçš„æ–‡ç« å¤ç°ç»“æœæµç¨‹ï¼ŒåŠ å…¥äº†ä¸€äº›å‰å¸ˆå§çš„åšæ³•è„šæœ¬ä½¿ç”¨ï¼Œæé«˜è®¡ç®—è¿è¡Œæ•ˆç‡ï¼Œå¹¶ç”¨è¯¥æµç¨‹å°è¯•å¤ç°ä¸€ç¯‡ngï¼š31ç§å¤§è±†é‡æµ‹åºæ–‡ç« ã€‚",
  "keywords": [
    "é‡æµ‹åº", "GWAS", "å˜å¼‚æ£€æµ‹"
  ],
  "articleBody": "8000ä»½å¤§è±†é‡æµ‹åºæ•°æ®åˆ†ææµç¨‹ ç›®å½• åˆ†ææµç¨‹æ€»è§ˆ æ•°æ®åˆ†æå…·ä½“æµç¨‹ ä¸€ã€æ•°æ®è´¨æ§ äºŒã€åºåˆ—æ¯”å¯¹ ä¸‰ã€å˜å¼‚æ£€æµ‹ å››ã€å˜å¼‚æ³¨é‡Š å›¾è¡¨åˆ¶ä½œ ä¸€ã€ç¾¤ä½“é—ä¼ å­¦åˆ†æ äºŒã€è¿é”ä¸å¹³è¡¡åˆ†æ ä¸‰ã€æ ¸è‹·é…¸å¤šæ ·æ€§åˆ†æ å››ã€å›ºå®šæŒ‡æ•° (FST) äº”ã€é€‰æ‹©æ¸…é™¤åˆ†æ å…­ã€å…¨åŸºå› ç»„å…³è”åˆ†æ (GWAS) ä¸ƒã€å…¶ä»–åˆ†æ æ€»ç»“ åˆ†ææµç¨‹æ€»è§ˆ æ•´ä½“æµç¨‹æ¶æ„ åŸå§‹æ•°æ® (Raw Data) â†“ æ•°æ®è´¨æ§ (Quality Control) â†“ æ¯”å¯¹åˆ°å‚è€ƒåŸºå› ç»„ (Alignment) â†“ å˜å¼‚æ£€æµ‹ (Variant Detection) â†“ å˜å¼‚æ³¨é‡Š (Variant Annotation) â†“ è¿›åŒ–å’Œç¾¤ä½“é—ä¼ å­¦åˆ†æ (Evolutionary and Population Genetics Analysis) æ•°æ®åˆ†æå…·ä½“æµç¨‹ ä¸€ã€æ•°æ®è´¨æ§ 1. FastQC - è´¨é‡è¯„ä¼° è½¯ä»¶åŠŸèƒ½ï¼š å¯¹æµ‹åºæ•°æ®è¿›è¡Œè´¨é‡è¯„ä¼°\nåŸºæœ¬ç”¨æ³•ï¼š\nfastqc -t 8 -o /path/to/output /path/to/seq_data/*.fastq å‚æ•°è¯´æ˜ï¼š\nå‚æ•° è¯´æ˜ -t 8 ä½¿ç”¨8ä¸ªçº¿ç¨‹ -o æŒ‡å®šè¾“å‡ºç›®å½• è¾“å…¥æ–‡ä»¶ï¼š fastqæ ¼å¼çš„æµ‹åºæ•°æ®\nè¾“å‡ºç»“æœï¼š\nHTMLæ ¼å¼çš„è´¨é‡æŠ¥å‘Šæ–‡ä»¶ åŒ…å«æµ‹åºè´¨é‡åˆ†å¸ƒã€GCå«é‡ã€åºåˆ—é•¿åº¦åˆ†å¸ƒã€æ¥å¤´å«é‡ç­‰ä¿¡æ¯ 2. fastp - è´¨æ§ä¸è¿‡æ»¤ è½¯ä»¶åŠŸèƒ½ï¼š\nè´¨é‡å‰ªåˆ‡ï¼ˆquality trimmingï¼‰ è¿‡æ»¤ä½è´¨é‡reads å»æ¥å¤´ UMIï¼ˆUnique Molecular Identifierï¼‰å¤„ç† è¿‡æ»¤polyGï¼ˆIllumina NovaSeqç‰¹å¾ï¼‰ ç”ŸæˆHTMLå’ŒJSONæ ¼å¼çš„è´¨æ§æŠ¥å‘Š åŸºæœ¬ç”¨æ³•ï¼š\nfastp -i sample_R1.fq.gz -I sample_R2.fq.gz \\ -o clean_R1.fq.gz -O clean_R2.fq.gz \\ -w 8 å¸¸ç”¨å‚æ•°è¯¦è§£ï¼š\nå‚æ•° è¯´æ˜ é»˜è®¤å€¼ -i è¾“å…¥çš„R1ï¼ˆå‰å‘ï¼‰readsæ–‡ä»¶ - -I è¾“å…¥çš„R2ï¼ˆåå‘ï¼‰readsæ–‡ä»¶ - -o è¾“å‡ºçš„æ¸…æ´R1 readsæ–‡ä»¶ - -O è¾“å‡ºçš„æ¸…æ´R2 readsæ–‡ä»¶ - -w çº¿ç¨‹æ•° 2 -q è´¨é‡å€¼é˜ˆå€¼ï¼Œä½äºæ­¤å€¼çš„ç¢±åŸºå°†è¢«å‰ªåˆ‡ 15 -u ä½è´¨é‡readsç™¾åˆ†æ¯”é˜ˆå€¼ï¼Œè¶…è¿‡æ­¤æ¯”ä¾‹çš„readså°†è¢«è¿‡æ»¤ 30 -n readsé•¿åº¦é˜ˆå€¼ï¼ŒçŸ­äºæ­¤é•¿åº¦çš„readså°†è¢«è¿‡æ»¤ 0 -l ä¿ç•™çš„æœ€å°readsé•¿åº¦ 15 --detect_adapter_for_pe è‡ªåŠ¨æ£€æµ‹æ¥å¤´ï¼ˆæ¨èï¼‰ - --trim_poly_g å»é™¤polyGå°¾ï¼ˆNovaSeqæ•°æ®å¿…éœ€ï¼‰ - --poly_g_min_len è§¦å‘polyGå‰ªåˆ‡çš„æœ€å°é•¿åº¦ 10 --cut_front ä»å‰ç«¯å‰ªåˆ‡æŒ‡å®šæ•°é‡çš„ç¢±åŸº - --cut_tail ä»å°¾ç«¯å‰ªåˆ‡æŒ‡å®šæ•°é‡çš„ç¢±åŸº - --cut_mean_quality æŒ‰å¹³å‡è´¨é‡å€¼å‰ªåˆ‡ - --length_required readsæœ€å°é•¿åº¦è¦æ±‚ 15 --json è¾“å‡ºJSONæ ¼å¼è´¨æ§æŠ¥å‘Š fastp.json --html è¾“å‡ºHTMLæ ¼å¼è´¨æ§æŠ¥å‘Š fastp.html --report_title æŠ¥å‘Šæ ‡é¢˜ fastp report # æ•´ç†å‡ºsample.listï¼ŒåŒ…å«æ¯ä¸ªfastqæ ·å“åç§° ls *gz | ... \u003e sample.list # æŒ‰è‡ªå·±å‘½åæ ¼å¼æ‹†åˆ†å‡ºæ ·å“å # ç¼–å†™æ‰¹é‡è¿è¡Œè„šæœ¬ cat sample.list | while read sp ; do echo fastp -i ${sp}_1.fastq.gz -I ${sp}_2.fastq.gz -o ../cleandb/clean.${sp}_1.fastq.gz -O ../cleandb/clean.${sp}_2.fastq.gz -w 15 \u003e\u003e auto.fastp.sh;done # æ£€æŸ¥å‘½ä»¤ cat auto.fastp.sh | head -5 # è¯•è¿è¡Œä¸€ä¸ªä¼šä¸ä¼šæŠ¥é”™ï¼Œç„¶åæŒ‚åå° nohup fastp -i C01_1.fastq.gz -I C01_2.fastq.gz -o ../cleandb/clean.C01_1.fastq.gz -O ../cleandb/clean.C01_2.fastq.gz -w 15 \u0026 nohup sh auto.fastp.sh \u0026 äºŒã€åºåˆ—æ¯”å¯¹ BWA-MEM æ¯”å¯¹ è½¯ä»¶åŠŸèƒ½ï¼š å°†æ¸…æ´åçš„readsæ¯”å¯¹åˆ°å‚è€ƒåŸºå› ç»„\n2.1 å»ºç«‹å‚è€ƒåŸºå› ç»„ç´¢å¼• bwa index reference.fasta æ­¤æ­¥éª¤ä¼šç”Ÿæˆå¤šä¸ªç´¢å¼•æ–‡ä»¶ï¼ˆ.amb, .ann, .bwt, .pac, .saï¼‰\n2.2 åºåˆ—æ¯”å¯¹ bwa mem -t 8 -M reference.fasta \\ clean_R1.fq.gz clean_R2.fq.gz \\ \u003e sample.sam # æ‰¹é‡æ¯”å¯¹è„šæœ¬ #!/usr/bin/bash ref=\"Wm82.gnm6.genome.fasta\" datadir=\"/home2/xtc/workspace/soybean.project/cleandb\" # å»ºè®®å…ˆæ¸…ç©ºï¼Œé¿å…é‡å¤è¿½åŠ  : \u003e bwa.mem_s2.sh : \u003e picard_s1.sh while read -r sp; do echo \"bwa mem -t 42 \\\\ -R \\\"@RG\\\\\\tID:${sp}\\\\\\tSM:${sp}\\\\\\tPL:illumina\\\" \\\\ ${ref} \\\\ ${datadir}/clean.${sp}_1.fastq.gz \\\\ ${datadir}/clean.${sp}_2.fastq.gz \\\\ 2\u003e${sp}.bwa.log | samtools sort -@ 20 -m 8G -o ${sp}.sort.bam - \" \u003e\u003e bwa.mem_s2.sh echo \"java -Xmx120g \\\\ -XX:ParallelGCThreads=40 \\\\ -jar /pub/software/picard.jar \\\\ MarkDuplicates I=${sp}.sort.bam \\\\ O=${sp}.sort.markdup.bam \\\\ CREATE_INDEX=true REMOVE_DUPLICATES=true \\\\ M=${sp}.marked_dup_metrics.txt \" \u003e\u003e picard_s1.sh done \u003c sample.list å‚æ•°è¯´æ˜ï¼š\n-t 8ï¼šä½¿ç”¨8ä¸ªçº¿ç¨‹è¿›è¡Œæ¯”å¯¹ï¼Œæé«˜é€Ÿåº¦ -Mï¼šå°†shorter split hitsæ ‡è®°ä¸ºæ¬¡ä¼˜ï¼Œä»¥ä¾¿å…¼å®¹Picardå·¥å…· reference.fastaï¼šå‚è€ƒåŸºå› ç»„åºåˆ—æ–‡ä»¶ è¾“å…¥ï¼š æ¸…æ´åçš„R1å’ŒR2 readsï¼ˆgzipå‹ç¼©æ ¼å¼ï¼‰\nè¾“å‡ºï¼š SAMæ ¼å¼æ¯”å¯¹ç»“æœ\n2.3 SAMè½¬BAMå¹¶æ’åº # SAMè½¬BAMï¼ˆå‹ç¼©æ ¼å¼ï¼‰ samtools view -Sb sample.sam \u003e sample.bam # å¯¹BAMæ–‡ä»¶è¿›è¡Œæ’åº samtools sort sample.bam -o sample.sorted.bam # å»ºç«‹ç´¢å¼•ï¼Œä¾¿äºåç»­å¿«é€Ÿè®¿é—® samtools index sample.sorted.bam 2.4 æ ‡è®°PCRé‡å¤ # ä½¿ç”¨Picardæ ‡è®°é‡å¤ picard MarkDuplicates \\ I=sample.sorted.bam \\ O=sample.dedup.bam \\ M=metrics.txt # å»ºç«‹ç´¢å¼• samtools index sample.dedup.bam å‚æ•°è¯´æ˜ï¼š\nI=ï¼šè¾“å…¥æ–‡ä»¶ O=ï¼šè¾“å‡ºæ–‡ä»¶ M=ï¼šè¾“å‡ºé‡å¤ç»Ÿè®¡ä¿¡æ¯ 2.5 æ·»åŠ Read Groupsä¿¡æ¯ï¼ˆå¯é€‰ä½†æ¨èï¼‰,bwa mamè„šæœ¬ä¸­å·²å®ç°ã€‚ gatk AddOrReplaceReadGroups \\ -I sample.dedup.bam \\ -O sample.rg.bam \\ -RGID id1 \\ -RGLB lib1 \\ -RGPL illumina \\ -RGPU unit1 \\ -RGSM sample1 å‚æ•°è¯´æ˜ï¼š\n-RGIDï¼šRead Group ID -RGLBï¼šLibraryåç§° -RGPLï¼šæµ‹åºå¹³å°ï¼ˆillumina, iontorrentç­‰ï¼‰ -RGPUï¼šæµ‹åºå•å…ƒ -RGSMï¼šæ ·æœ¬åç§° ä¸‰ã€å˜å¼‚æ£€æµ‹ GATK Best Practices æµç¨‹ GATKï¼ˆGenome Analysis Toolkitï¼‰æ˜¯ç›®å‰æœ€å¹¿æ³›ä½¿ç”¨çš„å˜å¼‚æ£€æµ‹è½¯ä»¶ä¹‹ä¸€ã€‚ è¦æ³¨æ„ä¸ä¹‹é€‚é…çš„javaç‰ˆæœ¬\n# æ¿€æ´»ç¯å¢ƒ mamba activate reseq # æŒ‡å®šç”¨æœ¬ç¯å¢ƒçš„java echo $CONDA_PREFIX export JAVA_HOME=$CONDA_PREFIX export PATH=$JAVA_HOME/bin:$PATH # æµ‹è¯•å¯ç”¨ gatk GenotypeGVCFs --help å»ºç«‹ç´¢å¼•(å¦åˆ™ä¼šè¿è¡Œå¤±è´¥ï¼Œä¸ä¼šç”Ÿæˆvcfæ–‡ä»¶) samtools faidx Wm82.gnm6.genome.fasta gatk CreateSequenceDictionary \\ -R Wm82.gnm6.genome.fasta \\ -O Wm82.gnm6.genome.dict 3.1 HaplotypeCaller - å•æ ·æœ¬å˜å¼‚æ£€æµ‹ åŸºæœ¬ç”¨æ³•ï¼ˆGVCFæ¨¡å¼ï¼‰ï¼š\ngatk HaplotypeCaller \\ -R reference.fasta \\ -I sample.dedup.bam \\ -O sample.g.vcf.gz \\ -ERC GVCF å‚æ•°è¯´æ˜ï¼š\n-Rï¼šå‚è€ƒåŸºå› ç»„fastaæ–‡ä»¶ -Iï¼šè¾“å…¥çš„BAMæ–‡ä»¶ -Oï¼šè¾“å‡ºçš„gVCFæ–‡ä»¶ï¼ˆgzipå‹ç¼©ï¼‰ -ERC GVCFï¼šäº§ç”ŸGVCFæ ¼å¼ï¼Œç”¨äºåç»­è”åˆåˆ†æ GVCFæ¨¡å¼ä¼šè®°å½•æ‰€æœ‰ä½ç‚¹çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å˜å¼‚ä½ç‚¹å’Œéå˜å¼‚ä½ç‚¹ï¼Œä¾¿äºåç»­å¤šæ ·æœ¬è”åˆåˆ†æã€‚\n# æ‰¹é‡æ£€æµ‹è„šæœ¬ï¼Œå¯åˆ†ä¸åŒæŸ“è‰²ä½“ï¼Œæé«˜è¿ç®—æ•ˆç‡ # åˆ›å»ºæŸ“è‰²ä½“list ï¼ˆä¿æŒå‚è€ƒåŸºå› ç»„å’Œbamæ–‡ä»¶æŸ“è‰²ä½“å‘½åä¸€è‡´ï¼‰ for i in $(seq 1 20); do \u003e echo \"xxGm${i}\" \u003e\u003e chr.list \u003e done # è„šæœ¬å†…å®¹ step1.mk.HaplotypeCaller.sh 3.2 CombineGVCFs - åˆå¹¶å¤šä¸ªgVCF gatk CombineGVCFs \\ -R reference.fasta \\ --variant sample1.g.vcf.gz \\ --variant sample2.g.vcf.gz \\ --variant sample3.g.vcf.gz \\ ... \\ -O cohort.g.vcf.gz æ‰¹å¤„ç†ç¤ºä¾‹ï¼š\n# åˆ›å»ºvariantåˆ—è¡¨æ–‡ä»¶ ls *.g.vcf.gz \u003e variant_list.txt # åˆå¹¶ gatk CombineGVCFs \\ -R reference.fasta \\ --variant sample1.g.vcf.gz \\ --variant sample2.g.vcf.gz \\ -O cohort.g.vcf.gz 3.3 GenotypeGVCFs - è”åˆåŸºå› åˆ†å‹ gatk GenotypeGVCFs \\ -R reference.fasta \\ -V cohort.g.vcf.gz \\ -O cohort.vcf.gz é‡‡å–å…ˆåˆ†å‹å†åˆå¹¶ç­–ç•¥ï¼Œæé«˜æ•ˆç‡ # åˆ›å»ºgvcf.chr.list,ä¸€åˆ—ä¸ºä¸åŒæ ·å“çš„åŒä¸€æŸ“è‰²ä½“çš„vcfæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œä¿æŒæŸ“è‰²ä½“listæ–‡ä»¶å‘½åå’Œä½¿ç”¨æŸ“è‰²ä½“å‘½åä¸€è‡´ï¼Œå¦åˆ™åé¢è„šæœ¬è¦ä¿®æ”¹ find \"$PWD\" -type f -name \"*.Chr1.g.vcf.gz\" -exec realpath {} \\; | sort \u003e Chr1.gvcf.list # æ‰¹é‡ç”Ÿæˆè„šæœ¬ gvcf.allchr.sh #ï¼/usr/bin/bash for i in $(seq -w 1 20); do gm=\"Gm${i}\" find \"$PWD\" -type f -name \"*.${gm}.g.vcf.gz\" -exec realpath {} \\; \\ | sort \u003e \"${gm}.gvcf.list\" done # CombineGVCFs,æ±‡æ€»å•æ¡æŸ“è‰²ä½“ # è„šæœ¬ ï¼ˆè¿è¡Œå¾ˆæ…¢ï¼Œå¯ä»¥å°è¯•æ‹†åˆ†å‘½ä»¤å¹¶è¡Œè¿è¡Œï¼‰ï¼Œä¸€æ¡å¤§çº¦4å†…å­˜ #!/bin/bash ref=Wm82.gnm6.genome.fasta cat chr.list |while read chr; do echo \"gatk CombineGVCFs -R $ref -V gvcf.$chr.list -O $chr.g.vcf.gz 1\u003e $chr.CombineGVCFs.log 2\u003e\u00261\" \u003e\u003e s2.CombineGVCFs.sh ; done # enotypeGVCFsåˆ†å‹ # åˆ›å»ºè„šæœ¬step3.GenotypeGVCFs_gvcf.sh #!/bin/bash ref=Wm82.gnm6.genome.fasta cat chr.list |while read chr; do echo \"gatk GenotypeGVCFs -R $ref -V $chr.g.vcf.gz -O $chr.raw.vcf.gz 1\u003e $chr.GenotypeGVCFs.log 2\u003e\u00261 \u0026\" \u003e\u003e s3.GenotypeGVCFs.sh ; done # åˆå¹¶æ‰€æœ‰æ ·å“çš„vcf # s4.MergeVcfs_allsp.sh #!/bin/bash ref=Wm82.gnm6.genome.fasta awk '{print $1\".raw.vcf.gz\"}' chr.list \u003e raw_vcf.list gatk MergeVcfs -I raw_vcf.list -O all.merge_raw.vcf # æ‹†åˆ†snpå’Œindelï¼ŒåŒæ—¶è¿›è¡Œç¡¬è¿‡æ»¤ # s5.hardfil.sh ref=Wm82.gnm6.genome.fasta rawvcf=all.merge_raw.vcf rawsnp=raw.SNP.vcf rawindel=raw.indel.vcf gatk SelectVariants -R $ref -V $rawvcf --select-type INDEL -O raw.indel.vcf gatk SelectVariants -R $ref -V $rawvcf --select-type SNP -O raw.SNP.vcf gatk VariantFiltration \\ -R $ref -V $rawsnp \\ --filter-expression \"QD \u003c 2.0 || FS \u003e 60.0 || MQ \u003c 40.0 || MQRankSum \u003c -12.5 || ReadPosRankSum \u003c -8.0\" \\ --filter-name 'SNP_filter' -O filter.snp.vcf #æå–è¿‡æ»¤åçš„snp gatk SelectVariants \\ -R $ref -V filter.snp.vcf \\ --exclude-filtered -O filtered.snp.vcf 1\u003efiltersnp.e5.log 2\u003e\u00261 gatk VariantFiltration -R $ref -V $rawindel \\ --filter-expression \"QD \u003c 2.0 || FS \u003e 200.0 || MQRankSum \u003c -12.5 || ReadPosRankSum \u003c -8.0\" \\ --filter-name 'INDEL_filter' \\ -O filter.indel.vcf gatk SelectVariants \\ -R $ref -V filter.indel.vcf \\ --exclude-filtered -O filtered.indel.vcf 1\u003efilterindel1.e5.log 2\u003e\u00261 3.4 VariantFiltration - å˜å¼‚è¿‡æ»¤ SNPè¿‡æ»¤æ ‡å‡†ï¼š\ngatk VariantFiltration \\ -R reference.fasta \\ -V cohort.vcf.gz \\ -O cohort.filtered.vcf.gz \\ --filter-name \"QD_filter\" --filter-expression \"QD \u003c 2.0\" \\ --filter-name \"FS_filter\" --filter-expression \"FS \u003e 60.0\" \\ --filter-name \"MQ_filter\" --filter-expression \"MQ \u003c 40.0\" \\ --filter-name \"MQRankSum_filter\" --filter-expression \"MQRankSum \u003c -12.5\" \\ --filter-name \"ReadPosRankSum_filter\" --filter-expression \"ReadPosRankSum \u003c -8.0\" InDelè¿‡æ»¤æ ‡å‡†ï¼š\ngatk VariantFiltration \\ -R reference.fasta \\ -V cohort.vcf.gz \\ -O cohort.indel.filtered.vcf.gz \\ --filter-name \"QD_filter\" --filter-expression \"QD \u003c 2.0\" \\ --filter-name \"FS_filter\" --filter-expression \"FS \u003e 200.0\" \\ --filter-name \"ReadPosRankSum_filter\" --filter-expression \"ReadPosRankSum \u003c -20.0\" è¿‡æ»¤æŒ‡æ ‡è¯´æ˜ï¼š\næŒ‡æ ‡ å…¨ç§° è¯´æ˜ SNPé˜ˆå€¼ InDelé˜ˆå€¼ QD QualByDepth æ¯æ·±åº¦è´¨é‡åˆ†æ•° \u003c 2.0 \u003c 2.0 FS FisherStrand é“¾åå‘æ€§ \u003e 60.0 \u003e 200.0 MQ RMSMappingQuality æ ¹å‡æ–¹æ˜ å°„è´¨é‡ \u003c 40.0 - MQRankSum MappingQualityRankSumTest æ˜ å°„è´¨é‡ç§©å’Œæ£€éªŒ \u003c -12.5 - ReadPosRankSum ReadPositionRankSumTest Readä½ç½®ç§©å’Œæ£€éªŒ \u003c -8.0 \u003c -20.0 SOR StrandOddsRatio é“¾æ¯”å€¼ \u003e 3.0 \u003e 10.0 3.5 SelectVariants - æå–é«˜è´¨é‡å˜å¼‚ gatk SelectVariants \\ -R reference.fasta \\ -V cohort.filtered.vcf.gz \\ --exclude-filtered \\ -O cohort.high_quality.vcf.gz 3.6 åˆ†åˆ«æå–SNPå’ŒInDel æå–SNPï¼š\ngatk SelectVariants \\ -V cohort.high_quality.vcf.gz \\ -select-type SNP \\ -O cohort.snp.vcf.gz æå–InDelï¼š\ngatk SelectVariants \\ -V cohort.high_quality.vcf.gz \\ -select-type INDEL \\ -O cohort.indel.vcf.gz å¯é€‰å·¥ä½œï¼ŒSVå’ŒCNV # å»ºç«‹æ’åºå»é‡bamæ–‡ä»¶åˆ—è¡¨ï¼ˆå¥½åƒç”¨ä¸ä¸Šï¼‰ find \"$PWD\" -type f -name \"*.sort.markdup.bam\" -exec realpath {} \\; | sort \u003e sort.markdup.bam.list # SVæ£€æµ‹ # 1 æ‰¹é‡æå–discordants readsè„šæœ¬ cat sample.list | while read sp; do echo \"samtools view -b -F 1294 -@ 30 ${sp}.sort.markdup.bam \u003e ${sp}.discordants.bam \"\u003e\u003e s1_discordants.sh; done nohub s1_discordants.sh \u0026 # 2 æå– split reads,ä½¿ç”¨lumpy cat sample.list | while read sp; do echo \"samtools view -h ${sp}.sort.markdup.bam | extractSplitReads_BwaMem -i stdin | samtools sort - \u003e ${sp}.splitters.bam\" \u003e\u003e s2_split.reads.sh ; done # å•çº¿ç¨‹æ…¢ï¼Œå› æ­¤è°ƒæ•´çº¿ç¨‹å’Œå¹¶è¡Œæ•°ç›® \u003e s2_split.reads.sh cat sample.list | while read sp; do echo \"samtools view -@ 4 -h ${sp}.sort.markdup.bam | extractSplitReads_BwaMem -i stdin | samtools sort -@ 4 - \u003e ${sp}.splitters.bam\" done \u003e s2_split.reads.sh nohup parallel -j 10 \u003c s2_split.reads.sh \u003e s2_split.log 2\u003e\u00261 \u0026 # 3 è¿è¡Œ lumpy # æ‰¹é‡è¾“å…¥æ–‡ä»¶è„šæœ¬ s3_lumpy.sh # åˆå§‹åŒ–ç©ºå˜é‡ B_files=\"\" S_files=\"\" D_files=\"\" # å¾ªç¯æ‹¼æ¥ while read sp; do B_files=\"${B_files},${sp}.sort.markdup.bam\" S_files=\"${S_files},${sp}.splitters.bam\" D_files=\"${D_files},${sp}.discordants.bam\" done \u003c sample.list # å»æ‰å¼€å¤´å¤šä½™çš„é€—å· B_files=${B_files#,} S_files=${S_files#,} D_files=${D_files#,} # è¿è¡Œ lumpyexpress lumpyexpress \\ -B ${B_files} \\ -S ${S_files} \\ -D ${D_files} \\ -o all.sv.lumpy.vcf nohup bash s3_lumpy.sh \u003e s3_lumpy.log 2\u003e\u00261 \u0026 # 4 ä¸ªä½“åŸºå› å‹åˆ†å‹ cat sample.list | while read sp; do echo \"vcftools --vcf all.sv.lumpy.vcf --indv ${sp} --recode --recode-INFO-all --out ${sp} \u0026\u0026 \\ svtyper -i ${sp}.recode.vcf -B ${sp}.sort.markdup.bam -o ${sp}.genotype.vcf\" \u003e\u003e s4_genotype.split.sh \\ done nohup parallel -j 10 \u003c s4_genotype.split.sh \u003e s4_genotype.split.log 2\u003e\u00261 \u0026 # CNVæ£€æµ‹ seqkit split -i Wm82.gnm6.genome.fasta -O split # è‹¥splitæ–‡ä»¶å¤¹é‡Œçš„æŸ“è‰²ä½“æ–‡ä»¶å‘½åä¹±ç ï¼Œä¿®æ”¹è‡³æ­£å¸¸ # ç”¨ rename æˆ– for å¾ªç¯å»æ‰å•å¼•å·å’ŒTab for f in *; do # å»æ‰å•å¼•å·ï¼ŒæŠŠTabæ›¿æ¢æˆç‚¹å· newname=$(echo \"$f\" | tr -d \"'\" | tr '\\t' '.') if [ \"$f\" != \"$newname\" ]; then mv -- \"$f\" \"$newname\" fi done # ç”Ÿæˆé‡å‘½åè„šæœ¬ # å»æ‰ Wm82.gnm6.genome.part_ å‰ç¼€ ls ./split/*.fasta | sed 's|./split/Wm82.gnm6.genome.part_||' | \\ sed 's|\\.fasta||' | \\ awk '{print \"mv ./split/Wm82.gnm6.genome.part_\"$1\".fasta ./split/\"$1\".fasta\"}' \u003e mv_name.sh # æ£€æŸ¥ cat mv_name.sh # æ‰§è¡Œ bash mv_name.sh # ç”Ÿæˆæ£€æµ‹è„šæœ¬ # æ¯ä¸ªæ ·æœ¬ç”Ÿæˆä¸€ä¸ªç‹¬ç«‹è„šæœ¬ cat sample.list | while read sp; do echo \"cnvnator -genome Wm82.gnm6.genome.fasta -root ${sp}.root -tree ${sp}.sort.markdup.bam \u0026\u0026 \\ cnvnator -genome Wm82.gnm6.genome.fasta -root ${sp}.root -his 500 -d split \u0026\u0026 \\ cnvnator -root ${sp}.root -stat 500 \u0026\u0026 \\ cnvnator -root ${sp}.root -eval 500 \u003e ${sp}.eval.ratio \u0026\u0026 \\ cnvnator -root ${sp}.root -partition 500 \u0026\u0026 \\ cnvnator -root ${sp}.root -call 500 \u003e ${sp}.cnv\" done \u003e s_cnvnator_parallel.sh # ä»ä¸Šå¾€ä¸‹ä¾æ¬¡æ˜¯æå–æ¯”å¯¹ç»“æœï¼Œç”Ÿæˆæ·±åº¦åˆ†å¸ƒï¼Œæ£€æŸ¥bin sizeæ˜¯å¦åˆé€‚ï¼ŒRDä¿¡å·åˆ†å‰²ï¼Œè¿›è¡ŒCNVæ£€æµ‹ # å¤šæ ·æœ¬åŒæ—¶è·‘ï¼ˆ5ä¸ªæ ·æœ¬å¹¶è¡Œï¼‰ï¼ˆçº¿ç¨‹å¯èƒ½ä¼šçˆ†ï¼‰ nohup parallel -j 5 \u003c s_cnvnator_parallel.sh \u003e cnvnator.log 2\u003e\u00261 \u0026 å››ã€å˜å¼‚æ³¨é‡Š ANNOVAR æ³¨é‡Šæµç¨‹ è½¯ä»¶åŠŸèƒ½ï¼š å¯¹æ£€æµ‹åˆ°çš„å˜å¼‚è¿›è¡ŒåŠŸèƒ½æ³¨é‡Šï¼Œé¢„æµ‹å˜å¼‚å¯¹åŸºå› åŠŸèƒ½çš„å½±å“\n4.1 å‡†å¤‡å·¥ä½œ ä¸‹è½½æ³¨é‡Šæ•°æ®åº“ï¼š\n# å»ºç«‹æ•°æ®åº“ç›®å½• mkdir humandb/ # ä¸‹è½½RefSeqåŸºå› æ•°æ®åº“ annotate_variation.pl -buildver dm6 \\ -downdb -webfrom annovar \\ refGene humandb/ # ä¸‹è½½dbNSFPæ•°æ®åº“ï¼ˆåŒ…å«å¤šä¸ªåŠŸèƒ½é¢„æµ‹å·¥å…·çš„ç»“æœï¼‰ annotate_variation.pl -buildver dm6 \\ -downdb -webfrom annovar \\ dbnsfp42a humandb/ # å…¶ä»–å¸¸ç”¨æ•°æ®åº“ annotate_variation.pl -buildver dm6 \\ -downdb -webfrom annovar \\ gnomad_genome humandb/ éæ¨¡å¼ç‰©ç§éœ€è¦è½¬æ¢gff/gtfæ ¼å¼ä¸ºGenePredæ ¼å¼ UCSCè½¯ä»¶åº“æŸ¥æ‰¾ ",
  "wordCount" : "12348",
  "inLanguage": "en",
  "datePublished": "2026-02-05T14:53:16+08:00",
  "dateModified": "2026-02-05T14:53:16+08:00",
  "author":{
    "@type": "Person",
    "name": "tdx"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://Tdxxxx-student.github.io/posts/8000%E5%A4%A7%E8%B1%86%E9%87%8D%E6%B5%8B%E5%BA%8F%E6%96%87%E7%AB%A0%E5%A4%8D%E7%8E%B0/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "æˆ‘çš„ç©ºé—´",
    "logo": {
      "@type": "ImageObject",
      "url": "https://Tdxxxx-student.github.io/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://Tdxxxx-student.github.io/" accesskey="h" title="æˆ‘çš„ç©ºé—´ (Alt + H)">æˆ‘çš„ç©ºé—´</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://Tdxxxx-student.github.io/posts/" title="é¦–é¡µ">
                    <span>é¦–é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://Tdxxxx-student.github.io/archives/" title="å½’æ¡£">
                    <span>å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="https://Tdxxxx-student.github.io/categories/" title="åˆ†ç±»">
                    <span>åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="https://Tdxxxx-student.github.io/tags/" title="æ ‡ç­¾">
                    <span>æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://Tdxxxx-student.github.io/search/" title="ğŸ”  (Alt &#43; /)" accesskey=/>
                    <span>ğŸ” </span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">


<div id="wide-post-layout" class="post-page-wrapper">
  
  <div class="top-banner-decoration"></div>

  <div class="page-layout">
    
    <article class="post-card">
      <header class="post-header"><div class="breadcrumbs"><a href="https://Tdxxxx-student.github.io/">Home</a>&nbsp;Â»&nbsp;<a href="https://Tdxxxx-student.github.io/posts/">Posts</a></div>
        <h1 class="post-title">8000å¤§è±†é‡æµ‹åºæ–‡ç« å¤ç°</h1>
        <div class="post-description">å€Ÿé‰´åˆ«äººçš„æ–‡ç« å¤ç°ç»“æœæµç¨‹ï¼ŒåŠ å…¥äº†ä¸€äº›å‰å¸ˆå§çš„åšæ³•è„šæœ¬ä½¿ç”¨ï¼Œæé«˜è®¡ç®—è¿è¡Œæ•ˆç‡ï¼Œå¹¶ç”¨è¯¥æµç¨‹å°è¯•å¤ç°ä¸€ç¯‡ngï¼š31ç§å¤§è±†é‡æµ‹åºæ–‡ç« ã€‚</div>
        <div class="post-meta"><span title='2026-02-05 14:53:16 +0800 CST'>2026-02-05</span>&nbsp;Â·&nbsp;<span>25 min</span>&nbsp;Â·&nbsp;<span>tdx</span></div>
      </header>

      <div class="post-content"><h1 id="8000ä»½å¤§è±†é‡æµ‹åºæ•°æ®åˆ†ææµç¨‹">8000ä»½å¤§è±†é‡æµ‹åºæ•°æ®åˆ†ææµç¨‹<a hidden class="anchor" aria-hidden="true" href="#8000ä»½å¤§è±†é‡æµ‹åºæ•°æ®åˆ†ææµç¨‹">#</a></h1>
<h2 id="ç›®å½•">ç›®å½•<a hidden class="anchor" aria-hidden="true" href="#ç›®å½•">#</a></h2>
<ul>
<li><a href="#%E5%88%86%E6%9E%90%E6%B5%81%E7%A8%8B%E6%80%BB%E8%A7%88">åˆ†ææµç¨‹æ€»è§ˆ</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%85%B7%E4%BD%93%E6%B5%81%E7%A8%8B">æ•°æ®åˆ†æå…·ä½“æµç¨‹</a>
<ul>
<li><a href="#%E4%B8%80%E6%95%B0%E6%8D%AE%E8%B4%A8%E6%8E%A7">ä¸€ã€æ•°æ®è´¨æ§</a></li>
<li><a href="#%E4%BA%8C%E5%BA%8F%E5%88%97%E6%AF%94%E5%AF%B9">äºŒã€åºåˆ—æ¯”å¯¹</a></li>
<li><a href="#%E4%B8%89%E5%8F%98%E5%BC%82%E6%A3%80%E6%B5%8B">ä¸‰ã€å˜å¼‚æ£€æµ‹</a></li>
<li><a href="#%E5%9B%9B%E5%8F%98%E5%BC%82%E6%B3%A8%E9%87%8A">å››ã€å˜å¼‚æ³¨é‡Š</a></li>
</ul>
</li>
<li><a href="#%E5%9B%BE%E8%A1%A8%E5%88%B6%E4%BD%9C">å›¾è¡¨åˆ¶ä½œ</a>
<ul>
<li><a href="#%E4%B8%80%E7%BE%A4%E4%BD%93%E9%81%97%E4%BC%A0%E5%AD%A6%E5%88%86%E6%9E%90">ä¸€ã€ç¾¤ä½“é—ä¼ å­¦åˆ†æ</a></li>
<li><a href="#%E4%BA%8C%E8%BF%9E%E9%94%81%E4%B8%8D%E5%B9%B3%E8%A1%A1%E5%88%86%E6%9E%90">äºŒã€è¿é”ä¸å¹³è¡¡åˆ†æ</a></li>
<li><a href="#%E4%B8%89%E6%A0%B8%E8%8B%B7%E9%85%B8%E5%A4%9A%E6%A0%B7%E6%80%A7%E5%88%86%E6%9E%90">ä¸‰ã€æ ¸è‹·é…¸å¤šæ ·æ€§åˆ†æ</a></li>
<li><a href="#%E5%9B%9B%E5%9B%BA%E5%AE%9A%E6%8C%87%E6%95%B0-fst">å››ã€å›ºå®šæŒ‡æ•° (FST)</a></li>
<li><a href="#%E4%BA%94%E9%80%89%E6%8B%A9%E6%B8%85%E9%99%A4%E5%88%86%E6%9E%90">äº”ã€é€‰æ‹©æ¸…é™¤åˆ†æ</a></li>
<li><a href="#%E5%85%AD%E5%85%A8%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%85%B3%E8%81%94%E5%88%86%E6%9E%90-gwas">å…­ã€å…¨åŸºå› ç»„å…³è”åˆ†æ (GWAS)</a></li>
<li><a href="#%E4%B8%83%E5%85%B6%E4%BB%96%E5%88%86%E6%9E%90">ä¸ƒã€å…¶ä»–åˆ†æ</a></li>
</ul>
</li>
<li><a href="#%E6%80%BB%E7%BB%93">æ€»ç»“</a></li>
</ul>
<hr>
<h2 id="åˆ†ææµç¨‹æ€»è§ˆ">åˆ†ææµç¨‹æ€»è§ˆ<a hidden class="anchor" aria-hidden="true" href="#åˆ†ææµç¨‹æ€»è§ˆ">#</a></h2>
<h3 id="æ•´ä½“æµç¨‹æ¶æ„">æ•´ä½“æµç¨‹æ¶æ„<a hidden class="anchor" aria-hidden="true" href="#æ•´ä½“æµç¨‹æ¶æ„">#</a></h3>
<pre tabindex="0"><code>åŸå§‹æ•°æ® (Raw Data)
    â†“
æ•°æ®è´¨æ§ (Quality Control)
    â†“
æ¯”å¯¹åˆ°å‚è€ƒåŸºå› ç»„ (Alignment)
    â†“
å˜å¼‚æ£€æµ‹ (Variant Detection)
    â†“
å˜å¼‚æ³¨é‡Š (Variant Annotation)
    â†“
è¿›åŒ–å’Œç¾¤ä½“é—ä¼ å­¦åˆ†æ (Evolutionary and Population Genetics Analysis)
</code></pre><hr>
<h2 id="æ•°æ®åˆ†æå…·ä½“æµç¨‹">æ•°æ®åˆ†æå…·ä½“æµç¨‹<a hidden class="anchor" aria-hidden="true" href="#æ•°æ®åˆ†æå…·ä½“æµç¨‹">#</a></h2>
<h3 id="ä¸€æ•°æ®è´¨æ§">ä¸€ã€æ•°æ®è´¨æ§<a hidden class="anchor" aria-hidden="true" href="#ä¸€æ•°æ®è´¨æ§">#</a></h3>
<h4 id="1-fastqc---è´¨é‡è¯„ä¼°">1. FastQC - è´¨é‡è¯„ä¼°<a hidden class="anchor" aria-hidden="true" href="#1-fastqc---è´¨é‡è¯„ä¼°">#</a></h4>
<p><strong>è½¯ä»¶åŠŸèƒ½ï¼š</strong> å¯¹æµ‹åºæ•°æ®è¿›è¡Œè´¨é‡è¯„ä¼°</p>
<p><strong>åŸºæœ¬ç”¨æ³•ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">fastqc -t <span class="m">8</span> -o /path/to/output /path/to/seq_data/*.fastq
</span></span></code></pre></div><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p>
<table>
  <thead>
      <tr>
          <th>å‚æ•°</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>-t 8</code></td>
          <td>ä½¿ç”¨8ä¸ªçº¿ç¨‹</td>
      </tr>
      <tr>
          <td><code>-o</code></td>
          <td>æŒ‡å®šè¾“å‡ºç›®å½•</td>
      </tr>
  </tbody>
</table>
<p><strong>è¾“å…¥æ–‡ä»¶ï¼š</strong> fastqæ ¼å¼çš„æµ‹åºæ•°æ®</p>
<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>
<ul>
<li>HTMLæ ¼å¼çš„è´¨é‡æŠ¥å‘Šæ–‡ä»¶</li>
<li>åŒ…å«æµ‹åºè´¨é‡åˆ†å¸ƒã€GCå«é‡ã€åºåˆ—é•¿åº¦åˆ†å¸ƒã€æ¥å¤´å«é‡ç­‰ä¿¡æ¯</li>
</ul>
<h4 id="2-fastp---è´¨æ§ä¸è¿‡æ»¤">2. fastp - è´¨æ§ä¸è¿‡æ»¤<a hidden class="anchor" aria-hidden="true" href="#2-fastp---è´¨æ§ä¸è¿‡æ»¤">#</a></h4>
<p><strong>è½¯ä»¶åŠŸèƒ½ï¼š</strong></p>
<ul>
<li>è´¨é‡å‰ªåˆ‡ï¼ˆquality trimmingï¼‰</li>
<li>è¿‡æ»¤ä½è´¨é‡reads</li>
<li>å»æ¥å¤´</li>
<li>UMIï¼ˆUnique Molecular Identifierï¼‰å¤„ç†</li>
<li>è¿‡æ»¤polyGï¼ˆIllumina NovaSeqç‰¹å¾ï¼‰</li>
<li>ç”ŸæˆHTMLå’ŒJSONæ ¼å¼çš„è´¨æ§æŠ¥å‘Š</li>
</ul>
<p><strong>åŸºæœ¬ç”¨æ³•ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">fastp -i sample_R1.fq.gz -I sample_R2.fq.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">      -o clean_R1.fq.gz -O clean_R2.fq.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">      -w <span class="m">8</span>
</span></span></code></pre></div><p><strong>å¸¸ç”¨å‚æ•°è¯¦è§£ï¼š</strong></p>
<table>
  <thead>
      <tr>
          <th>å‚æ•°</th>
          <th>è¯´æ˜</th>
          <th>é»˜è®¤å€¼</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>-i</code></td>
          <td>è¾“å…¥çš„R1ï¼ˆå‰å‘ï¼‰readsæ–‡ä»¶</td>
          <td>-</td>
      </tr>
      <tr>
          <td><code>-I</code></td>
          <td>è¾“å…¥çš„R2ï¼ˆåå‘ï¼‰readsæ–‡ä»¶</td>
          <td>-</td>
      </tr>
      <tr>
          <td><code>-o</code></td>
          <td>è¾“å‡ºçš„æ¸…æ´R1 readsæ–‡ä»¶</td>
          <td>-</td>
      </tr>
      <tr>
          <td><code>-O</code></td>
          <td>è¾“å‡ºçš„æ¸…æ´R2 readsæ–‡ä»¶</td>
          <td>-</td>
      </tr>
      <tr>
          <td><code>-w</code></td>
          <td>çº¿ç¨‹æ•°</td>
          <td>2</td>
      </tr>
      <tr>
          <td><code>-q</code></td>
          <td>è´¨é‡å€¼é˜ˆå€¼ï¼Œä½äºæ­¤å€¼çš„ç¢±åŸºå°†è¢«å‰ªåˆ‡</td>
          <td>15</td>
      </tr>
      <tr>
          <td><code>-u</code></td>
          <td>ä½è´¨é‡readsç™¾åˆ†æ¯”é˜ˆå€¼ï¼Œè¶…è¿‡æ­¤æ¯”ä¾‹çš„readså°†è¢«è¿‡æ»¤</td>
          <td>30</td>
      </tr>
      <tr>
          <td><code>-n</code></td>
          <td>readsé•¿åº¦é˜ˆå€¼ï¼ŒçŸ­äºæ­¤é•¿åº¦çš„readså°†è¢«è¿‡æ»¤</td>
          <td>0</td>
      </tr>
      <tr>
          <td><code>-l</code></td>
          <td>ä¿ç•™çš„æœ€å°readsé•¿åº¦</td>
          <td>15</td>
      </tr>
      <tr>
          <td><code>--detect_adapter_for_pe</code></td>
          <td>è‡ªåŠ¨æ£€æµ‹æ¥å¤´ï¼ˆæ¨èï¼‰</td>
          <td>-</td>
      </tr>
      <tr>
          <td><code>--trim_poly_g</code></td>
          <td>å»é™¤polyGå°¾ï¼ˆNovaSeqæ•°æ®å¿…éœ€ï¼‰</td>
          <td>-</td>
      </tr>
      <tr>
          <td><code>--poly_g_min_len</code></td>
          <td>è§¦å‘polyGå‰ªåˆ‡çš„æœ€å°é•¿åº¦</td>
          <td>10</td>
      </tr>
      <tr>
          <td><code>--cut_front</code></td>
          <td>ä»å‰ç«¯å‰ªåˆ‡æŒ‡å®šæ•°é‡çš„ç¢±åŸº</td>
          <td>-</td>
      </tr>
      <tr>
          <td><code>--cut_tail</code></td>
          <td>ä»å°¾ç«¯å‰ªåˆ‡æŒ‡å®šæ•°é‡çš„ç¢±åŸº</td>
          <td>-</td>
      </tr>
      <tr>
          <td><code>--cut_mean_quality</code></td>
          <td>æŒ‰å¹³å‡è´¨é‡å€¼å‰ªåˆ‡</td>
          <td>-</td>
      </tr>
      <tr>
          <td><code>--length_required</code></td>
          <td>readsæœ€å°é•¿åº¦è¦æ±‚</td>
          <td>15</td>
      </tr>
      <tr>
          <td><code>--json</code></td>
          <td>è¾“å‡ºJSONæ ¼å¼è´¨æ§æŠ¥å‘Š</td>
          <td>fastp.json</td>
      </tr>
      <tr>
          <td><code>--html</code></td>
          <td>è¾“å‡ºHTMLæ ¼å¼è´¨æ§æŠ¥å‘Š</td>
          <td>fastp.html</td>
      </tr>
      <tr>
          <td><code>--report_title</code></td>
          <td>æŠ¥å‘Šæ ‡é¢˜</td>
          <td>fastp report</td>
      </tr>
  </tbody>
</table>
<hr>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ•´ç†å‡ºsample.listï¼ŒåŒ…å«æ¯ä¸ªfastqæ ·å“åç§°</span>
</span></span><span class="line"><span class="cl">ls *gz <span class="p">|</span> ...  &gt; sample.list <span class="c1"># æŒ‰è‡ªå·±å‘½åæ ¼å¼æ‹†åˆ†å‡ºæ ·å“å</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç¼–å†™æ‰¹é‡è¿è¡Œè„šæœ¬</span>
</span></span><span class="line"><span class="cl">cat sample.list <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> sp <span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> fastp -i <span class="si">${</span><span class="nv">sp</span><span class="si">}</span>_1.fastq.gz -I <span class="si">${</span><span class="nv">sp</span><span class="si">}</span>_2.fastq.gz -o ../cleandb/clean.<span class="si">${</span><span class="nv">sp</span><span class="si">}</span>_1.fastq.gz -O ../cleandb/clean.<span class="si">${</span><span class="nv">sp</span><span class="si">}</span>_2.fastq.gz -w <span class="m">15</span> &gt;&gt; auto.fastp.sh<span class="p">;</span><span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ£€æŸ¥å‘½ä»¤</span>
</span></span><span class="line"><span class="cl">cat auto.fastp.sh <span class="p">|</span> head -5
</span></span><span class="line"><span class="cl"><span class="c1"># è¯•è¿è¡Œä¸€ä¸ªä¼šä¸ä¼šæŠ¥é”™ï¼Œç„¶åæŒ‚åå°</span>
</span></span><span class="line"><span class="cl">nohup fastp -i C01_1.fastq.gz -I C01_2.fastq.gz -o ../cleandb/clean.C01_1.fastq.gz -O ../cleandb/clean.C01_2.fastq.gz -w <span class="m">15</span> <span class="p">&amp;</span>
</span></span><span class="line"><span class="cl">nohup sh auto.fastp.sh <span class="p">&amp;</span>
</span></span></code></pre></div><h3 id="äºŒåºåˆ—æ¯”å¯¹">äºŒã€åºåˆ—æ¯”å¯¹<a hidden class="anchor" aria-hidden="true" href="#äºŒåºåˆ—æ¯”å¯¹">#</a></h3>
<h4 id="bwa-mem-æ¯”å¯¹">BWA-MEM æ¯”å¯¹<a hidden class="anchor" aria-hidden="true" href="#bwa-mem-æ¯”å¯¹">#</a></h4>
<p><strong>è½¯ä»¶åŠŸèƒ½ï¼š</strong> å°†æ¸…æ´åçš„readsæ¯”å¯¹åˆ°å‚è€ƒåŸºå› ç»„</p>
<h5 id="21-å»ºç«‹å‚è€ƒåŸºå› ç»„ç´¢å¼•">2.1 å»ºç«‹å‚è€ƒåŸºå› ç»„ç´¢å¼•<a hidden class="anchor" aria-hidden="true" href="#21-å»ºç«‹å‚è€ƒåŸºå› ç»„ç´¢å¼•">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bwa index reference.fasta
</span></span></code></pre></div><blockquote>
<p>æ­¤æ­¥éª¤ä¼šç”Ÿæˆå¤šä¸ªç´¢å¼•æ–‡ä»¶ï¼ˆ.amb, .ann, .bwt, .pac, .saï¼‰</p>
</blockquote>
<h5 id="22-åºåˆ—æ¯”å¯¹">2.2 åºåˆ—æ¯”å¯¹<a hidden class="anchor" aria-hidden="true" href="#22-åºåˆ—æ¯”å¯¹">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">bwa mem -t <span class="m">8</span> -M reference.fasta <span class="se">\
</span></span></span><span class="line"><span class="cl">    clean_R1.fq.gz clean_R2.fq.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">    &gt; sample.sam
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ‰¹é‡æ¯”å¯¹è„šæœ¬</span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/usr/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="nv">ref</span><span class="o">=</span><span class="s2">&#34;Wm82.gnm6.genome.fasta&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">datadir</span><span class="o">=</span><span class="s2">&#34;/home2/xtc/workspace/soybean.project/cleandb&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å»ºè®®å…ˆæ¸…ç©ºï¼Œé¿å…é‡å¤è¿½åŠ </span>
</span></span><span class="line"><span class="cl">: &gt; bwa.mem_s2.sh
</span></span><span class="line"><span class="cl">: &gt; picard_s1.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="nb">read</span> -r sp<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;bwa mem -t 42 \\
</span></span></span><span class="line"><span class="cl"><span class="s2">  -R \&#34;@RG\\\tID:</span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">\\\tSM:</span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">\\\tPL:illumina\&#34; \\
</span></span></span><span class="line"><span class="cl"><span class="s2">  </span><span class="si">${</span><span class="nv">ref</span><span class="si">}</span><span class="s2"> \\
</span></span></span><span class="line"><span class="cl"><span class="s2">  </span><span class="si">${</span><span class="nv">datadir</span><span class="si">}</span><span class="s2">/clean.</span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">_1.fastq.gz \\
</span></span></span><span class="line"><span class="cl"><span class="s2">  </span><span class="si">${</span><span class="nv">datadir</span><span class="si">}</span><span class="s2">/clean.</span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">_2.fastq.gz \\
</span></span></span><span class="line"><span class="cl"><span class="s2">  2&gt;</span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.bwa.log | samtools sort -@ 20 -m 8G -o </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.sort.bam -
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;</span> &gt;&gt; bwa.mem_s2.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;java -Xmx120g \\
</span></span></span><span class="line"><span class="cl"><span class="s2">  -XX:ParallelGCThreads=40 \\
</span></span></span><span class="line"><span class="cl"><span class="s2">  -jar /pub/software/picard.jar \\
</span></span></span><span class="line"><span class="cl"><span class="s2">  MarkDuplicates I=</span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.sort.bam \\
</span></span></span><span class="line"><span class="cl"><span class="s2">  O=</span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.sort.markdup.bam \\
</span></span></span><span class="line"><span class="cl"><span class="s2">  CREATE_INDEX=true REMOVE_DUPLICATES=true \\
</span></span></span><span class="line"><span class="cl"><span class="s2">  M=</span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.marked_dup_metrics.txt
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;</span> &gt;&gt; picard_s1.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">done</span> &lt; sample.list
</span></span></code></pre></div><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>-t 8</code>ï¼šä½¿ç”¨8ä¸ªçº¿ç¨‹è¿›è¡Œæ¯”å¯¹ï¼Œæé«˜é€Ÿåº¦</li>
<li><code>-M</code>ï¼šå°†shorter split hitsæ ‡è®°ä¸ºæ¬¡ä¼˜ï¼Œä»¥ä¾¿å…¼å®¹Picardå·¥å…·</li>
<li><code>reference.fasta</code>ï¼šå‚è€ƒåŸºå› ç»„åºåˆ—æ–‡ä»¶</li>
</ul>
<p><strong>è¾“å…¥ï¼š</strong> æ¸…æ´åçš„R1å’ŒR2 readsï¼ˆgzipå‹ç¼©æ ¼å¼ï¼‰</p>
<p><strong>è¾“å‡ºï¼š</strong> SAMæ ¼å¼æ¯”å¯¹ç»“æœ</p>
<h5 id="23-samè½¬bamå¹¶æ’åº">2.3 SAMè½¬BAMå¹¶æ’åº<a hidden class="anchor" aria-hidden="true" href="#23-samè½¬bamå¹¶æ’åº">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># SAMè½¬BAMï¼ˆå‹ç¼©æ ¼å¼ï¼‰</span>
</span></span><span class="line"><span class="cl">samtools view -Sb sample.sam &gt; sample.bam
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯¹BAMæ–‡ä»¶è¿›è¡Œæ’åº</span>
</span></span><span class="line"><span class="cl">samtools sort sample.bam -o sample.sorted.bam
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å»ºç«‹ç´¢å¼•ï¼Œä¾¿äºåç»­å¿«é€Ÿè®¿é—®</span>
</span></span><span class="line"><span class="cl">samtools index sample.sorted.bam
</span></span></code></pre></div><h5 id="24-æ ‡è®°pcré‡å¤">2.4 æ ‡è®°PCRé‡å¤<a hidden class="anchor" aria-hidden="true" href="#24-æ ‡è®°pcré‡å¤">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨Picardæ ‡è®°é‡å¤</span>
</span></span><span class="line"><span class="cl">picard MarkDuplicates <span class="se">\
</span></span></span><span class="line"><span class="cl">    <span class="nv">I</span><span class="o">=</span>sample.sorted.bam <span class="se">\
</span></span></span><span class="line"><span class="cl">    <span class="nv">O</span><span class="o">=</span>sample.dedup.bam <span class="se">\
</span></span></span><span class="line"><span class="cl">    <span class="nv">M</span><span class="o">=</span>metrics.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å»ºç«‹ç´¢å¼•</span>
</span></span><span class="line"><span class="cl">samtools index sample.dedup.bam
</span></span></code></pre></div><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>I=</code>ï¼šè¾“å…¥æ–‡ä»¶</li>
<li><code>O=</code>ï¼šè¾“å‡ºæ–‡ä»¶</li>
<li><code>M=</code>ï¼šè¾“å‡ºé‡å¤ç»Ÿè®¡ä¿¡æ¯</li>
</ul>
<h5 id="25-æ·»åŠ read-groupsä¿¡æ¯å¯é€‰ä½†æ¨èbwa-mamè„šæœ¬ä¸­å·²å®ç°">2.5 æ·»åŠ Read Groupsä¿¡æ¯ï¼ˆå¯é€‰ä½†æ¨èï¼‰,bwa mamè„šæœ¬ä¸­å·²å®ç°ã€‚<a hidden class="anchor" aria-hidden="true" href="#25-æ·»åŠ read-groupsä¿¡æ¯å¯é€‰ä½†æ¨èbwa-mamè„šæœ¬ä¸­å·²å®ç°">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gatk AddOrReplaceReadGroups <span class="se">\
</span></span></span><span class="line"><span class="cl">    -I sample.dedup.bam <span class="se">\
</span></span></span><span class="line"><span class="cl">    -O sample.rg.bam <span class="se">\
</span></span></span><span class="line"><span class="cl">    -RGID id1 <span class="se">\
</span></span></span><span class="line"><span class="cl">    -RGLB lib1 <span class="se">\
</span></span></span><span class="line"><span class="cl">    -RGPL illumina <span class="se">\
</span></span></span><span class="line"><span class="cl">    -RGPU unit1 <span class="se">\
</span></span></span><span class="line"><span class="cl">    -RGSM sample1
</span></span></code></pre></div><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>-RGID</code>ï¼šRead Group ID</li>
<li><code>-RGLB</code>ï¼šLibraryåç§°</li>
<li><code>-RGPL</code>ï¼šæµ‹åºå¹³å°ï¼ˆillumina, iontorrentç­‰ï¼‰</li>
<li><code>-RGPU</code>ï¼šæµ‹åºå•å…ƒ</li>
<li><code>-RGSM</code>ï¼šæ ·æœ¬åç§°</li>
</ul>
<hr>
<h3 id="ä¸‰å˜å¼‚æ£€æµ‹">ä¸‰ã€å˜å¼‚æ£€æµ‹<a hidden class="anchor" aria-hidden="true" href="#ä¸‰å˜å¼‚æ£€æµ‹">#</a></h3>
<h4 id="gatk-best-practices-æµç¨‹">GATK Best Practices æµç¨‹<a hidden class="anchor" aria-hidden="true" href="#gatk-best-practices-æµç¨‹">#</a></h4>
<p>GATKï¼ˆGenome Analysis Toolkitï¼‰æ˜¯ç›®å‰æœ€å¹¿æ³›ä½¿ç”¨çš„å˜å¼‚æ£€æµ‹è½¯ä»¶ä¹‹ä¸€ã€‚
è¦æ³¨æ„ä¸ä¹‹é€‚é…çš„javaç‰ˆæœ¬</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ¿€æ´»ç¯å¢ƒ</span>
</span></span><span class="line"><span class="cl">mamba activate reseq
</span></span><span class="line"><span class="cl"><span class="c1"># æŒ‡å®šç”¨æœ¬ç¯å¢ƒçš„java</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="nv">$CONDA_PREFIX</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">JAVA_HOME</span><span class="o">=</span><span class="nv">$CONDA_PREFIX</span>
</span></span><span class="line"><span class="cl"><span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$JAVA_HOME</span>/bin:<span class="nv">$PATH</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æµ‹è¯•å¯ç”¨</span>
</span></span><span class="line"><span class="cl">gatk GenotypeGVCFs --help
</span></span></code></pre></div><h4 id="å»ºç«‹ç´¢å¼•å¦åˆ™ä¼šè¿è¡Œå¤±è´¥ä¸ä¼šç”Ÿæˆvcfæ–‡ä»¶">å»ºç«‹ç´¢å¼•(å¦åˆ™ä¼šè¿è¡Œå¤±è´¥ï¼Œä¸ä¼šç”Ÿæˆvcfæ–‡ä»¶)<a hidden class="anchor" aria-hidden="true" href="#å»ºç«‹ç´¢å¼•å¦åˆ™ä¼šè¿è¡Œå¤±è´¥ä¸ä¼šç”Ÿæˆvcfæ–‡ä»¶">#</a></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">samtools faidx Wm82.gnm6.genome.fasta
</span></span><span class="line"><span class="cl">gatk CreateSequenceDictionary <span class="se">\
</span></span></span><span class="line"><span class="cl">  -R Wm82.gnm6.genome.fasta <span class="se">\
</span></span></span><span class="line"><span class="cl">  -O Wm82.gnm6.genome.dict
</span></span></code></pre></div><h5 id="31-haplotypecaller---å•æ ·æœ¬å˜å¼‚æ£€æµ‹">3.1 HaplotypeCaller - å•æ ·æœ¬å˜å¼‚æ£€æµ‹<a hidden class="anchor" aria-hidden="true" href="#31-haplotypecaller---å•æ ·æœ¬å˜å¼‚æ£€æµ‹">#</a></h5>
<p><strong>åŸºæœ¬ç”¨æ³•ï¼ˆGVCFæ¨¡å¼ï¼‰ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gatk HaplotypeCaller <span class="se">\
</span></span></span><span class="line"><span class="cl">    -R reference.fasta <span class="se">\
</span></span></span><span class="line"><span class="cl">    -I sample.dedup.bam <span class="se">\
</span></span></span><span class="line"><span class="cl">    -O sample.g.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">    -ERC GVCF
</span></span></code></pre></div><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>-R</code>ï¼šå‚è€ƒåŸºå› ç»„fastaæ–‡ä»¶</li>
<li><code>-I</code>ï¼šè¾“å…¥çš„BAMæ–‡ä»¶</li>
<li><code>-O</code>ï¼šè¾“å‡ºçš„gVCFæ–‡ä»¶ï¼ˆgzipå‹ç¼©ï¼‰</li>
<li><code>-ERC GVCF</code>ï¼šäº§ç”ŸGVCFæ ¼å¼ï¼Œç”¨äºåç»­è”åˆåˆ†æ</li>
</ul>
<blockquote>
<p>GVCFæ¨¡å¼ä¼šè®°å½•æ‰€æœ‰ä½ç‚¹çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å˜å¼‚ä½ç‚¹å’Œéå˜å¼‚ä½ç‚¹ï¼Œä¾¿äºåç»­å¤šæ ·æœ¬è”åˆåˆ†æã€‚</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ‰¹é‡æ£€æµ‹è„šæœ¬ï¼Œå¯åˆ†ä¸åŒæŸ“è‰²ä½“ï¼Œæé«˜è¿ç®—æ•ˆç‡</span>
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºæŸ“è‰²ä½“list ï¼ˆä¿æŒå‚è€ƒåŸºå› ç»„å’Œbamæ–‡ä»¶æŸ“è‰²ä½“å‘½åä¸€è‡´ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> i in <span class="k">$(</span>seq <span class="m">1</span> 20<span class="k">)</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">&gt;   <span class="nb">echo</span> <span class="s2">&#34;xxGm</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span> &gt;&gt; chr.list
</span></span><span class="line"><span class="cl">&gt; <span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è„šæœ¬å†…å®¹ step1.mk.HaplotypeCaller.sh</span>
</span></span></code></pre></div><h5 id="32-combinegvcfs---åˆå¹¶å¤šä¸ªgvcf">3.2 CombineGVCFs - åˆå¹¶å¤šä¸ªgVCF<a hidden class="anchor" aria-hidden="true" href="#32-combinegvcfs---åˆå¹¶å¤šä¸ªgvcf">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gatk CombineGVCFs <span class="se">\
</span></span></span><span class="line"><span class="cl">    -R reference.fasta <span class="se">\
</span></span></span><span class="line"><span class="cl">    --variant sample1.g.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">    --variant sample2.g.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">    --variant sample3.g.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">    ... <span class="se">\
</span></span></span><span class="line"><span class="cl">    -O cohort.g.vcf.gz
</span></span></code></pre></div><p><strong>æ‰¹å¤„ç†ç¤ºä¾‹ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºvariantåˆ—è¡¨æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">ls *.g.vcf.gz &gt; variant_list.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åˆå¹¶</span>
</span></span><span class="line"><span class="cl">gatk CombineGVCFs <span class="se">\
</span></span></span><span class="line"><span class="cl">    -R reference.fasta <span class="se">\
</span></span></span><span class="line"><span class="cl">    --variant sample1.g.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">    --variant sample2.g.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">    -O cohort.g.vcf.gz
</span></span></code></pre></div><h5 id="33-genotypegvcfs---è”åˆåŸºå› åˆ†å‹">3.3 GenotypeGVCFs - è”åˆåŸºå› åˆ†å‹<a hidden class="anchor" aria-hidden="true" href="#33-genotypegvcfs---è”åˆåŸºå› åˆ†å‹">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gatk GenotypeGVCFs <span class="se">\
</span></span></span><span class="line"><span class="cl">    -R reference.fasta <span class="se">\
</span></span></span><span class="line"><span class="cl">    -V cohort.g.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">    -O cohort.vcf.gz
</span></span></code></pre></div><h6 id="é‡‡å–å…ˆåˆ†å‹å†åˆå¹¶ç­–ç•¥æé«˜æ•ˆç‡">é‡‡å–å…ˆåˆ†å‹å†åˆå¹¶ç­–ç•¥ï¼Œæé«˜æ•ˆç‡<a hidden class="anchor" aria-hidden="true" href="#é‡‡å–å…ˆåˆ†å‹å†åˆå¹¶ç­–ç•¥æé«˜æ•ˆç‡">#</a></h6>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºgvcf.chr.list,ä¸€åˆ—ä¸ºä¸åŒæ ·å“çš„åŒä¸€æŸ“è‰²ä½“çš„vcfæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œä¿æŒæŸ“è‰²ä½“listæ–‡ä»¶å‘½åå’Œä½¿ç”¨æŸ“è‰²ä½“å‘½åä¸€è‡´ï¼Œå¦åˆ™åé¢è„šæœ¬è¦ä¿®æ”¹</span>
</span></span><span class="line"><span class="cl">find <span class="s2">&#34;</span><span class="nv">$PWD</span><span class="s2">&#34;</span> -type f -name <span class="s2">&#34;*.Chr1.g.vcf.gz&#34;</span> -exec realpath <span class="o">{}</span> <span class="se">\;</span> <span class="p">|</span> sort &gt; Chr1.gvcf.list
</span></span><span class="line"><span class="cl"><span class="c1"># æ‰¹é‡ç”Ÿæˆè„šæœ¬ gvcf.allchr.sh</span>
</span></span><span class="line"><span class="cl"><span class="c1">#ï¼/usr/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> i in <span class="k">$(</span>seq -w <span class="m">1</span> 20<span class="k">)</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nv">gm</span><span class="o">=</span><span class="s2">&#34;Gm</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  find <span class="s2">&#34;</span><span class="nv">$PWD</span><span class="s2">&#34;</span> -type f -name <span class="s2">&#34;*.</span><span class="si">${</span><span class="nv">gm</span><span class="si">}</span><span class="s2">.g.vcf.gz&#34;</span> -exec realpath <span class="o">{}</span> <span class="se">\;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    <span class="p">|</span> sort &gt; <span class="s2">&#34;</span><span class="si">${</span><span class="nv">gm</span><span class="si">}</span><span class="s2">.gvcf.list&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># CombineGVCFs,æ±‡æ€»å•æ¡æŸ“è‰²ä½“</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è„šæœ¬ ï¼ˆè¿è¡Œå¾ˆæ…¢ï¼Œå¯ä»¥å°è¯•æ‹†åˆ†å‘½ä»¤å¹¶è¡Œè¿è¡Œï¼‰ï¼Œä¸€æ¡å¤§çº¦4å†…å­˜</span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="nv">ref</span><span class="o">=</span>Wm82.gnm6.genome.fasta
</span></span><span class="line"><span class="cl">cat chr.list <span class="p">|</span><span class="k">while</span> <span class="nb">read</span> chr<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span> 
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="s2">&#34;gatk CombineGVCFs -R </span><span class="nv">$ref</span><span class="s2"> -V gvcf.</span><span class="nv">$chr</span><span class="s2">.list -O </span><span class="nv">$chr</span><span class="s2">.g.vcf.gz 1&gt; </span><span class="nv">$chr</span><span class="s2">.CombineGVCFs.log 2&gt;&amp;1&#34;</span>  &gt;&gt;  s2.CombineGVCFs.sh <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># enotypeGVCFsåˆ†å‹</span>
</span></span><span class="line"><span class="cl"><span class="c1"># åˆ›å»ºè„šæœ¬step3.GenotypeGVCFs_gvcf.sh</span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="nv">ref</span><span class="o">=</span>Wm82.gnm6.genome.fasta
</span></span><span class="line"><span class="cl">cat chr.list <span class="p">|</span><span class="k">while</span> <span class="nb">read</span> chr<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span> 
</span></span><span class="line"><span class="cl">	<span class="nb">echo</span> <span class="s2">&#34;gatk GenotypeGVCFs -R </span><span class="nv">$ref</span><span class="s2"> -V </span><span class="nv">$chr</span><span class="s2">.g.vcf.gz -O </span><span class="nv">$chr</span><span class="s2">.raw.vcf.gz 1&gt; </span><span class="nv">$chr</span><span class="s2">.GenotypeGVCFs.log 2&gt;&amp;1 &amp;&#34;</span>  &gt;&gt;  s3.GenotypeGVCFs.sh <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="c1"># åˆå¹¶æ‰€æœ‰æ ·å“çš„vcf</span>
</span></span><span class="line"><span class="cl"><span class="c1"># s4.MergeVcfs_allsp.sh</span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="nv">ref</span><span class="o">=</span>Wm82.gnm6.genome.fasta
</span></span><span class="line"><span class="cl">awk <span class="s1">&#39;{print $1&#34;.raw.vcf.gz&#34;}&#39;</span> chr.list &gt; raw_vcf.list
</span></span><span class="line"><span class="cl">gatk MergeVcfs -I  raw_vcf.list -O all.merge_raw.vcf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ‹†åˆ†snpå’Œindelï¼ŒåŒæ—¶è¿›è¡Œç¡¬è¿‡æ»¤</span>
</span></span><span class="line"><span class="cl"><span class="c1"># s5.hardfil.sh</span>
</span></span><span class="line"><span class="cl"><span class="nv">ref</span><span class="o">=</span>Wm82.gnm6.genome.fasta
</span></span><span class="line"><span class="cl"><span class="nv">rawvcf</span><span class="o">=</span>all.merge_raw.vcf
</span></span><span class="line"><span class="cl"><span class="nv">rawsnp</span><span class="o">=</span>raw.SNP.vcf
</span></span><span class="line"><span class="cl"><span class="nv">rawindel</span><span class="o">=</span>raw.indel.vcf
</span></span><span class="line"><span class="cl">gatk SelectVariants  -R <span class="nv">$ref</span> -V <span class="nv">$rawvcf</span> --select-type INDEL -O raw.indel.vcf
</span></span><span class="line"><span class="cl">gatk SelectVariants  -R <span class="nv">$ref</span> -V <span class="nv">$rawvcf</span> --select-type SNP -O raw.SNP.vcf
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gatk VariantFiltration <span class="se">\
</span></span></span><span class="line"><span class="cl">-R <span class="nv">$ref</span> -V <span class="nv">$rawsnp</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">--filter-expression <span class="s2">&#34;QD &lt; 2.0 || FS &gt; 60.0 || MQ &lt; 40.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt; -8.0&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">--filter-name <span class="s1">&#39;SNP_filter&#39;</span> -O filter.snp.vcf
</span></span><span class="line"><span class="cl"><span class="c1">#æå–è¿‡æ»¤åçš„snp</span>
</span></span><span class="line"><span class="cl">gatk SelectVariants <span class="se">\
</span></span></span><span class="line"><span class="cl">-R <span class="nv">$ref</span> -V filter.snp.vcf <span class="se">\
</span></span></span><span class="line"><span class="cl">--exclude-filtered  -O filtered.snp.vcf 1&gt;filtersnp.e5.log 2&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gatk  VariantFiltration -R <span class="nv">$ref</span> -V <span class="nv">$rawindel</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">--filter-expression <span class="s2">&#34;QD &lt; 2.0 || FS &gt; 200.0 || MQRankSum &lt; -12.5 || ReadPosRankSum &lt; -8.0&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">--filter-name <span class="s1">&#39;INDEL_filter&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">-O filter.indel.vcf
</span></span><span class="line"><span class="cl">gatk SelectVariants <span class="se">\
</span></span></span><span class="line"><span class="cl">-R <span class="nv">$ref</span> -V filter.indel.vcf <span class="se">\
</span></span></span><span class="line"><span class="cl">--exclude-filtered -O filtered.indel.vcf 1&gt;filterindel1.e5.log 2&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span></code></pre></div><h5 id="34-variantfiltration---å˜å¼‚è¿‡æ»¤">3.4 VariantFiltration - å˜å¼‚è¿‡æ»¤<a hidden class="anchor" aria-hidden="true" href="#34-variantfiltration---å˜å¼‚è¿‡æ»¤">#</a></h5>
<p><strong>SNPè¿‡æ»¤æ ‡å‡†ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gatk VariantFiltration <span class="se">\
</span></span></span><span class="line"><span class="cl">    -R reference.fasta <span class="se">\
</span></span></span><span class="line"><span class="cl">    -V cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">    -O cohort.filtered.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">    --filter-name <span class="s2">&#34;QD_filter&#34;</span> --filter-expression <span class="s2">&#34;QD &lt; 2.0&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    --filter-name <span class="s2">&#34;FS_filter&#34;</span> --filter-expression <span class="s2">&#34;FS &gt; 60.0&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    --filter-name <span class="s2">&#34;MQ_filter&#34;</span> --filter-expression <span class="s2">&#34;MQ &lt; 40.0&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    --filter-name <span class="s2">&#34;MQRankSum_filter&#34;</span> --filter-expression <span class="s2">&#34;MQRankSum &lt; -12.5&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    --filter-name <span class="s2">&#34;ReadPosRankSum_filter&#34;</span> --filter-expression <span class="s2">&#34;ReadPosRankSum &lt; -8.0&#34;</span>
</span></span></code></pre></div><p><strong>InDelè¿‡æ»¤æ ‡å‡†ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gatk VariantFiltration <span class="se">\
</span></span></span><span class="line"><span class="cl">    -R reference.fasta <span class="se">\
</span></span></span><span class="line"><span class="cl">    -V cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">    -O cohort.indel.filtered.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">    --filter-name <span class="s2">&#34;QD_filter&#34;</span> --filter-expression <span class="s2">&#34;QD &lt; 2.0&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    --filter-name <span class="s2">&#34;FS_filter&#34;</span> --filter-expression <span class="s2">&#34;FS &gt; 200.0&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    --filter-name <span class="s2">&#34;ReadPosRankSum_filter&#34;</span> --filter-expression <span class="s2">&#34;ReadPosRankSum &lt; -20.0&#34;</span>
</span></span></code></pre></div><p><strong>è¿‡æ»¤æŒ‡æ ‡è¯´æ˜ï¼š</strong></p>
<table>
  <thead>
      <tr>
          <th>æŒ‡æ ‡</th>
          <th>å…¨ç§°</th>
          <th>è¯´æ˜</th>
          <th>SNPé˜ˆå€¼</th>
          <th>InDelé˜ˆå€¼</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>QD</td>
          <td>QualByDepth</td>
          <td>æ¯æ·±åº¦è´¨é‡åˆ†æ•°</td>
          <td>&lt; 2.0</td>
          <td>&lt; 2.0</td>
      </tr>
      <tr>
          <td>FS</td>
          <td>FisherStrand</td>
          <td>é“¾åå‘æ€§</td>
          <td>&gt; 60.0</td>
          <td>&gt; 200.0</td>
      </tr>
      <tr>
          <td>MQ</td>
          <td>RMSMappingQuality</td>
          <td>æ ¹å‡æ–¹æ˜ å°„è´¨é‡</td>
          <td>&lt; 40.0</td>
          <td>-</td>
      </tr>
      <tr>
          <td>MQRankSum</td>
          <td>MappingQualityRankSumTest</td>
          <td>æ˜ å°„è´¨é‡ç§©å’Œæ£€éªŒ</td>
          <td>&lt; -12.5</td>
          <td>-</td>
      </tr>
      <tr>
          <td>ReadPosRankSum</td>
          <td>ReadPositionRankSumTest</td>
          <td>Readä½ç½®ç§©å’Œæ£€éªŒ</td>
          <td>&lt; -8.0</td>
          <td>&lt; -20.0</td>
      </tr>
      <tr>
          <td>SOR</td>
          <td>StrandOddsRatio</td>
          <td>é“¾æ¯”å€¼</td>
          <td>&gt; 3.0</td>
          <td>&gt; 10.0</td>
      </tr>
  </tbody>
</table>
<h5 id="35-selectvariants---æå–é«˜è´¨é‡å˜å¼‚">3.5 SelectVariants - æå–é«˜è´¨é‡å˜å¼‚<a hidden class="anchor" aria-hidden="true" href="#35-selectvariants---æå–é«˜è´¨é‡å˜å¼‚">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gatk SelectVariants <span class="se">\
</span></span></span><span class="line"><span class="cl">    -R reference.fasta <span class="se">\
</span></span></span><span class="line"><span class="cl">    -V cohort.filtered.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">    --exclude-filtered <span class="se">\
</span></span></span><span class="line"><span class="cl">    -O cohort.high_quality.vcf.gz
</span></span></code></pre></div><h5 id="36-åˆ†åˆ«æå–snpå’Œindel">3.6 åˆ†åˆ«æå–SNPå’ŒInDel<a hidden class="anchor" aria-hidden="true" href="#36-åˆ†åˆ«æå–snpå’Œindel">#</a></h5>
<p><strong>æå–SNPï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gatk SelectVariants <span class="se">\
</span></span></span><span class="line"><span class="cl">    -V cohort.high_quality.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">    -select-type SNP <span class="se">\
</span></span></span><span class="line"><span class="cl">    -O cohort.snp.vcf.gz
</span></span></code></pre></div><p><strong>æå–InDelï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gatk SelectVariants <span class="se">\
</span></span></span><span class="line"><span class="cl">    -V cohort.high_quality.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">    -select-type INDEL <span class="se">\
</span></span></span><span class="line"><span class="cl">    -O cohort.indel.vcf.gz
</span></span></code></pre></div><h6 id="å¯é€‰å·¥ä½œsvå’Œcnv">å¯é€‰å·¥ä½œï¼ŒSVå’ŒCNV<a hidden class="anchor" aria-hidden="true" href="#å¯é€‰å·¥ä½œsvå’Œcnv">#</a></h6>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å»ºç«‹æ’åºå»é‡bamæ–‡ä»¶åˆ—è¡¨ï¼ˆå¥½åƒç”¨ä¸ä¸Šï¼‰</span>
</span></span><span class="line"><span class="cl">find <span class="s2">&#34;</span><span class="nv">$PWD</span><span class="s2">&#34;</span> -type f -name <span class="s2">&#34;*.sort.markdup.bam&#34;</span> -exec realpath <span class="o">{}</span> <span class="se">\;</span> <span class="p">|</span> sort &gt; sort.markdup.bam.list
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># SVæ£€æµ‹</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 1 æ‰¹é‡æå–discordants readsè„šæœ¬</span>
</span></span><span class="line"><span class="cl">cat sample.list <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> sp<span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="s2">&#34;samtools view -b -F 1294 -@ 30 </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.sort.markdup.bam &gt; </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.discordants.bam &#34;</span>&gt;&gt; s1_discordants.sh<span class="p">;</span> <span class="k">done</span>
</span></span><span class="line"><span class="cl">nohub s1_discordants.sh <span class="p">&amp;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 2 æå– split reads,ä½¿ç”¨lumpy</span>
</span></span><span class="line"><span class="cl">cat sample.list <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> sp<span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="s2">&#34;samtools view -h </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.sort.markdup.bam | extractSplitReads_BwaMem -i stdin | samtools sort - &gt; </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.splitters.bam&#34;</span> &gt;&gt; s2_split.reads.sh <span class="p">;</span> <span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å•çº¿ç¨‹æ…¢ï¼Œå› æ­¤è°ƒæ•´çº¿ç¨‹å’Œå¹¶è¡Œæ•°ç›®</span>
</span></span><span class="line"><span class="cl">&gt; s2_split.reads.sh
</span></span><span class="line"><span class="cl">cat sample.list <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> sp<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;samtools view -@ 4 -h </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.sort.markdup.bam | extractSplitReads_BwaMem -i stdin | samtools sort -@ 4 - &gt; </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.splitters.bam&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span> &gt; s2_split.reads.sh
</span></span><span class="line"><span class="cl">nohup parallel -j <span class="m">10</span> &lt; s2_split.reads.sh &gt; s2_split.log 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 3 è¿è¡Œ lumpy</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ‰¹é‡è¾“å…¥æ–‡ä»¶è„šæœ¬ s3_lumpy.sh</span>
</span></span><span class="line"><span class="cl"><span class="c1"># åˆå§‹åŒ–ç©ºå˜é‡</span>
</span></span><span class="line"><span class="cl"><span class="nv">B_files</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">S_files</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">D_files</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¾ªç¯æ‹¼æ¥</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="nb">read</span> sp<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="nv">B_files</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">B_files</span><span class="si">}</span><span class="s2">,</span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.sort.markdup.bam&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">S_files</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">S_files</span><span class="si">}</span><span class="s2">,</span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.splitters.bam&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">D_files</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">D_files</span><span class="si">}</span><span class="s2">,</span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.discordants.bam&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span> &lt; sample.list
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å»æ‰å¼€å¤´å¤šä½™çš„é€—å·</span>
</span></span><span class="line"><span class="cl"><span class="nv">B_files</span><span class="o">=</span><span class="si">${</span><span class="nv">B_files</span><span class="p">#,</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">S_files</span><span class="o">=</span><span class="si">${</span><span class="nv">S_files</span><span class="p">#,</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">D_files</span><span class="o">=</span><span class="si">${</span><span class="nv">D_files</span><span class="p">#,</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿è¡Œ lumpyexpress</span>
</span></span><span class="line"><span class="cl">lumpyexpress <span class="se">\
</span></span></span><span class="line"><span class="cl">    -B <span class="si">${</span><span class="nv">B_files</span><span class="si">}</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    -S <span class="si">${</span><span class="nv">S_files</span><span class="si">}</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    -D <span class="si">${</span><span class="nv">D_files</span><span class="si">}</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    -o all.sv.lumpy.vcf
</span></span><span class="line"><span class="cl">nohup bash s3_lumpy.sh &gt; s3_lumpy.log 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 4 ä¸ªä½“åŸºå› å‹åˆ†å‹</span>
</span></span><span class="line"><span class="cl">cat sample.list <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> sp<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;vcftools --vcf all.sv.lumpy.vcf --indv </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2"> --recode --recode-INFO-all --out </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2"> &amp;&amp; \
</span></span></span><span class="line"><span class="cl"><span class="s2">    svtyper -i </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.recode.vcf -B </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.sort.markdup.bam -o </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.genotype.vcf&#34;</span> &gt;&gt; s4_genotype.split.sh <span class="se">\
</span></span></span><span class="line"><span class="cl">    <span class="k">done</span>
</span></span><span class="line"><span class="cl">nohup parallel -j <span class="m">10</span> &lt; s4_genotype.split.sh &gt; s4_genotype.split.log 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># CNVæ£€æµ‹</span>
</span></span><span class="line"><span class="cl">seqkit split -i Wm82.gnm6.genome.fasta -O split
</span></span><span class="line"><span class="cl"><span class="c1"># è‹¥splitæ–‡ä»¶å¤¹é‡Œçš„æŸ“è‰²ä½“æ–‡ä»¶å‘½åä¹±ç ï¼Œä¿®æ”¹è‡³æ­£å¸¸</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç”¨ rename æˆ– for å¾ªç¯å»æ‰å•å¼•å·å’ŒTab</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> f in *<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># å»æ‰å•å¼•å·ï¼ŒæŠŠTabæ›¿æ¢æˆç‚¹å·</span>
</span></span><span class="line"><span class="cl">    <span class="nv">newname</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$f</span><span class="s2">&#34;</span> <span class="p">|</span> tr -d <span class="s2">&#34;&#39;&#34;</span> <span class="p">|</span> tr <span class="s1">&#39;\t&#39;</span> <span class="s1">&#39;.&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;</span><span class="nv">$f</span><span class="s2">&#34;</span> !<span class="o">=</span> <span class="s2">&#34;</span><span class="nv">$newname</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        mv -- <span class="s2">&#34;</span><span class="nv">$f</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$newname</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç”Ÿæˆé‡å‘½åè„šæœ¬</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å»æ‰ Wm82.gnm6.genome.part_ å‰ç¼€</span>
</span></span><span class="line"><span class="cl">ls ./split/*.fasta <span class="p">|</span> sed <span class="s1">&#39;s|./split/Wm82.gnm6.genome.part_||&#39;</span> <span class="p">|</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    sed <span class="s1">&#39;s|\.fasta||&#39;</span> <span class="p">|</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    awk <span class="s1">&#39;{print &#34;mv ./split/Wm82.gnm6.genome.part_&#34;$1&#34;.fasta ./split/&#34;$1&#34;.fasta&#34;}&#39;</span> &gt; mv_name.sh
</span></span><span class="line"><span class="cl"><span class="c1"># æ£€æŸ¥</span>
</span></span><span class="line"><span class="cl">cat mv_name.sh
</span></span><span class="line"><span class="cl"><span class="c1"># æ‰§è¡Œ</span>
</span></span><span class="line"><span class="cl">bash mv_name.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç”Ÿæˆæ£€æµ‹è„šæœ¬</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ¯ä¸ªæ ·æœ¬ç”Ÿæˆä¸€ä¸ªç‹¬ç«‹è„šæœ¬</span>
</span></span><span class="line"><span class="cl">cat sample.list <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> sp<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;cnvnator -genome Wm82.gnm6.genome.fasta -root </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.root -tree </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.sort.markdup.bam &amp;&amp; \
</span></span></span><span class="line"><span class="cl"><span class="s2">cnvnator -genome Wm82.gnm6.genome.fasta -root </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.root -his 500 -d split &amp;&amp; \
</span></span></span><span class="line"><span class="cl"><span class="s2">cnvnator -root </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.root -stat 500 &amp;&amp; \
</span></span></span><span class="line"><span class="cl"><span class="s2">cnvnator -root </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.root -eval 500 &gt; </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.eval.ratio &amp;&amp; \
</span></span></span><span class="line"><span class="cl"><span class="s2">cnvnator -root </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.root -partition 500 &amp;&amp; \
</span></span></span><span class="line"><span class="cl"><span class="s2">cnvnator -root </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.root -call 500 &gt; </span><span class="si">${</span><span class="nv">sp</span><span class="si">}</span><span class="s2">.cnv&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span> &gt; s_cnvnator_parallel.sh
</span></span><span class="line"><span class="cl"><span class="c1"># ä»ä¸Šå¾€ä¸‹ä¾æ¬¡æ˜¯æå–æ¯”å¯¹ç»“æœï¼Œç”Ÿæˆæ·±åº¦åˆ†å¸ƒï¼Œæ£€æŸ¥bin sizeæ˜¯å¦åˆé€‚ï¼ŒRDä¿¡å·åˆ†å‰²ï¼Œè¿›è¡ŒCNVæ£€æµ‹</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å¤šæ ·æœ¬åŒæ—¶è·‘ï¼ˆ5ä¸ªæ ·æœ¬å¹¶è¡Œï¼‰ï¼ˆçº¿ç¨‹å¯èƒ½ä¼šçˆ†ï¼‰</span>
</span></span><span class="line"><span class="cl">nohup parallel -j <span class="m">5</span> &lt; s_cnvnator_parallel.sh &gt; cnvnator.log 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span>
</span></span></code></pre></div><hr>
<h3 id="å››å˜å¼‚æ³¨é‡Š">å››ã€å˜å¼‚æ³¨é‡Š<a hidden class="anchor" aria-hidden="true" href="#å››å˜å¼‚æ³¨é‡Š">#</a></h3>
<h4 id="annovar-æ³¨é‡Šæµç¨‹">ANNOVAR æ³¨é‡Šæµç¨‹<a hidden class="anchor" aria-hidden="true" href="#annovar-æ³¨é‡Šæµç¨‹">#</a></h4>
<p><strong>è½¯ä»¶åŠŸèƒ½ï¼š</strong> å¯¹æ£€æµ‹åˆ°çš„å˜å¼‚è¿›è¡ŒåŠŸèƒ½æ³¨é‡Šï¼Œé¢„æµ‹å˜å¼‚å¯¹åŸºå› åŠŸèƒ½çš„å½±å“</p>
<h5 id="41-å‡†å¤‡å·¥ä½œ">4.1 å‡†å¤‡å·¥ä½œ<a hidden class="anchor" aria-hidden="true" href="#41-å‡†å¤‡å·¥ä½œ">#</a></h5>
<p><strong>ä¸‹è½½æ³¨é‡Šæ•°æ®åº“ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å»ºç«‹æ•°æ®åº“ç›®å½•</span>
</span></span><span class="line"><span class="cl">mkdir humandb/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä¸‹è½½RefSeqåŸºå› æ•°æ®åº“</span>
</span></span><span class="line"><span class="cl">annotate_variation.pl -buildver dm6 <span class="se">\
</span></span></span><span class="line"><span class="cl">    -downdb -webfrom annovar <span class="se">\
</span></span></span><span class="line"><span class="cl">    refGene humandb/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä¸‹è½½dbNSFPæ•°æ®åº“ï¼ˆåŒ…å«å¤šä¸ªåŠŸèƒ½é¢„æµ‹å·¥å…·çš„ç»“æœï¼‰</span>
</span></span><span class="line"><span class="cl">annotate_variation.pl -buildver dm6 <span class="se">\
</span></span></span><span class="line"><span class="cl">    -downdb -webfrom annovar <span class="se">\
</span></span></span><span class="line"><span class="cl">    dbnsfp42a humandb/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å…¶ä»–å¸¸ç”¨æ•°æ®åº“</span>
</span></span><span class="line"><span class="cl">annotate_variation.pl -buildver dm6 <span class="se">\
</span></span></span><span class="line"><span class="cl">    -downdb -webfrom annovar <span class="se">\
</span></span></span><span class="line"><span class="cl">    gnomad_genome humandb/
</span></span></code></pre></div><p>éæ¨¡å¼ç‰©ç§éœ€è¦è½¬æ¢gff/gtfæ ¼å¼ä¸ºGenePredæ ¼å¼
UCSCè½¯ä»¶åº“æŸ¥æ‰¾
&lt;http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä¸‹è½½</span>
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /pub/software/annovar
</span></span><span class="line"><span class="cl">wget http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/gff3ToGenePred
</span></span><span class="line"><span class="cl"><span class="c1"># æ·»åŠ ç¯å¢ƒå˜é‡</span>
</span></span><span class="line"><span class="cl">vi /etc/profile.d/env.sh
</span></span><span class="line"><span class="cl"><span class="c1"># export PATH=/pub/software/annovar:$PATH</span>
</span></span><span class="line"><span class="cl"><span class="nb">source</span>  /etc/profile.d/env.sh
</span></span><span class="line"><span class="cl"><span class="c1"># æ‰§è¡Œæƒé™</span>
</span></span><span class="line"><span class="cl">chmod +x ./gff3ToGenePred
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ–‡ä»¶å‡†å¤‡</span>
</span></span><span class="line"><span class="cl">cp /fastaè·¯å¾„/
</span></span><span class="line"><span class="cl">cp /gff3è·¯å¾„/
</span></span><span class="line"><span class="cl"><span class="c1"># gffæ–‡ä»¶åŠ å¤´(åªå…è®¸è¿™ä¸€ä¸ªè¡¨å¤´ä¿¡æ¯)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># echo &#34;##gff-version 3&#34; | cat - lch.gff3 &gt; temp &amp;&amp; mv temp lch.gff3</span>
</span></span><span class="line"><span class="cl">gff3ToGenePred Wm82.gnm6.gff3 Wm82.genome_refGene.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">retrieve_seq_from_fasta.pl --format refGene <span class="se">\
</span></span></span><span class="line"><span class="cl">    --seqfile Wm82.gnm6.genome.fasta <span class="se">\
</span></span></span><span class="line"><span class="cl">    --out Wm82.genome_refGeneMrna.fa <span class="se">\
</span></span></span><span class="line"><span class="cl">    Wm82.genome_refGene.txt
</span></span></code></pre></div><h5 id="42-è½¬æ¢vcfæ ¼å¼ä¸ºannovarè¾“å…¥æ ¼å¼">4.2 è½¬æ¢VCFæ ¼å¼ä¸ºANNOVARè¾“å…¥æ ¼å¼<a hidden class="anchor" aria-hidden="true" href="#42-è½¬æ¢vcfæ ¼å¼ä¸ºannovarè¾“å…¥æ ¼å¼">#</a></h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># SNPè½¬æ¢</span>
</span></span><span class="line"><span class="cl">convert2annovar.pl -format vcf4old cohort.snp.vcf.gz &gt; cohort.snp.avinput
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># InDelè½¬æ¢</span>
</span></span><span class="line"><span class="cl">convert2annovar.pl -format vcf4old cohort.indel.vcf.gz &gt; cohort.indel.avinput
</span></span></code></pre></div><h5 id="43-æ‰§è¡Œæ³¨é‡Štableæ˜¯ä¸€é”®å®Œæˆä¸‰ç§æ³¨é‡Š">4.3 æ‰§è¡Œæ³¨é‡Š(tableæ˜¯ä¸€é”®å®Œæˆä¸‰ç§æ³¨é‡Šï¼‰<a hidden class="anchor" aria-hidden="true" href="#43-æ‰§è¡Œæ³¨é‡Štableæ˜¯ä¸€é”®å®Œæˆä¸‰ç§æ³¨é‡Š">#</a></h5>
<p><strong>SNPæ³¨é‡Šï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">table_annovar.pl cohort.snp.avinput humandb/ <span class="se">\
</span></span></span><span class="line"><span class="cl">    -buildver dm6 <span class="se">\
</span></span></span><span class="line"><span class="cl">    -out cohort.snp_annotated <span class="se">\
</span></span></span><span class="line"><span class="cl">    -remove <span class="se">\
</span></span></span><span class="line"><span class="cl">    -protocol refGene,dbnsfp42a,gnomad_genome <span class="se">\
</span></span></span><span class="line"><span class="cl">    -operation g,f,f <span class="se">\
</span></span></span><span class="line"><span class="cl">    -nastring . <span class="se">\
</span></span></span><span class="line"><span class="cl">    -vcfinput
</span></span></code></pre></div><p><strong>InDelæ³¨é‡Šï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">table_annovar.pl cohort.indel.avinput humandb/ <span class="se">\
</span></span></span><span class="line"><span class="cl">    -buildver dm6 <span class="se">\
</span></span></span><span class="line"><span class="cl">    -out cohort.indel_annotated <span class="se">\
</span></span></span><span class="line"><span class="cl">    -remove <span class="se">\
</span></span></span><span class="line"><span class="cl">    -protocol refGene <span class="se">\
</span></span></span><span class="line"><span class="cl">    -operation g <span class="se">\
</span></span></span><span class="line"><span class="cl">    -nastring . <span class="se">\
</span></span></span><span class="line"><span class="cl">    -vcfinput
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è‡ªå·±è°ƒæ•´ï¼Œéæ¨¡å¼ç‰©ç§å¯¹åŸºå› æ³¨é‡Š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Wm82.genome_refGene.txt è¯¥æ–‡ä»¶çš„å‰ç¼€æ¥è®¾ç½®dbtypeå’Œbuilder</span>
</span></span><span class="line"><span class="cl">annotate_variation.pl -geneanno -dbtype refGene -buildver Wm82.genome --neargene <span class="m">2000</span> -out Wm82.snp_annotated -exonsort Wm82.snp.avinput .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">annotate_variation.pl -geneanno -dbtype refGene -buildver Wm82.genome --neargene <span class="m">2000</span> -out Wm82.indel_annotated -exonsort Wm82.indelavinput .
</span></span></code></pre></div><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p>
<ul>
<li><code>-buildver</code>ï¼šåŸºå› ç»„ç‰ˆæœ¬ï¼ˆå¦‚dm6, hg38ç­‰ï¼‰</li>
<li><code>-protocol</code>ï¼šæŒ‡å®šè¦ä½¿ç”¨çš„æ³¨é‡Šæ•°æ®åº“</li>
<li><code>-operation</code>ï¼š
<ul>
<li><code>g</code>ï¼šåŸºäºåŸºå› çš„æ³¨é‡Š</li>
<li><code>f</code>ï¼šåŸºäºè¿‡æ»¤çš„æ³¨é‡Š</li>
</ul>
</li>
<li><code>-nastring</code>ï¼šç¼ºå¤±å€¼çš„è¡¨ç¤ºå­—ç¬¦ä¸²</li>
<li><code>-vcfinput</code>ï¼šè¾“å…¥ä¸ºVCFæ ¼å¼</li>
</ul>
<p><strong>æ³¨é‡Šç»“æœè§£è¯»ï¼š</strong></p>
<ul>
<li><code>exonic</code>ï¼šå¤–æ˜¾å­åŒºçš„å˜å¼‚</li>
<li><code>splicing</code>ï¼šå‰ªæ¥ä½ç‚¹é™„è¿‘çš„å˜å¼‚ï¼ˆÂ±2bpï¼‰</li>
<li><code>intronic</code>ï¼šå†…å«å­åŒºçš„å˜å¼‚</li>
<li><code>upstream/downstream</code>ï¼šåŸºå› ä¸Šæ¸¸/ä¸‹æ¸¸åŒºåŸŸ</li>
<li><code>intergenic</code>ï¼šåŸºå› é—´åŒº</li>
<li><code>UTR5/UTR3</code>ï¼š5&rsquo;/3&rsquo;éç¿»è¯‘åŒº</li>
</ul>
<p><strong>åŠŸèƒ½å½±å“é¢„æµ‹ï¼š</strong></p>
<ul>
<li><code>synonymous SNV</code>ï¼šåŒä¹‰çªå˜ï¼ˆä¸æ”¹å˜æ°¨åŸºé…¸ï¼‰</li>
<li><code>nonsynonymous SNV</code>ï¼šéåŒä¹‰çªå˜</li>
<li><code>missense</code>ï¼šé”™ä¹‰çªå˜</li>
<li><code>nonsense</code>ï¼šæ— ä¹‰çªå˜ï¼ˆäº§ç”Ÿç»ˆæ­¢å¯†ç å­ï¼‰</li>
<li><code>frameshift</code>ï¼šç§»ç çªå˜</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1">#   å¯é€‰æ“ä½œï¼Œæ³¨é‡Šsvå’Œcnv</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å¤„ç†SVæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">less -S all.sv.lumpy.vcf <span class="p">|</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    awk -F <span class="s2">&#34;;&#34;</span> <span class="s1">&#39;{ if($1!~/#/){print $1&#34;\t&#34;$2&#34;\t&#34;$3&#34;\t&#34;$4} }&#39;</span> <span class="p">|</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    awk <span class="s1">&#39;{print $1&#34;\t&#34;$2&#34;\t&#34;$11&#34;\t&#34;$3&#34;\t&#34;$8}&#39;</span> <span class="p">|</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">    sed <span class="s1">&#39;s/END=//&#39;</span> <span class="p">|</span> sed <span class="s1">&#39;s/SVTYPE=//&#39;</span> &gt; SV.bed
</span></span><span class="line"><span class="cl"><span class="c1"># è¿‡æ»¤BNDç±»å‹</span>
</span></span><span class="line"><span class="cl">awk <span class="s1">&#39;$5 !~ /BND/&#39;</span> SV.bed &gt; SV_filter.bed
</span></span><span class="line"><span class="cl"><span class="c1"># SVæ³¨é‡Š</span>
</span></span><span class="line"><span class="cl">bedtools intersect -wo -a SV_filter.bed -b Wm82.gnm6.gff3 &gt; SV_filter.Anno
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¤„ç†CNVæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">&gt; CNV.bed
</span></span><span class="line"><span class="cl">cat sample.list <span class="p">|</span> <span class="k">while</span> <span class="nb">read</span> sp<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    awk <span class="s1">&#39;{print $2&#34;\t&#34;$1}&#39;</span> <span class="si">${</span><span class="nv">sp</span><span class="si">}</span>.cnv <span class="p">|</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">        sed <span class="s1">&#39;s/:/\t/&#39;</span> <span class="p">|</span> sed <span class="s1">&#39;s/-/\t/&#39;</span> &gt;&gt; CNV.bed
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl"><span class="c1"># CNVæ³¨é‡Š</span>
</span></span><span class="line"><span class="cl">bedtools intersect -wo -a CNV.bed -b Wm82.gnm6.gff3 &gt; CNV.Anno
</span></span></code></pre></div><hr>
<h2 id="å›¾è¡¨åˆ¶ä½œ">å›¾è¡¨åˆ¶ä½œ<a hidden class="anchor" aria-hidden="true" href="#å›¾è¡¨åˆ¶ä½œ">#</a></h2>
<h3 id="ä¸€ç¾¤ä½“é—ä¼ å­¦åˆ†æ">ä¸€ã€ç¾¤ä½“é—ä¼ å­¦åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#ä¸€ç¾¤ä½“é—ä¼ å­¦åˆ†æ">#</a></h3>
<h4 id="11-pcaåˆ†æä¸»æˆåˆ†åˆ†æ">1.1 PCAåˆ†æï¼ˆä¸»æˆåˆ†åˆ†æï¼‰<a hidden class="anchor" aria-hidden="true" href="#11-pcaåˆ†æä¸»æˆåˆ†åˆ†æ">#</a></h4>
<p><strong>åˆ†æç›®çš„ï¼š</strong></p>
<ul>
<li>è¯„ä¼°ç¾¤ä½“ç»“æ„</li>
<li>è¯†åˆ«æ ·æœ¬èšç±»æ¨¡å¼</li>
<li>æ£€æµ‹ç¦»ç¾¤æ ·æœ¬</li>
<li>æ­ç¤ºæ ·æœ¬é—´çš„é—ä¼ å…³ç³»</li>
</ul>
<p><strong>å¸¸ç”¨è½¯ä»¶ï¼š</strong></p>
<ul>
<li>PLINKï¼šå‘½ä»¤è¡Œå·¥å…·ï¼Œå¿«é€Ÿé«˜æ•ˆ</li>
<li>GCTAï¼šæ”¯æŒæ··åˆçº¿æ€§æ¨¡å‹</li>
<li>SNPRelateï¼ˆRåŒ…ï¼‰ï¼šçµæ´»ï¼Œä¾¿äºå¯è§†åŒ–</li>
</ul>
<p><strong>PLINKè¿›è¡ŒPCAåˆ†æï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Step 1: å°†VCFè½¬æ¢ä¸ºPLINKæ ¼å¼</span>
</span></span><span class="line"><span class="cl">plink --vcf cohort.vcf.gz --make-bed --out population
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 2: æ•°æ®è¿‡æ»¤ï¼ˆå¯é€‰ï¼‰</span>
</span></span><span class="line"><span class="cl">plink --bfile population <span class="se">\
</span></span></span><span class="line"><span class="cl">      --maf 0.05 <span class="se">\
</span></span></span><span class="line"><span class="cl">      --geno 0.1 <span class="se">\
</span></span></span><span class="line"><span class="cl">      --hwe 1e-6 <span class="se">\
</span></span></span><span class="line"><span class="cl">      --make-bed <span class="se">\
</span></span></span><span class="line"><span class="cl">      --out population_filtered
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 3: è¿›è¡ŒPCAåˆ†æ</span>
</span></span><span class="line"><span class="cl">plink --bfile population_filtered <span class="se">\
</span></span></span><span class="line"><span class="cl">      --pca <span class="m">20</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">      --out pca_result
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºæ–‡ä»¶ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - pca_result.eigenvalï¼šç‰¹å¾å€¼ï¼ˆè§£é‡Šæ–¹å·®æ¯”ä¾‹ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - pca_result.eigenvecï¼šç‰¹å¾å‘é‡ï¼ˆæ ·æœ¬çš„PCåæ ‡ï¼‰</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ•°æ®è¿‡æ»¤ï¼ˆè‡ªå·±è°ƒæ•´ï¼‰</span>
</span></span><span class="line"><span class="cl">plink --vcf all.merge_raw.vcf <span class="se">\
</span></span></span><span class="line"><span class="cl">    --geno 0.1 <span class="se">\
</span></span></span><span class="line"><span class="cl">    --maf 0.01 <span class="se">\
</span></span></span><span class="line"><span class="cl">    --out all.missing_maf <span class="se">\
</span></span></span><span class="line"><span class="cl">    --recode vcf-iid <span class="se">\
</span></span></span><span class="line"><span class="cl">    --allow-extra-chr <span class="se">\
</span></span></span><span class="line"><span class="cl">    --set-missing-var-ids @:# <span class="se">\
</span></span></span><span class="line"><span class="cl">    --keep-allele-order
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿‡æ»¤è¿é”ä¸å¹³è¡¡</span>
</span></span><span class="line"><span class="cl">plink --vcf all.missing_maf.vcf <span class="se">\
</span></span></span><span class="line"><span class="cl">    --indep-pairwise <span class="m">50</span> <span class="m">10</span> 0.2 <span class="se">\
</span></span></span><span class="line"><span class="cl">    --out tmp.ld <span class="se">\
</span></span></span><span class="line"><span class="cl">    --allow-extra-chr <span class="se">\
</span></span></span><span class="line"><span class="cl">    --set-missing-var-ids @:#
</span></span><span class="line"><span class="cl">plink --vcf all.missing_maf.vcf <span class="se">\
</span></span></span><span class="line"><span class="cl">    --make-bed <span class="se">\
</span></span></span><span class="line"><span class="cl">    --extract tmp.ld.prune.in <span class="se">\
</span></span></span><span class="line"><span class="cl">    --out all.LDfilter <span class="se">\
</span></span></span><span class="line"><span class="cl">    --recode vcf-iid <span class="se">\
</span></span></span><span class="line"><span class="cl">    --keep-allele-order <span class="se">\
</span></span></span><span class="line"><span class="cl">    --allow-extra-chr <span class="se">\
</span></span></span><span class="line"><span class="cl">    --set-missing-var-ids @:#
</span></span></code></pre></div><p><strong>Rè¯­è¨€å¯è§†åŒ–ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># è¯»å–PCAç»“æœ</span>
</span></span><span class="line"><span class="cl"><span class="n">pca_data</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;pca_result.eigenvec&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">colnames</span><span class="p">(</span><span class="n">pca_data</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;FID&#34;</span><span class="p">,</span> <span class="s">&#34;IID&#34;</span><span class="p">,</span> <span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;PC&#34;</span><span class="p">,</span> <span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–ç¾¤ä½“ä¿¡æ¯ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">group_info</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;group_info.txt&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pca_data</span> <span class="o">&lt;-</span> <span class="nf">merge</span><span class="p">(</span><span class="n">pca_data</span><span class="p">,</span> <span class="n">group_info</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s">&#34;IID&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜åˆ¶PC1 vs PC2</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">pca_data</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">PC1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">PC2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Group</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_bw</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&#34;PC1&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&#34;PC2&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">title</span><span class="o">=</span><span class="s">&#34;PCA Analysis&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">subtitle</span><span class="o">=</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;PC1: &#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nf">round</span><span class="p">(</span><span class="nf">summary</span><span class="p">(</span><span class="nf">prcomp</span><span class="p">(</span><span class="n">pca_data[</span><span class="p">,</span><span class="m">3</span><span class="o">:</span><span class="m">22</span><span class="n">]</span><span class="p">))</span><span class="o">$</span><span class="n">importance[2</span><span class="p">,</span><span class="m">1</span><span class="n">]</span><span class="o">*</span><span class="m">100</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">         <span class="s">&#34;% variance&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜åˆ¶PC1 vs PC3</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">pca_data</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">PC1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">PC3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Group</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_bw</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&#34;PC1&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&#34;PC3&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜åˆ¶ç¢çŸ³å›¾ï¼ˆScree plotï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">eigenvals</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;pca_result.eigenval&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">var_explained</span> <span class="o">&lt;-</span> <span class="n">eigenvals</span><span class="o">$</span><span class="n">V1</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="n">eigenvals</span><span class="o">$</span><span class="n">V1</span><span class="p">)</span> <span class="o">*</span> <span class="m">100</span>
</span></span><span class="line"><span class="cl"><span class="nf">plot</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">,</span> <span class="n">var_explained[1</span><span class="o">:</span><span class="m">20</span><span class="n">]</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="s">&#34;b&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="n">xlab</span><span class="o">=</span><span class="s">&#34;Principal Component&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="n">ylab</span><span class="o">=</span><span class="s">&#34;Variance Explained (%)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="n">main</span><span class="o">=</span><span class="s">&#34;Scree Plot&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="12-ç³»ç»Ÿå‘è‚²æ ‘æ„å»º">1.2 ç³»ç»Ÿå‘è‚²æ ‘æ„å»º<a hidden class="anchor" aria-hidden="true" href="#12-ç³»ç»Ÿå‘è‚²æ ‘æ„å»º">#</a></h4>
<p><strong>åˆ†æç›®çš„ï¼š</strong></p>
<ul>
<li>å±•ç¤ºæ ·æœ¬é—´çš„è¿›åŒ–å…³ç³»</li>
<li>è¯†åˆ«å•ç³»ç¾¤</li>
<li>æ¨æ–­ç¾¤ä½“å†å²</li>
</ul>
<p><strong>å¸¸ç”¨æ–¹æ³•ï¼š</strong></p>
<table>
  <thead>
      <tr>
          <th>æ–¹æ³•</th>
          <th>ç‰¹ç‚¹</th>
          <th>é€‚ç”¨åœºæ™¯</th>
          <th>è½¯ä»¶</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>é‚»æ¥æ³•(NJ)</td>
          <td>é€Ÿåº¦å¿«ï¼Œé€‚ç”¨äºå¤§æ•°æ®</td>
          <td>åˆæ­¥åˆ†æ</td>
          <td>MEGA, PHYLIP</td>
      </tr>
      <tr>
          <td>æœ€å¤§ä¼¼ç„¶æ³•(ML)</td>
          <td>å‡†ç¡®æ€§é«˜ï¼Œè®¡ç®—é‡å¤§</td>
          <td>ç²¾ç¡®åˆ†æ</td>
          <td>RAxML, IQ-TREE</td>
      </tr>
      <tr>
          <td>è´å¶æ–¯æ³•</td>
          <td>æœ€å‡†ç¡®ï¼Œè®¡ç®—é‡æå¤§</td>
          <td>å°æ•°æ®é›†ç²¾ç»†åˆ†æ</td>
          <td>MrBayes</td>
      </tr>
  </tbody>
</table>
<p><strong>å®Œæ•´æµç¨‹ï¼š</strong></p>
<p><strong>Step 1: æå–å˜å¼‚ä½ç‚¹å¹¶æ ¼å¼è½¬æ¢</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨vcf2phylipï¼ˆæ¨èï¼‰</span>
</span></span><span class="line"><span class="cl">vcf2phylip.py --input cohort.vcf.gz --output phylip_file
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æˆ–ä½¿ç”¨seqtk</span>
</span></span><span class="line"><span class="cl">seqtk subseq reference.fasta region_list.txt &gt; alignment.fasta
</span></span></code></pre></div><p><strong>Step 2: æ„å»ºç³»ç»Ÿå‘è‚²æ ‘ï¼ˆIQ-TREEï¼‰</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åŸºæœ¬åˆ†æ</span>
</span></span><span class="line"><span class="cl">iqtree -s phylip_file -m GTR+G -bb <span class="m">1000</span> -nt AUTO
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‚æ•°è¯´æ˜ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -s: è¾“å…¥æ–‡ä»¶ï¼ˆPHYLIPæˆ–FASTAæ ¼å¼ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -m: æ›¿ä»£æ¨¡å‹ï¼ˆGTR+Gå¸¸ç”¨ï¼Œæˆ–ä½¿ç”¨MFPè®©è½¯ä»¶è‡ªåŠ¨é€‰æ‹©ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -bb: è‡ªä¸¾é‡å¤æ¬¡æ•°ï¼ˆ1000ä¸ºæ ‡å‡†ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -nt: çº¿ç¨‹æ•°ï¼ˆAUTOè‡ªåŠ¨æ£€æµ‹ï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºæ–‡ä»¶ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - *.treefile: æœ€ä½³ç³»ç»Ÿå‘è‚²æ ‘ï¼ˆNewickæ ¼å¼ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - *.log: è¿è¡Œæ—¥å¿—</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - *.iqtree: è¯¦ç»†ç»“æœ</span>
</span></span></code></pre></div><p><strong>Step 3: ä½¿ç”¨RAxMLï¼ˆæ›¿ä»£æ–¹æ¡ˆï¼‰</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">raxmlHPC -s phylip_file <span class="se">\
</span></span></span><span class="line"><span class="cl">         -n output <span class="se">\
</span></span></span><span class="line"><span class="cl">         -m GTRGAMMA <span class="se">\
</span></span></span><span class="line"><span class="cl">         -p <span class="m">12345</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         -# <span class="m">100</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         -f a
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‚æ•°è¯´æ˜ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -s: è¾“å…¥æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -n: è¾“å‡ºæ–‡ä»¶åç¼€</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -m: æ›¿ä»£æ¨¡å‹</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -p: éšæœºç§å­</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -#: è‡ªä¸¾é‡å¤æ¬¡æ•°</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -f a: å¿«é€Ÿè‡ªä¸¾åˆ†æå’Œæœç´¢æœ€ä½³æ ‘</span>
</span></span></code></pre></div><p><strong>Step 4: å¯è§†åŒ–</strong></p>
<p><strong>åœ¨çº¿å·¥å…·ï¼š</strong></p>
<ul>
<li>iTOL (<a href="https://itol.embl.de/">https://itol.embl.de/</a>)ï¼šåŠŸèƒ½å¼ºå¤§ï¼Œå¯é«˜åº¦å®šåˆ¶</li>
<li>Evolview (<a href="https://evolgenius.info/evolview/">https://evolgenius.info/evolview/</a>)ï¼šç•Œé¢å‹å¥½</li>
</ul>
<p><strong>Rè¯­è¨€ggtreeç¤ºä¾‹ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggtree</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">treeio</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–æ ‘æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="n">tree</span> <span class="o">&lt;-</span> <span class="nf">read.tree</span><span class="p">(</span><span class="s">&#34;output.treefile&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åŸºæœ¬ç»˜å›¾</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggtree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_tiplab</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_tippoint</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">group</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_tree2</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ·»åŠ è¿›åŒ–è·ç¦»æ ‡å°º</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggtree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_treescale</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_tiplab</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_nodepoint</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ·»åŠ è‡ªå±•å€¼</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggtree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_nodelab</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">bootstrap</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="m">3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;blue&#34;</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="13-ç¾¤ä½“ç»“æ„åˆ†æ">1.3 ç¾¤ä½“ç»“æ„åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#13-ç¾¤ä½“ç»“æ„åˆ†æ">#</a></h4>
<p><strong>åˆ†æç›®çš„ï¼š</strong></p>
<ul>
<li>è¯„ä¼°ç¾¤ä½“æ··åˆç¨‹åº¦</li>
<li>ä¼°è®¡ç¥–å…ˆç¾¤ä½“æ•°é‡</li>
<li>æ£€æµ‹åŸºå› æµäº‹ä»¶</li>
</ul>
<p><strong>ADMIXTUREåˆ†æï¼š</strong></p>
<p><strong>Step 1: æ•°æ®å‡†å¤‡</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># è½¬æ¢ä¸ºPLINK BEDæ ¼å¼</span>
</span></span><span class="line"><span class="cl">plink --vcf cohort.vcf.gz --make-bed --out population
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿‡æ»¤ç›¸å…³æ ·æœ¬ï¼ˆå¯é€‰ï¼‰</span>
</span></span><span class="line"><span class="cl">plink --bfile population <span class="se">\
</span></span></span><span class="line"><span class="cl">      --indep-pairwise <span class="m">50</span> <span class="m">5</span> 0.2 <span class="se">\
</span></span></span><span class="line"><span class="cl">      --out prune
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">plink --bfile population <span class="se">\
</span></span></span><span class="line"><span class="cl">      --extract prune.prune.in <span class="se">\
</span></span></span><span class="line"><span class="cl">      --make-bed <span class="se">\
</span></span></span><span class="line"><span class="cl">      --out population.pruned
</span></span></code></pre></div><p><strong>Step 2: è¿è¡ŒADMIXTURE</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æµ‹è¯•ä¸åŒçš„Kå€¼ï¼ˆç¥–å…ˆç¾¤ä½“æ•°é‡ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> K in <span class="o">{</span>1..10<span class="o">}</span><span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">    admixture --cv population.pruned.bed <span class="nv">$K</span> <span class="p">|</span> tee log<span class="si">${</span><span class="nv">K</span><span class="si">}</span>.out
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºæ–‡ä»¶ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - population.pruned.${K}.Q: ä¸ªä½“ ancestry proportions</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - population.pruned.${K}.P: SNP allele frequencies</span>
</span></span></code></pre></div><p><strong>Step 3: é€‰æ‹©æœ€ä¼˜Kå€¼</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æŸ¥çœ‹äº¤å‰éªŒè¯è¯¯å·®</span>
</span></span><span class="line"><span class="cl">grep -h CV log*.out <span class="p">|</span> sort -t<span class="s1">&#39;:&#39;</span> -k2 -n
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é€‰æ‹©CVè¯¯å·®æœ€å°çš„Kå€¼</span>
</span></span></code></pre></div><p><strong>Step 4: å¯è§†åŒ–ï¼ˆRè¯­è¨€ï¼‰</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–QçŸ©é˜µï¼ˆancestry proportionsï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">K</span> <span class="o">&lt;-</span> <span class="m">3</span>  <span class="c1"># å‡è®¾æœ€ä¼˜K=3</span>
</span></span><span class="line"><span class="cl"><span class="n">Q</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;population.pruned.&#34;</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="s">&#34;.Q&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¾ç½®ç¾¤ä½“é¡ºåºï¼ˆæŒ‰ç¬¬ä¸€ç¥–å…ˆæˆåˆ†æ’åºï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">order_idx</span> <span class="o">&lt;-</span> <span class="nf">order</span><span class="p">(</span><span class="n">Q[</span><span class="p">,</span><span class="m">1</span><span class="n">]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Q_ordered</span> <span class="o">&lt;-</span> <span class="n">Q[order_idx</span><span class="p">,</span><span class="n">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‡†å¤‡ç»˜å›¾æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">plot_data</span> <span class="o">&lt;-</span> <span class="nf">as.data.frame</span><span class="p">(</span><span class="n">Q_ordered</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">colnames</span><span class="p">(</span><span class="n">plot_data</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;Ancestry&#34;</span><span class="p">,</span> <span class="m">1</span><span class="o">:</span><span class="n">K</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plot_data</span><span class="o">$</span><span class="n">Sample</span> <span class="o">&lt;-</span> <span class="nf">factor</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">Q_ordered</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è½¬æ¢ä¸ºé•¿æ ¼å¼</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">reshape2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">plot_data_long</span> <span class="o">&lt;-</span> <span class="nf">melt</span><span class="p">(</span><span class="n">plot_data</span><span class="p">,</span> <span class="n">id.vars</span><span class="o">=</span><span class="s">&#34;Sample&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">variable.name</span><span class="o">=</span><span class="s">&#34;Ancestry&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">value.name</span><span class="o">=</span><span class="s">&#34;Proportion&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜åˆ¶å †å æ¡å½¢å›¾</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">plot_data_long</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Sample</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Proportion</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="n">Ancestry</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="o">=</span><span class="s">&#34;identity&#34;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="m">0.8</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">scale_fill_brewer</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s">&#34;Set3&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_minimal</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="n">axis.ticks.x</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="n">legend.position</span><span class="o">=</span><span class="s">&#34;right&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&#34;Sample&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&#34;Ancestry Proportion&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">title</span><span class="o">=</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;ADMIXTURE Analysis (K=&#34;</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="s">&#34;)&#34;</span><span class="p">))</span>
</span></span></code></pre></div><hr>
<h3 id="äºŒè¿é”ä¸å¹³è¡¡åˆ†æ">äºŒã€è¿é”ä¸å¹³è¡¡åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#äºŒè¿é”ä¸å¹³è¡¡åˆ†æ">#</a></h3>
<h4 id="21-ldè¡°å‡åˆ†æ">2.1 LDè¡°å‡åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#21-ldè¡°å‡åˆ†æ">#</a></h4>
<p><strong>åˆ†æç›®çš„ï¼š</strong></p>
<ul>
<li>è¯„ä¼°è¿é”ä¸å¹³è¡¡éšç€è·ç¦»å¢åŠ è€Œè¡°å‡çš„ç¨‹åº¦</li>
<li>ä¼°ç®—å†å²é‡ç»„ç‡</li>
<li>æŒ‡å¯¼å…³è”åˆ†æä¸­çš„æ ‡è®°å¯†åº¦é€‰æ‹©</li>
</ul>
<p><strong>å…³é”®æŒ‡æ ‡ï¼š</strong></p>
<table>
  <thead>
      <tr>
          <th>æŒ‡æ ‡</th>
          <th>è¯´æ˜</th>
          <th>å–å€¼èŒƒå›´</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>rÂ²</td>
          <td>ä¸¤ä¸ªä½ç‚¹é—´çš„ç›¸å…³ç³»æ•°</td>
          <td>0-1</td>
      </tr>
      <tr>
          <td>D'</td>
          <td>æ ‡å‡†åŒ–è¿é”ä¸å¹³è¡¡ç³»æ•°</td>
          <td>0-1</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p>LDè¡°å‡æ›²çº¿ï¼šå½“rÂ²é™è‡³å…¶æœ€å¤§å€¼çš„ä¸€åŠæ—¶ï¼Œå¯¹åº”çš„ç‰©ç†è·ç¦»å³ä¸ºLDè¡°å‡è·ç¦»</p>
</blockquote>
<p><strong>è½¯ä»¶1: PopLDdecayï¼ˆæ¨èï¼‰</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># åŸºæœ¬ç”¨æ³•</span>
</span></span><span class="line"><span class="cl">PopLDdecay -InVCF cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">           -OutStat ld_decay_stat
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‚æ•°è¯´æ˜ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -InVCF: è¾“å…¥VCFæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -OutStat: è¾“å‡ºç»Ÿè®¡æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é«˜çº§å‚æ•°</span>
</span></span><span class="line"><span class="cl">PopLDdecay -InVCF cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">           -OutStat ld_decay_stat <span class="se">\
</span></span></span><span class="line"><span class="cl">           -MaxDist <span class="m">1000000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">           -MAF 0.05 <span class="se">\
</span></span></span><span class="line"><span class="cl">           -Miss 0.2 <span class="se">\
</span></span></span><span class="line"><span class="cl">           -Het <span class="m">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -MaxDist: æœ€å¤§è·ç¦»ï¼ˆbpï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -MAF: æœ€å°ç­‰ä½åŸºå› é¢‘ç‡</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -Miss: æœ€å¤§ç¼ºå¤±ç‡</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -Het: åŒ…å«æ‚åˆä½ç‚¹</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜åˆ¶LDè¡°å‡æ›²çº¿</span>
</span></span><span class="line"><span class="cl">PopLDdecay -InVCF cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">           -OutStat ld_decay_stat <span class="se">\
</span></span></span><span class="line"><span class="cl">           -OutPlot ld_decay_plot
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºæ–‡ä»¶ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - ld_decay_stat.stat: LDç»Ÿè®¡ç»“æœ</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - ld_decay_stat.pdf: LDè¡°å‡æ›²çº¿å›¾</span>
</span></span></code></pre></div><p><strong>è½¯ä»¶2: PLINK</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># è®¡ç®—é…å¯¹LD</span>
</span></span><span class="line"><span class="cl">plink --vcf cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">      --r2 <span class="se">\
</span></span></span><span class="line"><span class="cl">      --ld-window <span class="m">99999</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">      --ld-window-kb <span class="m">100</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">      --ld-window-r2 <span class="m">0</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">      --out ld_pairwise
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‚æ•°è¯´æ˜ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --r2: è®¡ç®—rÂ²å€¼</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --ld-window: çª—å£å†…çš„æœ€å¤§SNPæ•°é‡</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --ld-window-kb: çª—å£å¤§å°ï¼ˆkbï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --ld-window-r2: åªæŠ¥å‘ŠrÂ²é«˜äºæ­¤å€¼çš„é…å¯¹</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ»‘åŠ¨çª—å£LD</span>
</span></span><span class="line"><span class="cl">plink --vcf cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">      --ld-window <span class="m">100</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">      --ld-window-kb <span class="m">100</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">      --ld-window-r2 0.2 <span class="se">\
</span></span></span><span class="line"><span class="cl">      --r2 --ld-window-r2 <span class="m">0</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">      --out ld_window
</span></span></code></pre></div><p><strong>Rè¯­è¨€å¯è§†åŒ–ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–PopLDdecayç»“æœ</span>
</span></span><span class="line"><span class="cl"><span class="n">ld_data</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;ld_decay_stat.stat&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">colnames</span><span class="p">(</span><span class="n">ld_data</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;Distance&#34;</span><span class="p">,</span> <span class="s">&#34;R2&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æŒ‰è·ç¦»åˆ†ç»„æ±‚å¹³å‡å€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">ld_avg</span> <span class="o">&lt;-</span> <span class="nf">aggregate</span><span class="p">(</span><span class="n">R2</span> <span class="o">~</span> <span class="n">Distance</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ld_data</span><span class="p">,</span> <span class="n">FUN</span><span class="o">=</span><span class="n">mean</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜åˆ¶LDè¡°å‡æ›²çº¿</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">ld_avg</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Distance</span><span class="o">/</span><span class="m">1000</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">R2</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_line</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;steelblue&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s">&#34;loess&#34;</span><span class="p">,</span> <span class="n">se</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="n">linetype</span><span class="o">=</span><span class="s">&#34;dashed&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&#34;Distance (kb)&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&#34;Linkage Disequilibrium (rÂ²)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">title</span><span class="o">=</span><span class="s">&#34;LD Decay Analysis&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_bw</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">annotate</span><span class="p">(</span><span class="s">&#34;segment&#34;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">xend</span><span class="o">=</span><span class="kc">Inf</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="m">0.1</span><span class="p">,</span> <span class="n">yend</span><span class="o">=</span><span class="m">0.1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="n">linetype</span><span class="o">=</span><span class="s">&#34;dotted&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;gray50&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—åŠè¡°è·ç¦»ï¼ˆrÂ²é™è‡³0.1æ—¶çš„è·ç¦»ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">half_decay_distance</span> <span class="o">&lt;-</span> <span class="nf">approx</span><span class="p">(</span><span class="n">ld_avg</span><span class="o">$</span><span class="n">R2</span><span class="p">,</span> <span class="n">ld_avg</span><span class="o">$</span><span class="n">Distance</span><span class="p">,</span> <span class="n">xout</span><span class="o">=</span><span class="m">0.1</span><span class="p">)</span><span class="o">$</span><span class="n">y</span>
</span></span><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;Half-decay distance: &#34;</span><span class="p">,</span> <span class="nf">round</span><span class="p">(</span><span class="n">half_decay_distance</span><span class="o">/</span><span class="m">1000</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="s">&#34; kb&#34;</span><span class="p">))</span>
</span></span></code></pre></div><h4 id="22-ldçƒ­å›¾">2.2 LDçƒ­å›¾<a hidden class="anchor" aria-hidden="true" href="#22-ldçƒ­å›¾">#</a></h4>
<p><strong>ç›®çš„ï¼š</strong> å±•ç¤ºç‰¹å®šæŸ“è‰²ä½“åŒºåŸŸçš„LDæ¨¡å¼</p>
<p><strong>Rè¯­è¨€å®ç°ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">LDheatmap</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">SNPRelate</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å°†VCFè½¬æ¢ä¸ºGDSæ ¼å¼</span>
</span></span><span class="line"><span class="cl"><span class="nf">snpgdsVCF2GDS</span><span class="p">(</span><span class="s">&#34;cohort.vcf.gz&#34;</span><span class="p">,</span> <span class="s">&#34;cohort.gds&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ‰“å¼€GDSæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="n">genofile</span> <span class="o">&lt;-</span> <span class="nf">snpgdsOpen</span><span class="p">(</span><span class="s">&#34;cohort.gds&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æå–ç‰¹å®šåŒºåŸŸçš„SNP</span>
</span></span><span class="line"><span class="cl"><span class="n">snp_id</span> <span class="o">&lt;-</span> <span class="nf">snpgdsSelectSNP</span><span class="p">(</span><span class="n">genofile</span><span class="p">,</span> <span class="n">chromosome</span><span class="o">=</span><span class="m">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                         <span class="n">start.position</span><span class="o">=</span><span class="m">1000000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                         <span class="n">end.position</span><span class="o">=</span><span class="m">2000000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—LDçŸ©é˜µ</span>
</span></span><span class="line"><span class="cl"><span class="n">ld_matrix</span> <span class="o">&lt;-</span> <span class="nf">snpgdsLDMat</span><span class="p">(</span><span class="n">genofile</span><span class="p">,</span> <span class="n">snp.id</span><span class="o">=</span><span class="n">snp_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                         <span class="n">method</span><span class="o">=</span><span class="s">&#34;r&#34;</span><span class="p">,</span> <span class="n">slide</span><span class="o">=</span><span class="m">100</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                         <span class="n">LD.threshold</span><span class="o">=</span><span class="m">0.2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜åˆ¶LDçƒ­å›¾</span>
</span></span><span class="line"><span class="cl"><span class="nf">png</span><span class="p">(</span><span class="s">&#34;LD_heatmap.png&#34;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="m">2000</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="m">2000</span><span class="p">,</span> <span class="n">res</span><span class="o">=</span><span class="m">150</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">LDheatmap</span><span class="p">(</span><span class="n">ld_matrix</span><span class="o">$</span><span class="n">snpdist</span><span class="p">,</span> <span class="n">ld_matrix</span><span class="o">$</span><span class="n">LDmatrix</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">flip</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">title</span><span class="o">=</span><span class="s">&#34;LD Heatmap (Chr1: 1-2 Mb)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">geneMap</span><span class="o">=</span><span class="s">&#34;no genes&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dev.off</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å…³é—­GDSæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="nf">snpgdsClose</span><span class="p">(</span><span class="n">genofile</span><span class="p">)</span>
</span></span></code></pre></div><hr>
<h3 id="ä¸‰æ ¸è‹·é…¸å¤šæ ·æ€§åˆ†æ">ä¸‰ã€æ ¸è‹·é…¸å¤šæ ·æ€§åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#ä¸‰æ ¸è‹·é…¸å¤šæ ·æ€§åˆ†æ">#</a></h3>
<h4 id="31-Ï€-pi-è®¡ç®—">3.1 Ï€ (Pi) è®¡ç®—<a hidden class="anchor" aria-hidden="true" href="#31-Ï€-pi-è®¡ç®—">#</a></h4>
<p><strong>å®šä¹‰ï¼š</strong>
Ï€ï¼ˆæ ¸è‹·é…¸å¤šæ ·æ€§ï¼‰æ˜¯æŒ‡ä»ç¾¤ä½“ä¸­éšæœºæŠ½å–çš„ä¸¤ä¸ªæŸ“è‰²ä½“çš„ä»»æ„ä½ç‚¹ä¸Šï¼Œæ ¸è‹·é…¸å·®å¼‚çš„å¹³å‡æ¯”ä¾‹ã€‚</p>
<p><strong>è®¡ç®—å…¬å¼ï¼š</strong></p>
<pre tabindex="0"><code>Ï€ = Î£ Ï€ij / [n(n-1)/2]
</code></pre><p>å…¶ä¸­ï¼ŒÏ€ijæ˜¯ç¬¬iä¸ªå’Œç¬¬jä¸ªåºåˆ—ä¹‹é—´çš„æ ¸è‹·é…¸å·®å¼‚ï¼Œnæ˜¯æ ·æœ¬æ•°é‡</p>
<p><strong>ç”Ÿç‰©å­¦æ„ä¹‰ï¼š</strong></p>
<ul>
<li>åæ˜ ç¾¤ä½“å†…çš„é—ä¼ å¤šæ ·æ€§æ°´å¹³</li>
<li>é«˜Ï€å€¼ï¼šé«˜é—ä¼ å¤šæ ·æ€§</li>
<li>ä½Ï€å€¼ï¼šä½é—ä¼ å¤šæ ·æ€§ï¼ˆå¯èƒ½ç»å†äº†é€‰æ‹©æˆ–ç“¶é¢ˆæ•ˆåº”ï¼‰</li>
</ul>
<p><strong>ä½¿ç”¨VCFtoolsè®¡ç®—ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å…¨åŸºå› ç»„Ï€ï¼ˆå•ç‚¹ä¼°è®¡ï¼‰</span>
</span></span><span class="line"><span class="cl">vcftools --vcf cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">         --site-pi <span class="se">\
</span></span></span><span class="line"><span class="cl">         --out pi_per_site
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ»‘åŠ¨çª—å£Ï€</span>
</span></span><span class="line"><span class="cl">vcftools --vcf cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">         --window-pi <span class="m">100000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --window-pi-step <span class="m">50000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --out pi_window
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‚æ•°è¯´æ˜ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --window-pi: çª—å£å¤§å°ï¼ˆbpï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --window-pi-step: æ»‘åŠ¨æ­¥é•¿ï¼ˆbpï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºæ–‡ä»¶ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - pi_per_site.sites.pi: æ¯ä¸ªä½ç‚¹çš„Ï€å€¼</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - pi_window.windowed.pi: çª—å£Ï€å€¼</span>
</span></span></code></pre></div><p><strong>ä½¿ç”¨PopGenomeï¼ˆRåŒ…ï¼‰ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">PopGenome</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–VCFæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">readVCF</span><span class="p">(</span><span class="s">&#34;cohort.vcf.gz&#34;</span><span class="p">,</span> <span class="n">include.unknown</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—å…¨åŸºå› ç»„æ ¸è‹·é…¸å¤šæ ·æ€§</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">diversity.stats</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æå–Ï€å€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">pi_genome</span> <span class="o">&lt;-</span> <span class="n">data</span><span class="o">@</span><span class="n">nuc.diversity.within</span>
</span></span><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;Genome-wide Ï€: &#34;</span><span class="p">,</span> <span class="n">pi_genome</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ»‘åŠ¨çª—å£åˆ†æ</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">sliding.window.transform</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="m">100000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="m">50000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">diversity.stats</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æå–çª—å£Ï€å€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">window_pi</span> <span class="o">&lt;-</span> <span class="n">data</span><span class="o">@</span><span class="n">nuc.diversity.within</span>
</span></span><span class="line"><span class="cl"><span class="n">window_positions</span> <span class="o">&lt;-</span> <span class="n">data</span><span class="o">@</span><span class="n">sliding.window.positions</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯è§†åŒ–</span>
</span></span><span class="line"><span class="cl"><span class="nf">plot</span><span class="p">(</span><span class="n">window_positions</span><span class="o">/</span><span class="m">1000000</span><span class="p">,</span> <span class="n">window_pi</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="n">type</span><span class="o">=</span><span class="s">&#34;l&#34;</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="n">xlab</span><span class="o">=</span><span class="s">&#34;Genome Position (Mb)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="n">ylab</span><span class="o">=</span><span class="s">&#34;Nucleotide Diversity (Ï€)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="n">main</span><span class="o">=</span><span class="s">&#34;Sliding Window Ï€ Analysis&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p><strong>ç¾¤ä½“é—´Ï€æ¯”è¾ƒï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ç¾¤ä½“1</span>
</span></span><span class="line"><span class="cl">vcftools --vcf cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">         --keep population1.txt <span class="se">\
</span></span></span><span class="line"><span class="cl">         --window-pi <span class="m">100000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --out pi_pop1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¾¤ä½“2</span>
</span></span><span class="line"><span class="cl">vcftools --vcf cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">         --keep population2.txt <span class="se">\
</span></span></span><span class="line"><span class="cl">         --window-pi <span class="m">100000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --out pi_pop2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¾¤ä½“3</span>
</span></span><span class="line"><span class="cl">vcftools --vcf cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">         --keep population3.txt <span class="se">\
</span></span></span><span class="line"><span class="cl">         --window-pi <span class="m">100000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --out pi_pop3
</span></span></code></pre></div><h4 id="32-wattersons-Î¸-theta">3.2 Watterson&rsquo;s Î¸ (Theta)<a hidden class="anchor" aria-hidden="true" href="#32-wattersons-Î¸-theta">#</a></h4>
<p><strong>å®šä¹‰ï¼š</strong>
åŸºäºåˆ†ç¦»ä½ç‚¹ï¼ˆsegregating sitesï¼‰æ•°ç›®çš„æ ¸è‹·é…¸å¤šæ ·æ€§ä¼°è®¡é‡</p>
<p><strong>è®¡ç®—å…¬å¼ï¼š</strong></p>
<pre tabindex="0"><code>Î¸ = S / an
</code></pre><p>å…¶ä¸­ï¼š</p>
<ul>
<li>Sï¼šåˆ†ç¦»ä½ç‚¹æ•°ç›®</li>
<li>anï¼šè°ƒå’Œçº§æ•°å’Œï¼Œan = Î£[1/(i-1)], iä»2åˆ°n</li>
</ul>
<p><strong>ç”Ÿç‰©å­¦æ„ä¹‰ï¼š</strong></p>
<ul>
<li>ä¸Ï€ç±»ä¼¼ï¼Œä¹Ÿæ˜¯è¡¡é‡é—ä¼ å¤šæ ·æ€§çš„æŒ‡æ ‡</li>
<li>åœ¨ä¸­æ€§è¿›åŒ–æ¡ä»¶ä¸‹ï¼ŒÎ¸ â‰ˆ Ï€</li>
<li>Ï€ &lt; Î¸ï¼šè¯´æ˜ç¾¤ä½“ç»å†äº†æ‰©å¼ </li>
<li>Ï€ &gt; Î¸ï¼šè¯´æ˜å­˜åœ¨å¹³è¡¡é€‰æ‹©æˆ–ç¾¤ä½“æ”¶ç¼©</li>
</ul>
<p><strong>è®¡ç®—æ–¹æ³•ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">PopGenome</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">readVCF</span><span class="p">(</span><span class="s">&#34;cohort.vcf.gz&#34;</span><span class="p">,</span> <span class="n">include.unknown</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—Watterson&#39;s Î¸</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">neutrality.stats</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æå–ç»“æœ</span>
</span></span><span class="line"><span class="cl"><span class="n">theta</span> <span class="o">&lt;-</span> <span class="n">data</span><span class="o">@</span><span class="n">Watterson.theta</span>
</span></span><span class="line"><span class="cl"><span class="n">theta</span> <span class="o">&lt;-</span> <span class="n">data</span><span class="o">@</span><span class="n">Tajimas.D</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;Watterson&#39;s Î¸: &#34;</span><span class="p">,</span> <span class="n">theta</span><span class="p">))</span>
</span></span></code></pre></div><p><strong>Tajima&rsquo;s Dæ£€éªŒï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨VCFtools</span>
</span></span><span class="line"><span class="cl">vcftools --vcf cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">         --TajimaD <span class="m">100000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --out tajimaD
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºæ–‡ä»¶ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - tajimaD.Tajima.D: çª—å£Tajima&#39;s Då€¼</span>
</span></span></code></pre></div><hr>
<h3 id="å››å›ºå®šæŒ‡æ•°-fst">å››ã€å›ºå®šæŒ‡æ•° (FST)<a hidden class="anchor" aria-hidden="true" href="#å››å›ºå®šæŒ‡æ•°-fst">#</a></h3>
<h4 id="41-fstè®¡ç®—">4.1 FSTè®¡ç®—<a hidden class="anchor" aria-hidden="true" href="#41-fstè®¡ç®—">#</a></h4>
<p><strong>å®šä¹‰ï¼š</strong>
FSTï¼ˆFixation Indexï¼‰æ˜¯è¡¡é‡ç¾¤ä½“é—´é—ä¼ åˆ†åŒ–ç¨‹åº¦çš„æŒ‡æ ‡</p>
<p><strong>å–å€¼èŒƒå›´åŠæ„ä¹‰ï¼š</strong></p>
<table>
  <thead>
      <tr>
          <th>FSTå€¼</th>
          <th>åˆ†åŒ–ç¨‹åº¦</th>
          <th>è§£é‡Š</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>0 - 0.05</td>
          <td>å¾ˆå°</td>
          <td>ç¾¤ä½“é—´å‡ ä¹æ— åˆ†åŒ–</td>
      </tr>
      <tr>
          <td>0.05 - 0.15</td>
          <td>ä¸­ç­‰</td>
          <td>ç¾¤ä½“é—´æœ‰ä¸€å®šåˆ†åŒ–</td>
      </tr>
      <tr>
          <td>0.15 - 0.25</td>
          <td>è¾ƒå¤§</td>
          <td>ç¾¤ä½“é—´åˆ†åŒ–æ˜¾è‘—</td>
      </tr>
      <tr>
          <td>&gt; 0.25</td>
          <td>æå¤§</td>
          <td>ç¾¤ä½“é—´åˆ†åŒ–æå¤§</td>
      </tr>
  </tbody>
</table>
<p><strong>ä½¿ç”¨VCFtoolsè®¡ç®—ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å‡†å¤‡ç¾¤ä½“æ–‡ä»¶ï¼ˆæ¯è¡Œä¸€ä¸ªæ ·æœ¬IDï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># population1.txt</span>
</span></span><span class="line"><span class="cl">Sample001
</span></span><span class="line"><span class="cl">Sample002
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># population2.txt</span>
</span></span><span class="line"><span class="cl">Sample101
</span></span><span class="line"><span class="cl">Sample102
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—ä¸¤ç¾¤ä½“é—´FSTï¼ˆå•ç‚¹ï¼‰</span>
</span></span><span class="line"><span class="cl">vcftools --vcf cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">         --weir-fst-pop population1.txt <span class="se">\
</span></span></span><span class="line"><span class="cl">         --weir-fst-pop population2.txt <span class="se">\
</span></span></span><span class="line"><span class="cl">         --out fst_pop1_pop2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ»‘åŠ¨çª—å£FST</span>
</span></span><span class="line"><span class="cl">vcftools --vcf cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">         --weir-fst-pop population1.txt <span class="se">\
</span></span></span><span class="line"><span class="cl">         --weir-fst-pop population2.txt <span class="se">\
</span></span></span><span class="line"><span class="cl">         --fst-window-size <span class="m">100000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --fst-window-step <span class="m">50000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --out fst_window
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‚æ•°è¯´æ˜ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --weir-fst-pop: æŒ‡å®šä¸€ä¸ªç¾¤ä½“çš„æ ·æœ¬æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --fst-window-size: çª—å£å¤§å°ï¼ˆbpï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --fst-window-step: æ»‘åŠ¨æ­¥é•¿ï¼ˆbpï¼‰</span>
</span></span></code></pre></div><p><strong>ä½¿ç”¨PopGenomeï¼ˆRåŒ…ï¼‰ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">PopGenome</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">readVCF</span><span class="p">(</span><span class="s">&#34;cohort.vcf.gz&#34;</span><span class="p">,</span> <span class="n">include.unknown</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">gffpath</span><span class="o">=</span><span class="s">&#34;annotation.gff&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å®šä¹‰ç¾¤ä½“</span>
</span></span><span class="line"><span class="cl"><span class="n">populations</span> <span class="o">&lt;-</span> <span class="nf">list</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">pop1</span> <span class="o">=</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;population1.txt&#34;</span><span class="p">)</span><span class="o">$</span><span class="n">V1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">pop2</span> <span class="o">=</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;population2.txt&#34;</span><span class="p">)</span><span class="o">$</span><span class="n">V1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">pop3</span> <span class="o">=</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;population3.txt&#34;</span><span class="p">)</span><span class="o">$</span><span class="n">V1</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¾ç½®ç¾¤ä½“</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">set.populations</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">populations</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—FST</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">F_ST.stats</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#34;nucleotide&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æå–ç»“æœ</span>
</span></span><span class="line"><span class="cl"><span class="n">fst_matrix</span> <span class="o">&lt;-</span> <span class="n">data</span><span class="o">@</span><span class="n">F_ST.matrix</span>
</span></span><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">fst_matrix</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æˆå¯¹ç¾¤ä½“FST</span>
</span></span><span class="line"><span class="cl"><span class="kr">for</span> <span class="p">(</span><span class="n">i</span> <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="p">(</span><span class="nf">nrow</span><span class="p">(</span><span class="n">fst_matrix</span><span class="p">)</span><span class="m">-1</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">for</span> <span class="p">(</span><span class="n">j</span> <span class="kr">in</span> <span class="p">(</span><span class="n">i</span><span class="m">+1</span><span class="p">)</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">fst_matrix</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">cat</span><span class="p">(</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">&#34;FST(%s, %s) = %.4f\n&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nf">rownames</span><span class="p">(</span><span class="n">fst_matrix</span><span class="p">)</span><span class="n">[i]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nf">colnames</span><span class="p">(</span><span class="n">fst_matrix</span><span class="p">)</span><span class="n">[j]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">fst_matrix[i</span><span class="p">,</span><span class="n">j]</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>å¯è§†åŒ–FSTåˆ†å¸ƒï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–çª—å£FSTç»“æœ</span>
</span></span><span class="line"><span class="cl"><span class="n">fst_data</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;fst_window.windowed.weir.fst&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜åˆ¶æ›¼å“ˆé¡¿å¼FSTå›¾</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">fst_data</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">POS</span><span class="o">/</span><span class="m">1000000</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">WEIR_AND_COCKERHAM_FST</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="m">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;steelblue&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="m">0.15</span><span class="p">,</span> <span class="n">linetype</span><span class="o">=</span><span class="s">&#34;dashed&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">CHROM</span><span class="p">,</span> <span class="n">scales</span><span class="o">=</span><span class="s">&#34;free_x&#34;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="m">4</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&#34;Position (Mb)&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&#34;FST&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">title</span><span class="o">=</span><span class="s">&#34;Genome-wide FST between Population 1 and 2&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_bw</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme</span><span class="p">(</span><span class="n">strip.text</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">8</span><span class="p">))</span>
</span></span></code></pre></div><p><strong>FSTçƒ­å›¾ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">pheatmap</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜åˆ¶FSTçŸ©é˜µçƒ­å›¾</span>
</span></span><span class="line"><span class="cl"><span class="nf">pheatmap</span><span class="p">(</span><span class="n">fst_matrix</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">display_numbers</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">number_format</span><span class="o">=</span><span class="s">&#34;%.3f&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">main</span><span class="o">=</span><span class="s">&#34;Pairwise FST between Populations&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">color</span><span class="o">=</span><span class="nf">colorRampPalette</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;white&#34;</span><span class="p">,</span> <span class="s">&#34;orange&#34;</span><span class="p">,</span> <span class="s">&#34;red&#34;</span><span class="p">))(</span><span class="m">50</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">         <span class="n">breaks</span><span class="o">=</span><span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="nf">max</span><span class="p">(</span><span class="n">fst_matrix</span><span class="p">),</span> <span class="n">length.out</span><span class="o">=</span><span class="m">51</span><span class="p">))</span>
</span></span></code></pre></div><hr>
<h3 id="äº”é€‰æ‹©æ¸…é™¤åˆ†æ">äº”ã€é€‰æ‹©æ¸…é™¤åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#äº”é€‰æ‹©æ¸…é™¤åˆ†æ">#</a></h3>
<h4 id="51-æ ¸è‹·é…¸å¤šæ ·æ€§æ¯”å€¼-Ï€-ratio">5.1 æ ¸è‹·é…¸å¤šæ ·æ€§æ¯”å€¼ (Ï€-ratio)<a hidden class="anchor" aria-hidden="true" href="#51-æ ¸è‹·é…¸å¤šæ ·æ€§æ¯”å€¼-Ï€-ratio">#</a></h4>
<p><strong>åŸç†ï¼š</strong>
å—é€‰æ‹©åŒºåŸŸçš„æ ¸è‹·é…¸å¤šæ ·æ€§ä¼šæ˜¾è‘—é™ä½ï¼Œé€šè¿‡è®¡ç®—ä¸åŒç¾¤ä½“é—´Ï€çš„æ¯”å€¼å¯ä»¥æ£€æµ‹é€‰æ‹©ä¿¡å·</p>
<p><strong>è®¡ç®—å…¬å¼ï¼š</strong></p>
<pre tabindex="0"><code>Ï€-ratio = Ï€_selected / Ï€_control
</code></pre><p>ä½Ï€-ratioå€¼ï¼šè¯¥åŒºåŸŸå¯èƒ½ç»å†äº†æ­£é€‰æ‹©</p>
<p><strong>åˆ†ææµç¨‹ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Step 1: è®¡ç®—å„ç¾¤ä½“Ï€</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç¾¤ä½“1ï¼ˆå‡è®¾ä¸ºå—é€‰æ‹©ç¾¤ä½“ï¼‰</span>
</span></span><span class="line"><span class="cl">vcftools --vcf cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">         --keep population1.txt <span class="se">\
</span></span></span><span class="line"><span class="cl">         --window-pi <span class="m">100000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --window-pi-step <span class="m">50000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --out pi_pop1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¾¤ä½“2ï¼ˆå¯¹ç…§ç¾¤ä½“ï¼‰</span>
</span></span><span class="line"><span class="cl">vcftools --vcf cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">         --keep population2.txt <span class="se">\
</span></span></span><span class="line"><span class="cl">         --window-pi <span class="m">100000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --window-pi-step <span class="m">50000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --out pi_pop2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 2: è®¡ç®—Ï€-ratioï¼ˆä½¿ç”¨Pythonæˆ–Rï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Pythonç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl">import pandas as pd
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">pi1</span> <span class="o">=</span> pd.read_csv<span class="o">(</span><span class="s2">&#34;pi_pop1.windowed.pi&#34;</span>, <span class="nv">sep</span><span class="o">=</span><span class="s2">&#34;\t&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">pi2</span> <span class="o">=</span> pd.read_csv<span class="o">(</span><span class="s2">&#34;pi_pop2.windowed.pi&#34;</span>, <span class="nv">sep</span><span class="o">=</span><span class="s2">&#34;\t&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">pi_ratio</span> <span class="o">=</span> pi1.copy<span class="o">()</span>
</span></span><span class="line"><span class="cl">pi_ratio<span class="o">[</span><span class="s2">&#34;PI_RATIO&#34;</span><span class="o">]</span> <span class="o">=</span> pi1<span class="o">[</span><span class="s2">&#34;PI&#34;</span><span class="o">]</span> / pi2<span class="o">[</span><span class="s2">&#34;PI&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">pi_ratio.to_csv<span class="o">(</span><span class="s2">&#34;pi_ratio.txt&#34;</span>, <span class="nv">sep</span><span class="o">=</span><span class="s2">&#34;\t&#34;</span>, <span class="nv">index</span><span class="o">=</span>False<span class="o">)</span>
</span></span></code></pre></div><p><strong>Rè¯­è¨€å¯è§†åŒ–ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">pi1</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;pi_pop1.windowed.pi&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pi2</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;pi_pop2.windowed.pi&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—Ï€-ratio</span>
</span></span><span class="line"><span class="cl"><span class="n">pi_ratio</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">CHROM</span> <span class="o">=</span> <span class="n">pi1</span><span class="o">$</span><span class="n">CHROM</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">BIN_START</span> <span class="o">=</span> <span class="n">pi1</span><span class="o">$</span><span class="n">BIN_START</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">BIN_END</span> <span class="o">=</span> <span class="n">pi1</span><span class="o">$</span><span class="n">BIN_END</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">PI_RATIO</span> <span class="o">=</span> <span class="n">pi1</span><span class="o">$</span><span class="n">PI</span> <span class="o">/</span> <span class="n">pi2</span><span class="o">$</span><span class="n">PI</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯†åˆ«é€‰æ‹©ä¿¡å·ï¼ˆé˜ˆå€¼ï¼š5%åˆ†ä½æ•°ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">threshold</span> <span class="o">&lt;-</span> <span class="nf">quantile</span><span class="p">(</span><span class="n">pi_ratio</span><span class="o">$</span><span class="n">PI_RATIO</span><span class="p">,</span> <span class="m">0.05</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">candidates</span> <span class="o">&lt;-</span> <span class="n">pi_ratio[pi_ratio</span><span class="o">$</span><span class="n">PI_RATIO</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯è§†åŒ–</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">pi_ratio</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BIN_START</span><span class="o">/</span><span class="m">1000000</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">PI_RATIO</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&#34;steelblue&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">linetype</span><span class="o">=</span><span class="s">&#34;dashed&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="n">color</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_point</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">candidates</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BIN_START</span><span class="o">/</span><span class="m">1000000</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">PI_RATIO</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">               <span class="n">color</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">CHROM</span><span class="p">,</span> <span class="n">scales</span><span class="o">=</span><span class="s">&#34;free_x&#34;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="m">4</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&#34;Position (Mb)&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&#34;Ï€ Ratio (Pop1/Pop2)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">title</span><span class="o">=</span><span class="s">&#34;Nucleotide Diversity Ratio Scan&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_bw</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºå€™é€‰åŒºåŸŸ</span>
</span></span><span class="line"><span class="cl"><span class="nf">write.table</span><span class="p">(</span><span class="n">candidates</span><span class="p">,</span> <span class="s">&#34;selection_candidates.txt&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">sep</span><span class="o">=</span><span class="s">&#34;\t&#34;</span><span class="p">,</span> <span class="n">row.names</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">,</span> <span class="n">quote</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
</span></span></code></pre></div><h4 id="52-xp-clr-è·¨ç¾¤ä½“å¤åˆä¼¼ç„¶æ¯”æ£€éªŒ">5.2 XP-CLR (è·¨ç¾¤ä½“å¤åˆä¼¼ç„¶æ¯”æ£€éªŒ)<a hidden class="anchor" aria-hidden="true" href="#52-xp-clr-è·¨ç¾¤ä½“å¤åˆä¼¼ç„¶æ¯”æ£€éªŒ">#</a></h4>
<p><strong>åŸç†ï¼š</strong>
æ£€æµ‹ç”±äºé€‰æ‹©å¼•èµ·çš„ç¾¤ä½“é—´ç­‰ä½åŸºå› é¢‘ç‡å·®å¼‚ï¼Œè€ƒè™‘äº†è¿é”ä¸å¹³è¡¡å’Œé—ä¼ é‡ç»„</p>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>ä¸éœ€è¦å•ä½“å‹ç›¸ä½ä¿¡æ¯</li>
<li>é€‚ç”¨äºå¤§æ•°æ®é›†</li>
<li>å¯¹å¤è€é€‰æ‹©ä¿¡å·æ•æ„Ÿ</li>
</ul>
<p><strong>åˆ†ææµç¨‹ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Step 1: å‡†å¤‡è¾“å…¥æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="c1"># XP-CLRè¦æ±‚ç‰¹å®šçš„æ ¼å¼ï¼šChrom  Position  Likelihood</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å°†VCFè½¬æ¢ä¸ºXP-CLRæ ¼å¼</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰è„šæœ¬æˆ–vcftools</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æå–å¤šç­‰ä½åŸºå› ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">vcftools --vcf cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">         --freq <span class="se">\
</span></span></span><span class="line"><span class="cl">         --out allele_freq
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 2: è¿è¡ŒXP-CLR</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å®‰è£…XP-CLRå</span>
</span></span><span class="line"><span class="cl">xpclr -xpclr cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">       -w1 <span class="m">1</span> <span class="m">200</span> <span class="m">2000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">       -w2 <span class="m">1</span> <span class="m">100</span> <span class="m">1000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">       -p0 0.001 <span class="se">\
</span></span></span><span class="line"><span class="cl">       -maxSNP <span class="m">1000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">       -out xpclr_result
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‚æ•°è¯´æ˜ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -w1: çª—å£å‚æ•°ï¼ˆå¤§å°ï¼Œæ­¥é•¿ï¼Œæœ€å¤§SNPæ•°ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -w2: ç¬¬äºŒä¸ªçª—å£å‚æ•°</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -p0: ç½®ä¿¡åº¦é˜ˆå€¼</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -maxSNP: æ¯ä¸ªçª—å£çš„æœ€å¤§SNPæ•°</span>
</span></span></code></pre></div><p><strong>ç»“æœå¯è§†åŒ–ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–XP-CLRç»“æœ</span>
</span></span><span class="line"><span class="cl"><span class="n">xpclr</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;xpclr_result&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">colnames</span><span class="p">(</span><span class="n">xpclr</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;CHROM&#34;</span><span class="p">,</span> <span class="s">&#34;Position&#34;</span><span class="p">,</span> <span class="s">&#34;XP_CLR_Score&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                     <span class="s">&#34;Ref_Freq&#34;</span><span class="p">,</span> <span class="s">&#34;Alt_Freq&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—æ»‘åŠ¨çª—å£å¹³å‡</span>
</span></span><span class="line"><span class="cl"><span class="n">window_size</span> <span class="o">&lt;-</span> <span class="m">100000</span>  <span class="c1"># 100 kb</span>
</span></span><span class="line"><span class="cl"><span class="n">xpclr</span><span class="o">$</span><span class="n">Window</span> <span class="o">&lt;-</span> <span class="nf">floor</span><span class="p">(</span><span class="n">xpclr</span><span class="o">$</span><span class="n">Position</span> <span class="o">/</span> <span class="n">window_size</span><span class="p">)</span> <span class="o">*</span> <span class="n">window_size</span>
</span></span><span class="line"><span class="cl"><span class="n">xpclr_avg</span> <span class="o">&lt;-</span> <span class="nf">aggregate</span><span class="p">(</span><span class="n">XP_CLR_Score</span> <span class="o">~</span> <span class="n">Window</span> <span class="o">+</span> <span class="n">CHROM</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                       <span class="n">data</span><span class="o">=</span><span class="n">xpclr</span><span class="p">,</span> <span class="n">FUN</span><span class="o">=</span><span class="n">mean</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜åˆ¶XP-CLRæ‰«æå›¾</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">xpclr_avg</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Window</span><span class="o">/</span><span class="m">1000000</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">XP_CLR_Score</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&#34;steelblue&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">CHROM</span><span class="p">,</span> <span class="n">scales</span><span class="o">=</span><span class="s">&#34;free_x&#34;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="m">4</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&#34;Position (Mb)&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&#34;XP-CLR Score&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">title</span><span class="o">=</span><span class="s">&#34;XP-CLR Scan for Selection Signals&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_bw</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯†åˆ«æ˜¾è‘—å³°ï¼ˆé˜ˆå€¼ï¼štop 1%ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">threshold</span> <span class="o">&lt;-</span> <span class="nf">quantile</span><span class="p">(</span><span class="n">xpclr_avg</span><span class="o">$</span><span class="n">XP_CLR_Score</span><span class="p">,</span> <span class="m">0.99</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">peaks</span> <span class="o">&lt;-</span> <span class="n">xpclr_avg[xpclr_avg</span><span class="o">$</span><span class="n">XP_CLR_Score</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ ‡æ³¨æ˜¾è‘—å³°</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">xpclr_avg</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Window</span><span class="o">/</span><span class="m">1000000</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">XP_CLR_Score</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_line</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&#34;gray&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_point</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">peaks</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Window</span><span class="o">/</span><span class="m">1000000</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">XP_CLR_Score</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">               <span class="n">color</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">2</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="n">threshold</span><span class="p">,</span> <span class="n">linetype</span><span class="o">=</span><span class="s">&#34;dashed&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="n">color</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">CHROM</span><span class="p">,</span> <span class="n">scales</span><span class="o">=</span><span class="s">&#34;free_x&#34;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="m">4</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&#34;Position (Mb)&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&#34;XP-CLR Score&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">title</span><span class="o">=</span><span class="s">&#34;Significant Selection Peaks&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_bw</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="53-xp-ehh-äº¤å‰ç¾¤ä½“æ‰©å±•å•ä½“å‹çº¯åˆæ€§">5.3 XP-EHH (äº¤å‰ç¾¤ä½“æ‰©å±•å•ä½“å‹çº¯åˆæ€§)<a hidden class="anchor" aria-hidden="true" href="#53-xp-ehh-äº¤å‰ç¾¤ä½“æ‰©å±•å•ä½“å‹çº¯åˆæ€§">#</a></h4>
<p><strong>åŸç†ï¼š</strong>
æ£€æµ‹ä¸€ä¸ªç¾¤ä½“ä¸­å·²ç»å®Œæˆçš„æ­£é€‰æ‹©ï¼ˆå•ä½“å‹é¢‘ç‡é«˜ä¸”æ‰©å±•èŒƒå›´å¤§ï¼‰ï¼Œè€Œå¦ä¸€ç¾¤ä½“ä¸­æœªå®Œæˆçš„é€‰æ‹©</p>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>é€‚ç”¨äºæ£€æµ‹è¿‘æœŸçš„é€‰æ‹©äº‹ä»¶</li>
<li>éœ€è¦å•ä½“å‹ç›¸ä½ä¿¡æ¯</li>
</ul>
<p><strong>åˆ†ææµç¨‹ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Step 1: å‡†å¤‡PLINKæ ¼å¼æ•°æ®</span>
</span></span><span class="line"><span class="cl">plink --vcf cohort.vcf.gz --make-bed --out cohort
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 2: ç›¸ä½æ¨æ–­ï¼ˆä½¿ç”¨SHAPEITæˆ–BEAGLEï¼‰</span>
</span></span><span class="line"><span class="cl">shapeit -B cohort <span class="se">\
</span></span></span><span class="line"><span class="cl">        -M genetic_map.txt <span class="se">\
</span></span></span><span class="line"><span class="cl">        -O cohort.phased <span class="se">\
</span></span></span><span class="line"><span class="cl">        --thread <span class="m">8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æˆ–ä½¿ç”¨beagle</span>
</span></span><span class="line"><span class="cl">beagle <span class="nv">gt</span><span class="o">=</span>cohort.bed <span class="se">\
</span></span></span><span class="line"><span class="cl">       <span class="nv">out</span><span class="o">=</span>cohort.phased <span class="se">\
</span></span></span><span class="line"><span class="cl">       <span class="nv">nthreads</span><span class="o">=</span><span class="m">8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 3: è¿è¡ŒXP-EHHï¼ˆä½¿ç”¨selscanï¼‰</span>
</span></span><span class="line"><span class="cl">selscan --xpehh <span class="se">\
</span></span></span><span class="line"><span class="cl">        --vcf cohort.phased.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">        --map genetic_map.txt <span class="se">\
</span></span></span><span class="line"><span class="cl">        --pop1 population1.txt <span class="se">\
</span></span></span><span class="line"><span class="cl">        --pop2 population2.txt <span class="se">\
</span></span></span><span class="line"><span class="cl">        --out xpehh_result
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‚æ•°è¯´æ˜ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --xpehh: è¿è¡ŒXP-EHHæ¨¡å¼</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --pop1: ç¾¤ä½“1çš„æ ·æœ¬åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --pop2: ç¾¤ä½“2çš„æ ·æœ¬åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 4: æ ‡å‡†åŒ–XP-EHHå¾—åˆ†</span>
</span></span><span class="line"><span class="cl">norm --xpehh --files xpehh_result
</span></span></code></pre></div><p><strong>ç»“æœå¯è§†åŒ–ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–æ ‡å‡†åŒ–åçš„XP-EHHç»“æœ</span>
</span></span><span class="line"><span class="cl"><span class="n">xpehh</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;xpehh_result.norm.xpehh&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜åˆ¶XP-EHHæ‰«æå›¾</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">xpehh</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">POS</span><span class="o">/</span><span class="m">1000000</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">normXPEHH</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="m">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;steelblue&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">linetype</span><span class="o">=</span><span class="s">&#34;dashed&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;gray50&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">linetype</span><span class="o">=</span><span class="s">&#34;dashed&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=</span><span class="m">-2</span><span class="p">,</span> <span class="n">linetype</span><span class="o">=</span><span class="s">&#34;dashed&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;blue&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">CHR</span><span class="p">,</span> <span class="n">scales</span><span class="o">=</span><span class="s">&#34;free_x&#34;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="m">4</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&#34;Position (Mb)&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&#34;Standardized XP-EHH&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">title</span><span class="o">=</span><span class="s">&#34;XP-EHH Scan&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_bw</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯†åˆ«æ˜¾è‘—ä¿¡å·ï¼ˆ|XP-EHH| &gt; 2ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">candidates_pos</span> <span class="o">&lt;-</span> <span class="n">xpehh[xpehh</span><span class="o">$</span><span class="n">normXPEHH</span> <span class="o">&gt;</span> <span class="m">2</span><span class="p">,</span> <span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="n">candidates_neg</span> <span class="o">&lt;-</span> <span class="n">xpehh[xpehh</span><span class="o">$</span><span class="n">normXPEHH</span> <span class="o">&lt;</span> <span class="m">-2</span><span class="p">,</span> <span class="n">]</span>
</span></span></code></pre></div><h4 id="54-tajimas-d">5.4 Tajima&rsquo;s D<a hidden class="anchor" aria-hidden="true" href="#54-tajimas-d">#</a></h4>
<p><strong>å®šä¹‰ï¼š</strong>
åŸºäºç­‰ä½åŸºå› é¢‘è°±çš„ä¸­æ€§æ£€éªŒç»Ÿè®¡é‡</p>
<p><strong>è®¡ç®—å…¬å¼ï¼š</strong></p>
<pre tabindex="0"><code>D = (Ï€ - Î¸) / SD(Ï€ - Î¸)
</code></pre><p><strong>å–å€¼åŠç”Ÿç‰©å­¦æ„ä¹‰ï¼š</strong></p>
<table>
  <thead>
      <tr>
          <th>Då€¼</th>
          <th>æ„ä¹‰</th>
          <th>è¿›åŒ–è§£é‡Š</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>D &raquo; 0</td>
          <td>æ˜¾è‘—ä¸ºæ­£</td>
          <td>ç¾¤ä½“æ”¶ç¼©æˆ–å¹³è¡¡é€‰æ‹©</td>
      </tr>
      <tr>
          <td>D â‰ˆ 0</td>
          <td>æ¥è¿‘0</td>
          <td>ç¬¦åˆä¸­æ€§è¿›åŒ–</td>
      </tr>
      <tr>
          <td>D &laquo; 0</td>
          <td>æ˜¾è‘—ä¸ºè´Ÿ</td>
          <td>ç¾¤ä½“æ‰©å¼ æˆ–æ­£é€‰æ‹©</td>
      </tr>
  </tbody>
</table>
<p><strong>ä½¿ç”¨VCFtoolsè®¡ç®—ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æ»‘åŠ¨çª—å£Tajima&#39;s D</span>
</span></span><span class="line"><span class="cl">vcftools --vcf cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">         --TajimaD <span class="m">100000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --out tajimaD
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‚æ•°è¯´æ˜ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --TajimaD: çª—å£å¤§å°ï¼ˆbpï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºæ–‡ä»¶ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - tajimaD.Tajima.D: çª—å£Tajima&#39;s Då€¼</span>
</span></span></code></pre></div><p><strong>ä½¿ç”¨PopGenomeï¼ˆRåŒ…ï¼‰ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">PopGenome</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">readVCF</span><span class="p">(</span><span class="s">&#34;cohort.vcf.gz&#34;</span><span class="p">,</span> <span class="n">include.unknown</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ»‘åŠ¨çª—å£åˆ†æ</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">sliding.window.transform</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="m">100000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="m">50000</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—Tajima&#39;s D</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">&lt;-</span> <span class="nf">neutrality.stats</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æå–ç»“æœ</span>
</span></span><span class="line"><span class="cl"><span class="n">tajima_d</span> <span class="o">&lt;-</span> <span class="n">data</span><span class="o">@</span><span class="n">Tajimas.D</span>
</span></span><span class="line"><span class="cl"><span class="n">window_positions</span> <span class="o">&lt;-</span> <span class="n">data</span><span class="o">@</span><span class="n">sliding.window.positions</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯è§†åŒ–</span>
</span></span><span class="line"><span class="cl"><span class="nf">plot</span><span class="p">(</span><span class="n">window_positions</span><span class="o">/</span><span class="m">1000000</span><span class="p">,</span> <span class="n">tajima_d</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="n">type</span><span class="o">=</span><span class="s">&#34;l&#34;</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;steelblue&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="n">xlab</span><span class="o">=</span><span class="s">&#34;Genome Position (Mb)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="n">ylab</span><span class="o">=</span><span class="s">&#34;Tajima&#39;s D&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="n">main</span><span class="o">=</span><span class="s">&#34;Tajima&#39;s D Scan&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ·»åŠ é˜ˆå€¼çº¿ï¼ˆæ˜¾è‘—æ€§æ°´å¹³ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="nf">abline</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="m">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>  <span class="c1"># æ˜¾è‘—æ­£Då€¼</span>
</span></span><span class="line"><span class="cl"><span class="nf">abline</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="m">-2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#34;blue&#34;</span><span class="p">,</span> <span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>  <span class="c1"># æ˜¾è‘—è´ŸDå€¼</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯†åˆ«æ˜¾è‘—çª—å£</span>
</span></span><span class="line"><span class="cl"><span class="n">sig_pos</span> <span class="o">&lt;-</span> <span class="nf">which</span><span class="p">(</span><span class="n">tajima_d</span> <span class="o">&gt;</span> <span class="m">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">sig_neg</span> <span class="o">&lt;-</span> <span class="nf">which</span><span class="p">(</span><span class="n">tajima_d</span> <span class="o">&lt;</span> <span class="m">-2</span><span class="p">)</span>
</span></span></code></pre></div><hr>
<h3 id="å…­å…¨åŸºå› ç»„å…³è”åˆ†æ-gwas">å…­ã€å…¨åŸºå› ç»„å…³è”åˆ†æ (GWAS)<a hidden class="anchor" aria-hidden="true" href="#å…­å…¨åŸºå› ç»„å…³è”åˆ†æ-gwas">#</a></h3>
<h4 id="61-åˆ†ææµç¨‹æ€»è§ˆ">6.1 åˆ†ææµç¨‹æ€»è§ˆ<a hidden class="anchor" aria-hidden="true" href="#61-åˆ†ææµç¨‹æ€»è§ˆ">#</a></h4>
<pre tabindex="0"><code>è¡¨å‹æ•°æ®æ”¶é›† â†’ åŸºå› å‹æ•°æ®è´¨æ§ â†’ ç¾¤ä½“ç»“æ„æ§åˆ¶ â†’ å…³è”åˆ†æ â†’ å¤šé‡æ£€éªŒæ ¡æ­£ â†’ ç»“æœå¯è§†åŒ– â†’ å€™é€‰åŸºå› é‰´å®š
</code></pre><h4 id="62-æ•°æ®å‡†å¤‡">6.2 æ•°æ®å‡†å¤‡<a hidden class="anchor" aria-hidden="true" href="#62-æ•°æ®å‡†å¤‡">#</a></h4>
<p><strong>è¡¨å‹æ–‡ä»¶ï¼š</strong></p>
<pre tabindex="0"><code>Sample_ID    Trait1    Trait2    Trait3
Sample001    10.5      25.3      1.2
Sample002    12.3      28.1      1.5
Sample003    9.8       24.7      1.1
...
</code></pre><p><strong>åŸºå› å‹æ–‡ä»¶ï¼š</strong></p>
<ul>
<li>VCFæ ¼å¼</li>
<li>PLINK BEDæ ¼å¼</li>
<li>HapMapæ ¼å¼</li>
</ul>
<p><strong>ç¾¤ä½“ç»“æ„æ–‡ä»¶ï¼ˆå¯é€‰ä½†æ¨èï¼‰ï¼š</strong></p>
<ul>
<li>QçŸ©é˜µï¼šä»ADMIXTUREæˆ–STRUCTUREè·å¾—</li>
<li>PCçŸ©é˜µï¼šä»PCAè·å¾—</li>
</ul>
<h4 id="63-åŸºå› å‹æ•°æ®è´¨æ§">6.3 åŸºå› å‹æ•°æ®è´¨æ§<a hidden class="anchor" aria-hidden="true" href="#63-åŸºå› å‹æ•°æ®è´¨æ§">#</a></h4>
<p><strong>è´¨æ§æ ‡å‡†ï¼š</strong></p>
<table>
  <thead>
      <tr>
          <th>å‚æ•°</th>
          <th>é˜ˆå€¼</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>MAF</td>
          <td>&gt; 0.05</td>
          <td>æœ€å°ç­‰ä½åŸºå› é¢‘ç‡</td>
      </tr>
      <tr>
          <td>Missing rate</td>
          <td>&lt; 0.1</td>
          <td>ç¼ºå¤±ç‡ï¼ˆä½ç‚¹ï¼‰</td>
      </tr>
      <tr>
          <td>HWE P</td>
          <td>&gt; 1e-6</td>
          <td>å“ˆä»£-æ¸©ä¼¯æ ¼å¹³è¡¡på€¼</td>
      </tr>
      <tr>
          <td>Geno missing</td>
          <td>&lt; 0.1</td>
          <td>ç¼ºå¤±ç‡ï¼ˆä¸ªä½“ï¼‰</td>
      </tr>
  </tbody>
</table>
<p><strong>ä½¿ç”¨PLINKè¿›è¡Œè´¨æ§ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Step 1: è½¬æ¢æ ¼å¼</span>
</span></span><span class="line"><span class="cl">plink --vcf cohort.vcf.gz --make-bed --out gwas_raw
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 2: åŸºæœ¬è´¨æ§</span>
</span></span><span class="line"><span class="cl">plink --bfile gwas_raw <span class="se">\
</span></span></span><span class="line"><span class="cl">      --maf 0.05 <span class="se">\
</span></span></span><span class="line"><span class="cl">      --geno 0.1 <span class="se">\
</span></span></span><span class="line"><span class="cl">      --hwe 1e-6 <span class="se">\
</span></span></span><span class="line"><span class="cl">      --mind 0.1 <span class="se">\
</span></span></span><span class="line"><span class="cl">      --make-bed <span class="se">\
</span></span></span><span class="line"><span class="cl">      --out gwas_cleaned
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 3: å»é™¤ç›¸å…³æ ·æœ¬ï¼ˆå¯é€‰ï¼‰</span>
</span></span><span class="line"><span class="cl">plink --bfile gwas_cleaned <span class="se">\
</span></span></span><span class="line"><span class="cl">      --indep-pairwise <span class="m">50</span> <span class="m">5</span> 0.2 <span class="se">\
</span></span></span><span class="line"><span class="cl">      --out prune
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">plink --bfile gwas_cleaned <span class="se">\
</span></span></span><span class="line"><span class="cl">      --extract prune.prune.in <span class="se">\
</span></span></span><span class="line"><span class="cl">      --make-bed <span class="se">\
</span></span></span><span class="line"><span class="cl">      --out gwas_pruned
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‚æ•°è¯´æ˜ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --maf: æœ€å°ç­‰ä½åŸºå› é¢‘ç‡</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --geno: ä½ç‚¹æœ€å¤§ç¼ºå¤±ç‡</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --hwe: å“ˆä»£-æ¸©ä¼¯æ ¼å¹³è¡¡på€¼é˜ˆå€¼</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --mind: ä¸ªä½“æœ€å¤§ç¼ºå¤±ç‡</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --indep-pairwise: LDå‰ªè£ï¼ˆçª—å£å¤§å°ï¼Œæ­¥é•¿ï¼ŒrÂ²é˜ˆå€¼ï¼‰</span>
</span></span></code></pre></div><h4 id="64-å…³è”åˆ†æ">6.4 å…³è”åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#64-å…³è”åˆ†æ">#</a></h4>
<p><strong>å¸¸ç”¨è½¯ä»¶å¯¹æ¯”ï¼š</strong></p>
<table>
  <thead>
      <tr>
          <th>è½¯ä»¶</th>
          <th>æ¨¡å‹</th>
          <th>ç‰¹ç‚¹</th>
          <th>é€‚ç”¨åœºæ™¯</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>TASSEL</td>
          <td>GLM/MLM</td>
          <td>å›¾å½¢ç•Œé¢ï¼Œæ˜“äºä½¿ç”¨</td>
          <td>å°æ•°æ®é›†</td>
      </tr>
      <tr>
          <td>GAPIT</td>
          <td>å¤šç§æ¨¡å‹</td>
          <td>RåŒ…ï¼Œçµæ´»</td>
          <td>ä¸­ç­‰æ•°æ®é›†</td>
      </tr>
      <tr>
          <td>GEMMA</td>
          <td>LMM</td>
          <td>å¿«é€Ÿï¼Œå‡†ç¡®</td>
          <td>å¤§æ•°æ®é›†</td>
      </tr>
      <tr>
          <td>EMMAX</td>
          <td>LMM</td>
          <td>é«˜æ•ˆ</td>
          <td>å¤§æ•°æ®é›†</td>
      </tr>
  </tbody>
</table>
<p><strong>ä½¿ç”¨GEMMAè¿›è¡Œå…³è”åˆ†æï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Step 1: è®¡ç®—å…³ç³»çŸ©é˜µï¼ˆKinship Matrixï¼‰</span>
</span></span><span class="line"><span class="cl">gemma -bfile gwas_cleaned <span class="se">\
</span></span></span><span class="line"><span class="cl">      -gk <span class="m">1</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">      -o kinship_matrix
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># -gk 1: ä¸­å¿ƒåŒ–å…³ç³»çŸ©é˜µï¼ˆVanRaden methodï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºï¼škinship_matrix.cXX.txt</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 2: å‡†å¤‡è¡¨å‹æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ ¼å¼ï¼šSample_ID  Phenotype</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ï¼ˆéœ€è¦ä¸PLINKçš„.famæ–‡ä»¶é¡ºåºä¸€è‡´ï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 3: å…³è”åˆ†æï¼ˆçº¿æ€§æ··åˆæ¨¡å‹ï¼‰</span>
</span></span><span class="line"><span class="cl">gemma -bfile gwas_cleaned <span class="se">\
</span></span></span><span class="line"><span class="cl">      -k output/kinship_matrix.cXX.txt <span class="se">\
</span></span></span><span class="line"><span class="cl">      -lmm <span class="m">4</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">      -phenotype phenotype.txt <span class="se">\
</span></span></span><span class="line"><span class="cl">      -o gwas_result
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‚æ•°è¯´æ˜ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -k: å…³ç³»çŸ©é˜µæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -lmm: æ··åˆæ¨¡å‹æ–¹æ³•ï¼ˆ1=exact LRT, 4= Wald testï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -phenotype: è¡¨å‹æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºæ–‡ä»¶ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - gwas_result.assoc.txt: å…³è”ç»“æœ</span>
</span></span></code></pre></div><p><strong>ä½¿ç”¨GAPITï¼ˆRåŒ…ï¼‰ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">GAPIT3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">myG</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;gwas_cleaned.raw&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">myY</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;phenotype.txt&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># PCAåˆ†æï¼ˆä½œä¸ºåå˜é‡ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="n">myPCA</span> <span class="o">&lt;-</span> <span class="nf">GAPIT.PCA</span><span class="p">(</span><span class="n">myG</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿è¡ŒGWAS</span>
</span></span><span class="line"><span class="cl"><span class="n">myGWAS</span> <span class="o">&lt;-</span> <span class="nf">GAPIT</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">Y</span> <span class="o">=</span> <span class="n">myY</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">G</span> <span class="o">=</span> <span class="n">myG</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">PCA.total</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span>  <span class="c1"># ä½¿ç”¨å‰3ä¸ªPCä½œä¸ºåå˜é‡</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="s">&#34;MLM&#34;</span><span class="p">,</span>  <span class="c1"># æ··åˆçº¿æ€§æ¨¡å‹</span>
</span></span><span class="line"><span class="cl">    <span class="n">SNP.MAF</span> <span class="o">=</span> <span class="m">0.05</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¤šæ¨¡å‹æ¯”è¾ƒ</span>
</span></span><span class="line"><span class="cl"><span class="n">myGWAS_multi</span> <span class="o">&lt;-</span> <span class="nf">GAPIT</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">Y</span> <span class="o">=</span> <span class="n">myY</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">G</span> <span class="o">=</span> <span class="n">myG</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">PCA.total</span> <span class="o">=</span> <span class="m">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">model</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;GLM&#34;</span><span class="p">,</span> <span class="s">&#34;MLM&#34;</span><span class="p">,</span> <span class="s">&#34;FarmCPU&#34;</span><span class="p">,</span> <span class="s">&#34;Blink&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - myGWAS: Manhattanå›¾å’ŒQQå›¾</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - GAPIT.GWAS.Result.txt: å…³è”ç»“æœ</span>
</span></span></code></pre></div><h4 id="65-ç»“æœè§£è¯»">6.5 ç»“æœè§£è¯»<a hidden class="anchor" aria-hidden="true" href="#65-ç»“æœè§£è¯»">#</a></h4>
<p><strong>å…³è”ç»“æœæ–‡ä»¶æ ¼å¼ï¼š</strong></p>
<table>
  <thead>
      <tr>
          <th>åˆ—å</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>CHR</td>
          <td>æŸ“è‰²ä½“ç¼–å·</td>
      </tr>
      <tr>
          <td>SNP</td>
          <td>SNPæ ‡è¯†ç¬¦ï¼ˆä½ç½®æˆ–IDï¼‰</td>
      </tr>
      <tr>
          <td>BP</td>
          <td>ç‰©ç†ä½ç½®</td>
      </tr>
      <tr>
          <td>P</td>
          <td>på€¼</td>
      </tr>
      <tr>
          <td>BETA</td>
          <td>æ•ˆåº”å¤§å°</td>
      </tr>
      <tr>
          <td>SE</td>
          <td>æ ‡å‡†è¯¯</td>
      </tr>
      <tr>
          <td>R2</td>
          <td>è§£é‡Šæ–¹å·®æ¯”ä¾‹</td>
      </tr>
  </tbody>
</table>
<p><strong>å¤šé‡æ£€éªŒæ ¡æ­£ï¼š</strong></p>
<table>
  <thead>
      <tr>
          <th>æ–¹æ³•</th>
          <th>é˜ˆå€¼</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Bonferroni</td>
          <td>0.05/N</td>
          <td>ä¿å®ˆï¼Œé€‚åˆä¸¥æ ¼æ ‡å‡†</td>
      </tr>
      <tr>
          <td>FDR</td>
          <td>0.05</td>
          <td>å…è®¸5%å‡é˜³æ€§</td>
      </tr>
      <tr>
          <td>Suggestive</td>
          <td>1e-5</td>
          <td>å»ºè®®æ˜¾è‘—æ€§é˜ˆå€¼</td>
      </tr>
  </tbody>
</table>
<p><strong>åŸºå› ç»„æ˜¾è‘—æ€§é˜ˆå€¼ï¼š</strong></p>
<pre tabindex="0"><code>Bonferroni correction: 0.05 / N
å…¶ä¸­ N = æ€»SNPæ•°é‡

ä¾‹å¦‚ï¼ŒN = 1,000,000ï¼š
é˜ˆå€¼ = 0.05 / 1,000,000 = 5e-8
</code></pre><h4 id="66-ç»“æœå¯è§†åŒ–">6.6 ç»“æœå¯è§†åŒ–<a hidden class="anchor" aria-hidden="true" href="#66-ç»“æœå¯è§†åŒ–">#</a></h4>
<p><strong>æ›¼å“ˆé¡¿å›¾ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">qqman</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–ç»“æœ</span>
</span></span><span class="line"><span class="cl"><span class="n">gwas</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;gwas_result.assoc.txt&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åŸºæœ¬æ›¼å“ˆé¡¿å›¾</span>
</span></span><span class="line"><span class="cl"><span class="nf">manhattan</span><span class="p">(</span><span class="n">gwas</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">chr</span> <span class="o">=</span> <span class="s">&#34;CHR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">bp</span> <span class="o">=</span> <span class="s">&#34;BP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">p</span> <span class="o">=</span> <span class="s">&#34;P&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">genomewideline</span> <span class="o">=</span> <span class="o">-</span><span class="nf">log10</span><span class="p">(</span><span class="m">5e-8</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">          <span class="n">suggestiveline</span> <span class="o">=</span> <span class="o">-</span><span class="nf">log10</span><span class="p">(</span><span class="m">1e-5</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">          <span class="n">highlight</span> <span class="o">=</span> <span class="kc">NULL</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">main</span> <span class="o">=</span> <span class="s">&#34;GWAS Manhattan Plot&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># é«˜äº®ç‰¹å®šSNP</span>
</span></span><span class="line"><span class="cl"><span class="nf">manhattan</span><span class="p">(</span><span class="n">gwas</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">chr</span> <span class="o">=</span> <span class="s">&#34;CHR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">bp</span> <span class="o">=</span> <span class="s">&#34;BP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">p</span> <span class="o">=</span> <span class="s">&#34;P&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">highlight</span> <span class="o">=</span> <span class="n">gwas</span><span class="o">$</span><span class="n">SNP[gwas</span><span class="o">$</span><span class="n">P</span> <span class="o">&lt;</span> <span class="m">5e-8</span><span class="n">]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">main</span> <span class="o">=</span> <span class="s">&#34;Significant SNPs&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ·»åŠ åŸºå› åç§°</span>
</span></span><span class="line"><span class="cl"><span class="nf">manhattan</span><span class="p">(</span><span class="n">gwas</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">chr</span> <span class="o">=</span> <span class="s">&#34;CHR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">bp</span> <span class="o">=</span> <span class="s">&#34;BP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">p</span> <span class="o">=</span> <span class="s">&#34;P&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">annotatePval</span> <span class="o">=</span> <span class="m">1e-6</span><span class="p">,</span>  <span class="c1"># æ ‡æ³¨på€¼å°äº1e-6çš„SNP</span>
</span></span><span class="line"><span class="cl">          <span class="n">annotateTop</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>   <span class="c1"># åªæ ‡æ³¨æœ€æ˜¾è‘—çš„SNP</span>
</span></span></code></pre></div><p><strong>ä½¿ç”¨ggplot2ç»˜åˆ¶æ›¼å“ˆé¡¿å›¾ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‡†å¤‡æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">gwas_plot</span> <span class="o">&lt;-</span> <span class="n">gwas</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">mutate</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">neglog10p</span> <span class="o">=</span> <span class="o">-</span><span class="nf">log10</span><span class="p">(</span><span class="n">P</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># ä¸ºæ¯ä¸ªæŸ“è‰²ä½“åˆ†é…é¢œè‰²</span>
</span></span><span class="line"><span class="cl">        <span class="n">chr_color</span> <span class="o">=</span> <span class="nf">ifelse</span><span class="p">(</span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">CHR</span><span class="p">)</span> <span class="o">%%</span> <span class="m">2</span> <span class="o">==</span> <span class="m">0</span><span class="p">,</span> <span class="s">&#34;even&#34;</span><span class="p">,</span> <span class="s">&#34;odd&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># è½¬æ¢æŸ“è‰²ä½“ä¸ºå› å­</span>
</span></span><span class="line"><span class="cl">        <span class="n">CHR</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="n">CHR</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="nf">unique</span><span class="p">(</span><span class="n">CHR</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—é˜ˆå€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">threshold</span> <span class="o">&lt;-</span> <span class="m">5e-8</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜å›¾</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">gwas_plot</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BP</span><span class="o">/</span><span class="m">1000000</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">neglog10p</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_point</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">chr_color</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="m">0.7</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">CHR</span><span class="p">,</span> <span class="n">scales</span><span class="o">=</span><span class="s">&#34;free_x&#34;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="m">4</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;odd&#34;</span><span class="o">=</span><span class="s">&#34;steelblue&#34;</span><span class="p">,</span> <span class="s">&#34;even&#34;</span><span class="o">=</span><span class="s">&#34;orange&#34;</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=-</span><span class="nf">log10</span><span class="p">(</span><span class="n">threshold</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">               <span class="n">linetype</span><span class="o">=</span><span class="s">&#34;dashed&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&#34;Position (Mb)&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&#34;-log10(P)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">title</span><span class="o">=</span><span class="s">&#34;Genome-wide Association Study&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">subtitle</span><span class="o">=</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;Significance threshold: &#34;</span><span class="p">,</span> <span class="n">threshold</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_bw</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="n">legend.position</span><span class="o">=</span><span class="s">&#34;none&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">strip.text</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">8</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">axis.text.x</span> <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span><span class="o">=</span><span class="m">45</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span></code></pre></div><p><strong>QQå›¾ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨qqmanåŒ…</span>
</span></span><span class="line"><span class="cl"><span class="nf">qq</span><span class="p">(</span><span class="n">gwas</span><span class="o">$</span><span class="n">P</span><span class="p">,</span> <span class="n">main</span><span class="o">=</span><span class="s">&#34;Q-Q Plot&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨ggplot2</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—æœŸæœ›på€¼</span>
</span></span><span class="line"><span class="cl"><span class="n">expected</span> <span class="o">&lt;-</span> <span class="o">-</span><span class="nf">log10</span><span class="p">((</span><span class="m">1</span><span class="o">:</span><span class="nf">nrow</span><span class="p">(</span><span class="n">gwas</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="nf">nrow</span><span class="p">(</span><span class="n">gwas</span><span class="p">)</span> <span class="o">+</span> <span class="m">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">observed</span> <span class="o">&lt;-</span> <span class="o">-</span><span class="nf">log10</span><span class="p">(</span><span class="nf">sort</span><span class="p">(</span><span class="n">gwas</span><span class="o">$</span><span class="n">P</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">qq_data</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">Expected</span><span class="o">=</span><span class="n">expected</span><span class="p">,</span> <span class="n">Observed</span><span class="o">=</span><span class="n">observed</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">qq_data</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Expected</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Observed</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="m">0.6</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_abline</span><span class="p">(</span><span class="n">intercept</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">slope</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">linetype</span><span class="o">=</span><span class="s">&#34;dashed&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">color</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&#34;Expected -log10(P)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">y</span><span class="o">=</span><span class="s">&#34;Observed -log10(P)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">title</span><span class="o">=</span><span class="s">&#34;Q-Q Plot&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_bw</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è®¡ç®—è†¨èƒ€å› å­</span>
</span></span><span class="line"><span class="cl"><span class="n">lambda</span> <span class="o">&lt;-</span> <span class="nf">median</span><span class="p">(</span><span class="nf">qchisq</span><span class="p">(</span><span class="m">1</span> <span class="o">-</span> <span class="n">gwas</span><span class="o">$</span><span class="n">P</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span> <span class="o">/</span> <span class="nf">qchisq</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">cat</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;Genomic inflation factor (Î»): &#34;</span><span class="p">,</span> <span class="nf">round</span><span class="p">(</span><span class="n">lambda</span><span class="p">,</span> <span class="m">3</span><span class="p">)))</span>
</span></span></code></pre></div><p><strong>ç«å±±å›¾ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">gwas</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BETA</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="nf">log10</span><span class="p">(</span><span class="n">P</span><span class="p">)))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_point</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span><span class="o">=-</span><span class="nf">log10</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="nf">log10</span><span class="p">(</span><span class="m">5e-8</span><span class="p">)),</span>
</span></span><span class="line"><span class="cl">               <span class="n">alpha</span><span class="o">=</span><span class="m">0.6</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;FALSE&#34;</span><span class="o">=</span><span class="s">&#34;gray&#34;</span><span class="p">,</span> <span class="s">&#34;TRUE&#34;</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="o">=-</span><span class="nf">log10</span><span class="p">(</span><span class="m">5e-8</span><span class="p">),</span> <span class="n">linetype</span><span class="o">=</span><span class="s">&#34;dashed&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&#34;Effect Size (BETA)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">y</span><span class="o">=</span><span class="s">&#34;-log10(P)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">title</span><span class="o">=</span><span class="s">&#34;Volcano Plot&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_bw</span><span class="p">()</span>
</span></span></code></pre></div><p><strong>åŒºåŸŸå…³è”å›¾ï¼ˆLocus Zoomï¼‰ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># é€‰æ‹©æ˜¾è‘—ä¿¡å·åŒºåŸŸ</span>
</span></span><span class="line"><span class="cl"><span class="n">sig_snp</span> <span class="o">&lt;-</span> <span class="n">gwas</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">filter</span><span class="p">(</span><span class="n">P</span> <span class="o">&lt;</span> <span class="m">5e-8</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">arrange</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">slice</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>  <span class="c1"># æœ€æ˜¾è‘—çš„SNP</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">chr</span> <span class="o">&lt;-</span> <span class="nf">as.character</span><span class="p">(</span><span class="n">sig_snp</span><span class="o">$</span><span class="n">CHR</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">center_pos</span> <span class="o">&lt;-</span> <span class="n">sig_snp</span><span class="o">$</span><span class="n">BP</span>
</span></span><span class="line"><span class="cl"><span class="n">window</span> <span class="o">&lt;-</span> <span class="m">500000</span>  <span class="c1"># ä¸Šä¸‹å„500kb</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æå–åŒºåŸŸæ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="n">region_data</span> <span class="o">&lt;-</span> <span class="n">gwas</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">    <span class="nf">filter</span><span class="p">(</span><span class="n">CHR</span> <span class="o">==</span> <span class="n">chr</span> <span class="o">&amp;</span> <span class="n">BP</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">center_pos</span> <span class="o">-</span> <span class="n">window</span><span class="p">)</span> <span class="o">&amp;</span>
</span></span><span class="line"><span class="cl">           <span class="n">BP</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="n">center_pos</span> <span class="o">+</span> <span class="n">window</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜åˆ¶åŒºåŸŸå›¾</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">region_data</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">BP</span><span class="o">/</span><span class="m">1000000</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="nf">log10</span><span class="p">(</span><span class="n">P</span><span class="p">)))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&#34;steelblue&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1.5</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="n">center_pos</span><span class="o">/</span><span class="m">1000000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">               <span class="n">linetype</span><span class="o">=</span><span class="s">&#34;dashed&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;Position on Chr&#34;</span><span class="p">,</span> <span class="n">chr</span><span class="p">,</span> <span class="s">&#34; (Mb)&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">         <span class="n">y</span><span class="o">=</span><span class="s">&#34;-log10(P)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">title</span><span class="o">=</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#34;Regional Association Plot (&#34;</span><span class="p">,</span> <span class="nf">round</span><span class="p">(</span><span class="n">center_pos</span><span class="o">/</span><span class="m">1000000</span><span class="p">,</span> <span class="m">2</span><span class="p">),</span> <span class="s">&#34; Mb)&#34;</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_bw</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨LocusZoomåœ¨çº¿å·¥å…·</span>
</span></span><span class="line"><span class="cl"><span class="c1"># https://locuszoom.org/</span>
</span></span></code></pre></div><h4 id="67-å€™é€‰åŸºå› é‰´å®š">6.7 å€™é€‰åŸºå› é‰´å®š<a hidden class="anchor" aria-hidden="true" href="#67-å€™é€‰åŸºå› é‰´å®š">#</a></h4>
<p><strong>æå–æ˜¾è‘—SNPé™„è¿‘çš„åŸºå› ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æå–æ˜¾è‘—SNP</span>
</span></span><span class="line"><span class="cl">awk <span class="s1">&#39;NR&gt;1 &amp;&amp; $9 &lt; 5e-8&#39;</span> gwas_result.assoc.txt &gt; significant_snps.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ ¹æ®åŸºå› ç»„æ³¨é‡Šæ–‡ä»¶æå–é™„è¿‘åŸºå› </span>
</span></span><span class="line"><span class="cl"><span class="c1"># å‡è®¾æœ‰GFF3æ ¼å¼çš„æ³¨é‡Šæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl">bedtools closest -a significant_snps.bed <span class="se">\
</span></span></span><span class="line"><span class="cl">                -b genes.gff3 <span class="se">\
</span></span></span><span class="line"><span class="cl">                -d <span class="m">100000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">                &gt; candidate_genes.txt
</span></span></code></pre></div><p><strong>ä½¿ç”¨BEDToolsï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å°†SNPè½¬æ¢ä¸ºBEDæ ¼å¼</span>
</span></span><span class="line"><span class="cl">awk <span class="s1">&#39;BEGIN{OFS=&#34;\t&#34;} {print $1, $2-1, $2, $3, $4}&#39;</span> significant_snps.txt &gt; snps.bed
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æå–SNPé™„è¿‘çš„åŸºå› ï¼ˆä¸Šä¸‹å„100kbï¼‰</span>
</span></span><span class="line"><span class="cl">bedtools window -a snps.bed -b genes.bed -w <span class="m">100000</span> &gt; snp_genes.txt
</span></span></code></pre></div><p><strong>åŠŸèƒ½å¯Œé›†åˆ†æï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨clusterProfilerè¿›è¡ŒGOå’ŒKEGGå¯Œé›†åˆ†æ</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">clusterProfiler</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">org.At.tair.db</span><span class="p">)</span>  <span class="c1"># æ‹Ÿå—èŠ¥æ³¨é‡Šï¼ˆå¤§è±†éœ€ç›¸åº”æ•°æ®åº“ï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–å€™é€‰åŸºå› åˆ—è¡¨</span>
</span></span><span class="line"><span class="cl"><span class="n">genes</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;candidate_genes.txt&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="o">$</span><span class="n">V1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># GOå¯Œé›†åˆ†æ</span>
</span></span><span class="line"><span class="cl"><span class="n">go_enrich</span> <span class="o">&lt;-</span> <span class="nf">enrichGO</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">gene</span> <span class="o">=</span> <span class="n">genes</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">OrgDb</span> <span class="o">=</span> <span class="n">org.At.tair.db</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">keyType</span> <span class="o">=</span> <span class="s">&#34;TAIR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">ont</span> <span class="o">=</span> <span class="s">&#34;BP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">pAdjustMethod</span> <span class="o">=</span> <span class="s">&#34;BH&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">pvalueCutoff</span> <span class="o">=</span> <span class="m">0.05</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">qvalueCutoff</span> <span class="o">=</span> <span class="m">0.10</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜å›¾</span>
</span></span><span class="line"><span class="cl"><span class="nf">dotplot</span><span class="p">(</span><span class="n">go_enrich</span><span class="p">,</span> <span class="n">showCategory</span><span class="o">=</span><span class="m">20</span><span class="p">)</span> <span class="o">+</span> <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#34;GO Enrichment&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">barplot</span><span class="p">(</span><span class="n">go_enrich</span><span class="p">,</span> <span class="n">showCategory</span><span class="o">=</span><span class="m">20</span><span class="p">)</span> <span class="o">+</span> <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#34;GO Enrichment&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">emapplot</span><span class="p">(</span><span class="n">go_enrich</span><span class="p">)</span> <span class="o">+</span> <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#34;GO Enrichment&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># KEGGé€šè·¯åˆ†æ</span>
</span></span><span class="line"><span class="cl"><span class="n">kegg_enrich</span> <span class="o">&lt;-</span> <span class="nf">enrichKEGG</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">gene</span> <span class="o">=</span> <span class="n">genes</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">organism</span> <span class="o">=</span> <span class="s">&#39;ath&#39;</span><span class="p">,</span>  <span class="c1"># æ‹Ÿå—èŠ¥</span>
</span></span><span class="line"><span class="cl">    <span class="n">pvalueCutoff</span> <span class="o">=</span> <span class="m">0.05</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">dotplot</span><span class="p">(</span><span class="n">kegg_enrich</span><span class="p">)</span> <span class="o">+</span> <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#34;KEGG Pathway Analysis&#34;</span><span class="p">)</span>
</span></span></code></pre></div><hr>
<h3 id="ä¸ƒå…¶ä»–åˆ†æ">ä¸ƒã€å…¶ä»–åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#ä¸ƒå…¶ä»–åˆ†æ">#</a></h3>
<h4 id="71-åŸºå› å®¶æ—åˆ†æ">7.1 åŸºå› å®¶æ—åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#71-åŸºå› å®¶æ—åˆ†æ">#</a></h4>
<p><strong>ç›®çš„ï¼š</strong> é‰´å®šç‰¹å®šåŸºå› å®¶æ—çš„æˆå‘˜ã€è¿›åŒ–å†å²å’Œè¡¨è¾¾æ¨¡å¼</p>
<p><strong>åˆ†ææµç¨‹ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Step 1: ä¸‹è½½ç›®æ ‡åŸºå› å®¶æ—çš„å·²çŸ¥è›‹ç™½åºåˆ—</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ä»Pfamã€InterProæˆ–æ–‡çŒ®è·å–</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 2: åœ¨å¤§è±†åŸºå› ç»„ä¸­æœç´¢åŒæºåŸºå› </span>
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨BLASTPæˆ–HMMER</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">blastp -query known_family_proteins.fa <span class="se">\
</span></span></span><span class="line"><span class="cl">       -db soybean_proteome.fa <span class="se">\
</span></span></span><span class="line"><span class="cl">       -evalue 1e-5 <span class="se">\
</span></span></span><span class="line"><span class="cl">       -outfmt <span class="m">6</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">       -out blast_results.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æˆ–ä½¿ç”¨HMMERï¼ˆæ›´å‡†ç¡®ï¼‰</span>
</span></span><span class="line"><span class="cl">hmmbuild gene_family.hmm known_family_alignment.sto
</span></span><span class="line"><span class="cl">hmmsearch --domtblout hmm_results.txt gene_family.hmm soybean_proteome.fa
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 3: æå–å€™é€‰åŸºå› åºåˆ—</span>
</span></span><span class="line"><span class="cl">samtools faidx soybean_proteome.fa <span class="k">$(</span>awk <span class="s1">&#39;{print $1}&#39;</span> blast_results.txt<span class="k">)</span> &gt; candidate_genes.fa
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 4: å¤šåºåˆ—æ¯”å¯¹</span>
</span></span><span class="line"><span class="cl">mafft --auto candidate_genes.fa &gt; candidate_genes_aligned.fa
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 5: æ„å»ºç³»ç»Ÿå‘è‚²æ ‘</span>
</span></span><span class="line"><span class="cl">iqtree -s candidate_genes_aligned.fa -m MFP -bb <span class="m">1000</span> -nt AUTO
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 6: è®¡ç®—Ka/Ksæ¯”å€¼</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨KaKs_Calculator</span>
</span></span><span class="line"><span class="cl">KaKs_Calculator -i coding_sequences.fa -o ka_ks_results.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Step 7: æŸ“è‰²ä½“å®šä½</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨åŸºå› GFFæ–‡ä»¶æå–ä½ç½®ä¿¡æ¯</span>
</span></span><span class="line"><span class="cl">grep -f candidate_genes_list.txt soybean_annotation.gff3 &gt; gene_locations.gff3
</span></span></code></pre></div><p><strong>å¯è§†åŒ–åŸºå› å®¶æ—ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggtree</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–æ ‘æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="n">tree</span> <span class="o">&lt;-</span> <span class="nf">read.tree</span><span class="p">(</span><span class="s">&#34;candidate_genes_aligned.fa.treefile&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜åˆ¶ç³»ç»Ÿå‘è‚²æ ‘</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggtree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_tiplab</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="m">2</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_tippoint</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">group</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="m">2</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_tree2</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#34;Gene Family Phylogenetic Tree&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ·»åŠ çƒ­å›¾ï¼ˆè¡¨è¾¾æ•°æ®ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="kr">if</span> <span class="p">(</span><span class="nf">file.exists</span><span class="p">(</span><span class="s">&#34;expression_data.txt&#34;</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">expr_data</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;expression_data.txt&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span> <span class="n">row.names</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nf">gheatmap</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">expr_data</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="m">0.5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="n">colnames_angle</span><span class="o">=</span><span class="m">-45</span><span class="p">,</span> <span class="n">colnames_offset_y</span><span class="o">=</span><span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="72-é€‰æ‹©å‹åŠ›åˆ†æ">7.2 é€‰æ‹©å‹åŠ›åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#72-é€‰æ‹©å‹åŠ›åˆ†æ">#</a></h4>
<p><strong>Ka/Ksæ¯”å€¼åˆ†æï¼š</strong></p>
<p><strong>å®šä¹‰ï¼š</strong></p>
<ul>
<li>Kaï¼šéåŒä¹‰æ›¿æ¢ç‡</li>
<li>Ksï¼šåŒä¹‰æ›¿æ¢ç‡</li>
<li>Ka/Ksï¼šé€‰æ‹©å‹åŠ›æŒ‡æ ‡</li>
</ul>
<p><strong>æ¯”å€¼è§£è¯»ï¼š</strong></p>
<table>
  <thead>
      <tr>
          <th>Ka/Ks</th>
          <th>é€‰æ‹©ç±»å‹</th>
          <th>è¯´æ˜</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Ka/Ks &lt; 1</td>
          <td>çº¯åŒ–é€‰æ‹©</td>
          <td>åŠŸèƒ½çº¦æŸï¼Œå»é™¤æœ‰å®³çªå˜</td>
      </tr>
      <tr>
          <td>Ka/Ks = 1</td>
          <td>ä¸­æ€§è¿›åŒ–</td>
          <td>æ— é€‰æ‹©å‹åŠ›</td>
      </tr>
      <tr>
          <td>Ka/Ks &gt; 1</td>
          <td>æ­£é€‰æ‹©</td>
          <td>é€‚åº”æ€§è¿›åŒ–</td>
      </tr>
  </tbody>
</table>
<p><strong>ä½¿ç”¨KaKs_Calculatorï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å‡†å¤‡è¾“å…¥æ–‡ä»¶ï¼ˆFASTAæ ¼å¼çš„ç¼–ç åºåˆ—å¯¹ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># æ ¼å¼ï¼š&gt;gene1_seq1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       ATG...</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       &gt;gene1_seq2</span>
</span></span><span class="line"><span class="cl"><span class="c1">#       ATG...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿è¡ŒKaKs_Calculator</span>
</span></span><span class="line"><span class="cl">KaKs_Calculator -i gene_pairs.fa -o ka_ks_results.txt -m MYN
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‚æ•°è¯´æ˜ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -i: è¾“å…¥æ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -o: è¾“å‡ºæ–‡ä»¶</span>
</span></span><span class="line"><span class="cl"><span class="c1"># -m: æ–¹æ³•ï¼ˆMYN, NG, LWL, MLPç­‰ï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºåŒ…å«ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - Ka, Ks, Ka/Ks</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - æ ‡å‡†è¯¯å’Œç½®ä¿¡åŒºé—´</span>
</span></span></code></pre></div><p><strong>ä½¿ç”¨PAML (codeml)ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å‡†å¤‡å¿…è¦çš„æ–‡ä»¶ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 1. åºåˆ—æ¯”å¯¹æ–‡ä»¶ï¼ˆPHYLIPæ ¼å¼ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 2. æ ‘æ–‡ä»¶ï¼ˆNewickæ ¼å¼ï¼‰</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 3. æ§åˆ¶æ–‡ä»¶ï¼ˆcodeml.ctlï¼‰</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># codeml.ctl ç¤ºä¾‹</span>
</span></span><span class="line"><span class="cl"><span class="nv">seqfile</span> <span class="o">=</span> gene_alignment.phy
</span></span><span class="line"><span class="cl"><span class="nv">treefile</span> <span class="o">=</span> gene_tree.nwk
</span></span><span class="line"><span class="cl"><span class="nv">outfile</span> <span class="o">=</span> codeml_results.txt
</span></span><span class="line"><span class="cl"><span class="nv">runmode</span> <span class="o">=</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="nv">model</span> <span class="o">=</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="nv">NSsites</span> <span class="o">=</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="nv">icode</span> <span class="o">=</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¿è¡Œcodeml</span>
</span></span><span class="line"><span class="cl">codeml codeml.ctl
</span></span></code></pre></div><p><strong>å¯è§†åŒ–Ka/Ksåˆ†å¸ƒï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¯»å–ç»“æœ</span>
</span></span><span class="line"><span class="cl"><span class="n">ka_ks</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;ka_ks_results.txt&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç»˜åˆ¶Ka/Ksåˆ†å¸ƒç›´æ–¹å›¾</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">ka_ks</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Ka_Ks</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_histogram</span><span class="p">(</span><span class="n">binwidth</span><span class="o">=</span><span class="m">0.1</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s">&#34;steelblue&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;black&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">linetype</span><span class="o">=</span><span class="s">&#34;dashed&#34;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&#34;Ka/Ks Ratio&#34;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">&#34;Count&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">title</span><span class="o">=</span><span class="s">&#34;Distribution of Ka/Ks Ratios&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_bw</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Ka vs Ksæ•£ç‚¹å›¾</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">ka_ks</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">Ks</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Ka</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_point</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="m">0.6</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">geom_abline</span><span class="p">(</span><span class="n">intercept</span><span class="o">=</span><span class="m">0</span><span class="p">,</span> <span class="n">slope</span><span class="o">=</span><span class="m">1</span><span class="p">,</span> <span class="n">linetype</span><span class="o">=</span><span class="s">&#34;dashed&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">color</span><span class="o">=</span><span class="s">&#34;red&#34;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="m">1</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">&#34;Ks (synonymous)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">y</span><span class="o">=</span><span class="s">&#34;Ka (nonsynonymous)&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="n">title</span><span class="o">=</span><span class="s">&#34;Ka vs Ks Plot&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">theme_bw</span><span class="p">()</span>
</span></span></code></pre></div><h4 id="73-å•å€å‹åˆ†æ">7.3 å•å€å‹åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#73-å•å€å‹åˆ†æ">#</a></h4>
<p><strong>ç›®çš„ï¼š</strong> åˆ†æåŸºå› åŒºåŸŸçš„å•å€å‹ç»„æˆå’Œé¢‘ç‡åˆ†å¸ƒ</p>
<p><strong>ä½¿ç”¨Haploviewï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># å¯¼å…¥æ•°æ®</span>
</span></span><span class="line"><span class="cl"><span class="c1"># File &gt; Import Data &gt; PLINK format</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è‡ªåŠ¨å®šä¹‰å•å€å‹å—</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Blocks &gt; Define Blocks</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºLDå›¾å’Œå•å€å‹é¢‘ç‡</span>
</span></span><span class="line"><span class="cl"><span class="c1"># File &gt; Export Plots</span>
</span></span></code></pre></div><p><strong>ä½¿ç”¨PLINKï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># è®¡ç®—å•å€å‹é¢‘ç‡</span>
</span></span><span class="line"><span class="cl">plink --bfile gwas_cleaned <span class="se">\
</span></span></span><span class="line"><span class="cl">      --blocks no-pheno-req <span class="se">\
</span></span></span><span class="line"><span class="cl">      --hap-freq <span class="se">\
</span></span></span><span class="line"><span class="cl">      --out haplotype_freq
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å‚æ•°è¯´æ˜ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --blocks: å®šä¹‰å•å€å‹å—</span>
</span></span><span class="line"><span class="cl"><span class="c1"># --hap-freq: è¾“å‡ºå•å€å‹é¢‘ç‡</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># è¾“å‡ºæ–‡ä»¶ï¼š</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - haplotype_freq.frq: å•å€å‹é¢‘ç‡</span>
</span></span><span class="line"><span class="cl"><span class="c1"># - haplotype_freq.blocks: å•å€å‹å—å®šä¹‰</span>
</span></span></code></pre></div><p><strong>ä½¿ç”¨VCFtoolsï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># æå–ç‰¹å®šåŒºåŸŸ</span>
</span></span><span class="line"><span class="cl">vcftools --vcf cohort.vcf.gz <span class="se">\
</span></span></span><span class="line"><span class="cl">         --chr <span class="m">1</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --from-bp <span class="m">1000000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --to-bp <span class="m">2000000</span> <span class="se">\
</span></span></span><span class="line"><span class="cl">         --recode <span class="se">\
</span></span></span><span class="line"><span class="cl">         --out region
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ä½¿ç”¨Haploviewæˆ–å…¶ä»–è½¯ä»¶åˆ†æå•å€å‹</span>
</span></span></code></pre></div><h4 id="74-å—é€‰æ‹©åŸºå› åŠŸèƒ½å¯Œé›†">7.4 å—é€‰æ‹©åŸºå› åŠŸèƒ½å¯Œé›†<a hidden class="anchor" aria-hidden="true" href="#74-å—é€‰æ‹©åŸºå› åŠŸèƒ½å¯Œé›†">#</a></h4>
<p><strong>ç›®çš„ï¼š</strong> ç¡®å®šå—é€‰æ‹©åŸºå› æ˜¾è‘—å¯Œé›†çš„åŠŸèƒ½ç±»åˆ«</p>
<p><strong>åˆ†ææµç¨‹ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># æå–å—é€‰æ‹©åŒºåŸŸçš„åŸºå› </span>
</span></span><span class="line"><span class="cl"><span class="n">selected_genes</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;selected_genes.txt&#34;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="o">$</span><span class="n">V1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># GOå¯Œé›†åˆ†æ</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">clusterProfiler</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">org.At.tair.db</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">go_bp</span> <span class="o">&lt;-</span> <span class="nf">enrichGO</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">gene</span> <span class="o">=</span> <span class="n">selected_genes</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">OrgDb</span> <span class="o">=</span> <span class="n">org.At.tair.db</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">keyType</span> <span class="o">=</span> <span class="s">&#34;TAIR&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">ont</span> <span class="o">=</span> <span class="s">&#34;BP&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">pAdjustMethod</span> <span class="o">=</span> <span class="s">&#34;BH&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">pvalueCutoff</span> <span class="o">=</span> <span class="m">0.01</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">qvalueCutoff</span> <span class="o">=</span> <span class="m">0.05</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¯è§†åŒ–</span>
</span></span><span class="line"><span class="cl"><span class="nf">dotplot</span><span class="p">(</span><span class="n">go_bp</span><span class="p">,</span> <span class="n">showCategory</span><span class="o">=</span><span class="m">25</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#34;GO Biological Process Enrichment&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">cnetplot</span><span class="p">(</span><span class="n">go_bp</span><span class="p">,</span> <span class="n">showCategory</span><span class="o">=</span><span class="m">15</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#34;Gene Concept Network&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">goplot</span><span class="p">(</span><span class="n">go_bp</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#34;GO Relationship&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># KEGGå¯Œé›†</span>
</span></span><span class="line"><span class="cl"><span class="n">kegg</span> <span class="o">&lt;-</span> <span class="nf">enrichKEGG</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">gene</span> <span class="o">=</span> <span class="n">selected_genes</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">organism</span> <span class="o">=</span> <span class="s">&#39;atha&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">pvalueCutoff</span> <span class="o">=</span> <span class="m">0.05</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">dotplot</span><span class="p">(</span><span class="n">kegg</span><span class="p">,</span> <span class="n">showCategory</span><span class="o">=</span><span class="m">20</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#34;KEGG Pathway Enrichment&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¯”è¾ƒä¸åŒç¾¤ä½“å—é€‰æ‹©åŸºå› </span>
</span></span><span class="line"><span class="cl"><span class="c1"># ç¾¤ä½“1å—é€‰æ‹©åŸºå› </span>
</span></span><span class="line"><span class="cl"><span class="n">genes_pop1</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;selected_genes_pop1.txt&#34;</span><span class="p">)</span><span class="o">$</span><span class="n">V1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># ç¾¤ä½“2å—é€‰æ‹©åŸºå› </span>
</span></span><span class="line"><span class="cl"><span class="n">genes_pop2</span> <span class="o">&lt;-</span> <span class="nf">read.table</span><span class="p">(</span><span class="s">&#34;selected_genes_pop2.txt&#34;</span><span class="p">)</span><span class="o">$</span><span class="n">V1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">go_pop1</span> <span class="o">&lt;-</span> <span class="nf">enrichGO</span><span class="p">(</span><span class="n">gene</span> <span class="o">=</span> <span class="n">genes_pop1</span><span class="p">,</span> <span class="n">OrgDb</span> <span class="o">=</span> <span class="n">org.At.tair.db</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">ont</span> <span class="o">=</span> <span class="s">&#34;BP&#34;</span><span class="p">,</span> <span class="n">pAdjustMethod</span> <span class="o">=</span> <span class="s">&#34;BH&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">go_pop2</span> <span class="o">&lt;-</span> <span class="nf">enrichGO</span><span class="p">(</span><span class="n">gene</span> <span class="o">=</span> <span class="n">genes_pop2</span><span class="p">,</span> <span class="n">OrgDb</span> <span class="o">=</span> <span class="n">org.At.tair.db</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="n">ont</span> <span class="o">=</span> <span class="s">&#34;BP&#34;</span><span class="p">,</span> <span class="n">pAdjustMethod</span> <span class="o">=</span> <span class="s">&#34;BH&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># æ¯”è¾ƒå¯Œé›†ç»“æœ</span>
</span></span><span class="line"><span class="cl"><span class="n">compare</span> <span class="o">&lt;-</span> <span class="nf">compareCluster</span><span class="p">(</span><span class="n">gene</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">Population1</span> <span class="o">=</span> <span class="n">genes_pop1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                      <span class="n">Population2</span> <span class="o">=</span> <span class="n">genes_pop2</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                          <span class="n">fun</span> <span class="o">=</span> <span class="s">&#34;enrichGO&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                          <span class="n">OrgDb</span> <span class="o">=</span> <span class="n">org.At.tair.db</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                          <span class="n">ont</span> <span class="o">=</span> <span class="s">&#34;BP&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nf">dotplot</span><span class="p">(</span><span class="n">compare</span><span class="p">,</span> <span class="n">showCategory</span><span class="o">=</span><span class="m">20</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">    <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&#34;GO Enrichment Comparison between Populations&#34;</span><span class="p">)</span>
</span></span></code></pre></div><hr>
<h2 id="æ€»ç»“">æ€»ç»“<a hidden class="anchor" aria-hidden="true" href="#æ€»ç»“">#</a></h2>
<p>æœ¬æµç¨‹æ–‡æ¡£è¯¦ç»†æè¿°äº†8000ä»½å¤§è±†é‡æµ‹åºæ•°æ®çš„å®Œæ•´åˆ†æpipelineï¼Œæ¶µç›–äº†ä»åŸå§‹æ•°æ®åˆ°æœ€ç»ˆå‘è¡¨å›¾è¡¨çš„æ‰€æœ‰å…³é”®æ­¥éª¤ï¼š</p>
<h3 id="æ ¸å¿ƒæµç¨‹">æ ¸å¿ƒæµç¨‹<a hidden class="anchor" aria-hidden="true" href="#æ ¸å¿ƒæµç¨‹">#</a></h3>
<ol>
<li><strong>æ•°æ®è´¨æ§</strong>ï¼šFastQCå’Œfastpç¡®ä¿æ•°æ®è´¨é‡</li>
<li><strong>åºåˆ—æ¯”å¯¹</strong>ï¼šBWA-MEMé«˜æ•ˆæ¯”å¯¹åˆ°å‚è€ƒåŸºå› ç»„</li>
<li><strong>å˜å¼‚æ£€æµ‹</strong>ï¼šGATK Best Practicesæµç¨‹æ£€æµ‹SNPå’ŒInDel</li>
<li><strong>å˜å¼‚æ³¨é‡Š</strong>ï¼šANNOVARè¿›è¡ŒåŠŸèƒ½æ³¨é‡Šå’Œæ•ˆåº”é¢„æµ‹</li>
</ol>
<h3 id="é«˜çº§åˆ†æ">é«˜çº§åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#é«˜çº§åˆ†æ">#</a></h3>
<h4 id="ç¾¤ä½“é—ä¼ å­¦åˆ†æ">ç¾¤ä½“é—ä¼ å­¦åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#ç¾¤ä½“é—ä¼ å­¦åˆ†æ">#</a></h4>
<ul>
<li><strong>PCA</strong>ï¼šè¯„ä¼°ç¾¤ä½“ç»“æ„</li>
<li><strong>ç³»ç»Ÿå‘è‚²æ ‘</strong>ï¼šé‡å»ºè¿›åŒ–å†å²</li>
<li><strong>ADMIXTURE</strong>ï¼šåˆ†æç¥–å…ˆç»„æˆ</li>
</ul>
<h4 id="é€‰æ‹©ä¿¡å·åˆ†æ">é€‰æ‹©ä¿¡å·åˆ†æ<a hidden class="anchor" aria-hidden="true" href="#é€‰æ‹©ä¿¡å·åˆ†æ">#</a></h4>
<ul>
<li><strong>æ ¸è‹·é…¸å¤šæ ·æ€§(Ï€)</strong>ï¼šé—ä¼ å¤šæ ·æ€§è¯„ä¼°</li>
<li><strong>FST</strong>ï¼šç¾¤ä½“åˆ†åŒ–åˆ†æ</li>
<li><strong>XP-CLR/XPEHH</strong>ï¼šé€‰æ‹©ä¿¡å·æ‰«æ</li>
<li><strong>Tajima&rsquo;s D</strong>ï¼šä¸­æ€§æ£€éªŒ</li>
</ul>
<h4 id="å…¨åŸºå› ç»„å…³è”åˆ†ægwas">å…¨åŸºå› ç»„å…³è”åˆ†æ(GWAS)<a hidden class="anchor" aria-hidden="true" href="#å…¨åŸºå› ç»„å…³è”åˆ†ægwas">#</a></h4>
<ul>
<li>çº¿æ€§æ··åˆæ¨¡å‹</li>
<li>å¤šé‡æ£€éªŒæ ¡æ­£</li>
<li>å€™é€‰åŸºå› é‰´å®š</li>
<li>åŠŸèƒ½å¯Œé›†åˆ†æ</li>
</ul>
<h3 id="æ•°æ®å¯è§†åŒ–">æ•°æ®å¯è§†åŒ–<a hidden class="anchor" aria-hidden="true" href="#æ•°æ®å¯è§†åŒ–">#</a></h3>
<ul>
<li>æ›¼å“ˆé¡¿å›¾å’ŒQQå›¾ï¼ˆGWASç»“æœï¼‰</li>
<li>LDè¡°å‡æ›²çº¿</li>
<li>PCAå›¾å’Œç³»ç»Ÿå‘è‚²æ ‘</li>
<li>ADMIXTUREæ¡å½¢å›¾</li>
<li>FSTå’ŒÏ€åˆ†å¸ƒå›¾</li>
<li>é€‰æ‹©ä¿¡å·æ‰«æå›¾</li>
</ul>
<hr>
<p>æ‰€æœ‰åˆ†ææ–¹æ³•å‡æä¾›äº†è¯¦ç»†çš„å‘½ä»¤è¡Œç¤ºä¾‹ã€å‚æ•°è¯´æ˜å’ŒRè¯­è¨€å¯è§†åŒ–ä»£ç ï¼Œå¯ç›´æ¥åº”ç”¨äºå®é™…æ•°æ®åˆ†æã€‚è¯¥æµç¨‹é€‚ç”¨äºå¤§è±†åŠå…¶ä»–ä½œç‰©çš„é‡æµ‹åºæ•°æ®åˆ†æï¼Œä¸ºé—ä¼ å­¦ç ”ç©¶å’Œåˆ†å­è‚²ç§æä¾›äº†å®Œæ•´çš„æŠ€æœ¯æ–¹æ¡ˆã€‚</p>


      </div>
      <footer class="post-footer">
        <ul class="post-tags">
          <li><a href="https://Tdxxxx-student.github.io/tags/%E9%87%8D%E6%B5%8B%E5%BA%8F">é‡æµ‹åº</a></li>
          <li><a href="https://Tdxxxx-student.github.io/tags/gwas">GWAS</a></li>
          <li><a href="https://Tdxxxx-student.github.io/tags/%E5%8F%98%E5%BC%82%E6%A3%80%E6%B5%8B">å˜å¼‚æ£€æµ‹</a></li>
        </ul>
      </footer>

      
      <nav class="post-nav-full">
        <div class="nav-info">
            ç¬¬ <strong>2</strong> / 4 ç¯‡ 
            <span style="opacity: 0.6; font-size: 0.9em; margin-left: 5px;">(åˆ†ç±»: é‡æµ‹åºåˆ†æ)</span>
        </div>
        
        <div class="nav-buttons">
          <a class="nav-btn first" href="https://Tdxxxx-student.github.io/posts/31%E4%B8%AA%E5%93%81%E7%A7%8D%E5%A4%A7%E8%B1%86%E9%87%8D%E6%B5%8B%E5%BA%8F%E5%88%86%E6%9E%90%E6%96%87%E7%AB%A0/" title="ç¬¬ä¸€ç¯‡">Â«</a>
          <a class="nav-btn prev" href="https://Tdxxxx-student.github.io/posts/31%E4%B8%AA%E5%93%81%E7%A7%8D%E5%A4%A7%E8%B1%86%E9%87%8D%E6%B5%8B%E5%BA%8F%E5%88%86%E6%9E%90%E6%96%87%E7%AB%A0/" title="31ä¸ªå“ç§å¤§è±†é‡æµ‹åºåˆ†ææ–‡ç« ">â€¹</a><div class="nav-pages-group">
                <a class="nav-num" href="https://Tdxxxx-student.github.io/posts/31%E4%B8%AA%E5%93%81%E7%A7%8D%E5%A4%A7%E8%B1%86%E9%87%8D%E6%B5%8B%E5%BA%8F%E5%88%86%E6%9E%90%E6%96%87%E7%AB%A0/" title="31ä¸ªå“ç§å¤§è±†é‡æµ‹åºåˆ†ææ–‡ç« ">1</a>

            <span class="nav-num current">2</span>
                <a class="nav-num" href="https://Tdxxxx-student.github.io/posts/%E7%BE%A4%E4%BD%93%E9%81%97%E4%BC%A0%E5%AD%A6%E4%B8%8E%E9%87%8D%E6%B5%8B%E5%BA%8F%E5%88%86%E6%9E%90%E8%A7%A3%E9%87%8A/" title="ç¾¤ä½“é—ä¼ å­¦ä¸é‡æµ‹åºåˆ†æè§£é‡Š">3</a>
                <a class="nav-num" href="https://Tdxxxx-student.github.io/posts/%E4%BA%91%E5%8D%97%E5%86%9C%E4%B8%9A%E5%A4%A7%E5%AD%A6%E9%87%8D%E6%B5%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE%E6%95%99%E7%A8%8B/" title="äº‘å—å†œä¸šå¤§å­¦é‡æµ‹åºé¡¹ç›®æ•™ç¨‹">4</a>
          </div>
          <a class="nav-btn next" href="https://Tdxxxx-student.github.io/posts/%E7%BE%A4%E4%BD%93%E9%81%97%E4%BC%A0%E5%AD%A6%E4%B8%8E%E9%87%8D%E6%B5%8B%E5%BA%8F%E5%88%86%E6%9E%90%E8%A7%A3%E9%87%8A/" title="ç¾¤ä½“é—ä¼ å­¦ä¸é‡æµ‹åºåˆ†æè§£é‡Š">â€º</a>
          <a class="nav-btn last" href="https://Tdxxxx-student.github.io/posts/%E4%BA%91%E5%8D%97%E5%86%9C%E4%B8%9A%E5%A4%A7%E5%AD%A6%E9%87%8D%E6%B5%8B%E5%BA%8F%E9%A1%B9%E7%9B%AE%E6%95%99%E7%A8%8B/" title="æœ€åä¸€ç¯‡">Â»</a>
        </div>
      </nav></article>

    
    <aside class="sidebar-right">
      <div class="toc-card">
        <div class="toc-title">
          <span class="toc-icon">ğŸ“–</span> ç›®å½•
        </div>
        <nav id="TableOfContents">
          <nav id="TableOfContents">
  <ul>
    <li><a href="#ç›®å½•">ç›®å½•</a></li>
    <li><a href="#åˆ†ææµç¨‹æ€»è§ˆ">åˆ†ææµç¨‹æ€»è§ˆ</a>
      <ul>
        <li><a href="#æ•´ä½“æµç¨‹æ¶æ„">æ•´ä½“æµç¨‹æ¶æ„</a></li>
      </ul>
    </li>
    <li><a href="#æ•°æ®åˆ†æå…·ä½“æµç¨‹">æ•°æ®åˆ†æå…·ä½“æµç¨‹</a>
      <ul>
        <li><a href="#ä¸€æ•°æ®è´¨æ§">ä¸€ã€æ•°æ®è´¨æ§</a></li>
        <li><a href="#äºŒåºåˆ—æ¯”å¯¹">äºŒã€åºåˆ—æ¯”å¯¹</a></li>
        <li><a href="#ä¸‰å˜å¼‚æ£€æµ‹">ä¸‰ã€å˜å¼‚æ£€æµ‹</a></li>
        <li><a href="#å››å˜å¼‚æ³¨é‡Š">å››ã€å˜å¼‚æ³¨é‡Š</a></li>
      </ul>
    </li>
    <li><a href="#å›¾è¡¨åˆ¶ä½œ">å›¾è¡¨åˆ¶ä½œ</a>
      <ul>
        <li><a href="#ä¸€ç¾¤ä½“é—ä¼ å­¦åˆ†æ">ä¸€ã€ç¾¤ä½“é—ä¼ å­¦åˆ†æ</a></li>
        <li><a href="#äºŒè¿é”ä¸å¹³è¡¡åˆ†æ">äºŒã€è¿é”ä¸å¹³è¡¡åˆ†æ</a></li>
        <li><a href="#ä¸‰æ ¸è‹·é…¸å¤šæ ·æ€§åˆ†æ">ä¸‰ã€æ ¸è‹·é…¸å¤šæ ·æ€§åˆ†æ</a></li>
        <li><a href="#å››å›ºå®šæŒ‡æ•°-fst">å››ã€å›ºå®šæŒ‡æ•° (FST)</a></li>
        <li><a href="#äº”é€‰æ‹©æ¸…é™¤åˆ†æ">äº”ã€é€‰æ‹©æ¸…é™¤åˆ†æ</a></li>
        <li><a href="#å…­å…¨åŸºå› ç»„å…³è”åˆ†æ-gwas">å…­ã€å…¨åŸºå› ç»„å…³è”åˆ†æ (GWAS)</a></li>
        <li><a href="#ä¸ƒå…¶ä»–åˆ†æ">ä¸ƒã€å…¶ä»–åˆ†æ</a></li>
      </ul>
    </li>
    <li><a href="#æ€»ç»“">æ€»ç»“</a>
      <ul>
        <li><a href="#æ ¸å¿ƒæµç¨‹">æ ¸å¿ƒæµç¨‹</a></li>
        <li><a href="#é«˜çº§åˆ†æ">é«˜çº§åˆ†æ</a></li>
        <li><a href="#æ•°æ®å¯è§†åŒ–">æ•°æ®å¯è§†åŒ–</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </nav>
      </div>
    </aside>

  </div>
</div>
    </main>
    
<footer class="footer">
        <span>tdx0307</span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>
<a href="/search/" class="search-fab" title="æœç´¢ (Ctrl+F)">ğŸ”</a>

<style>
.search-fab {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    width: 50px;
    height: 50px;
    background: var(--primary);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.3rem;
    text-decoration: none;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
    z-index: 100;
}

.search-fab:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
}

@media (max-width: 768px) {
    .search-fab {
        bottom: 1rem;
        right: 1rem;
        width: 45px;
        height: 45px;
    }
}
</style>

<script>

document.addEventListener('DOMContentLoaded', function() {
    if (document.getElementById('wide-post-layout')) {
        var main = document.querySelector('main.main');
        if (main) {
            main.style.maxWidth = '100%';
            main.style.width = '100%';
            main.style.padding = '0';
            main.style.margin = '0 auto';
        }
        
        document.body.classList.add('is-single-post');
    }
});
</script>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
